<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Redis Commands | Infinity Architect</title>
<link rel=stylesheet href=/main.css><script type=importmap>
  {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.167.1/+esm"
      }
  }
  </script><script type=module src=/theme.mjs></script><style>.tag-android{background-color:hsl(0deg 80% 70%)}.dark .tag-android{background-color:hsl(0deg 80% 20%)}.tag-annotation{background-color:hsl(50deg 80% 70%)}.dark .tag-annotation{background-color:hsl(50deg 80% 20%)}.tag-assembly{background-color:hsl(100deg 80% 70%)}.dark .tag-assembly{background-color:hsl(100deg 80% 20%)}.tag-asymmetrical-cryptography{background-color:hsl(150deg 80% 70%)}.dark .tag-asymmetrical-cryptography{background-color:hsl(150deg 80% 20%)}.tag-awk{background-color:hsl(200deg 80% 70%)}.dark .tag-awk{background-color:hsl(200deg 80% 20%)}.tag-bootloader{background-color:hsl(250deg 80% 70%)}.dark .tag-bootloader{background-color:hsl(250deg 80% 20%)}.tag-bytecode{background-color:hsl(300deg 80% 70%)}.dark .tag-bytecode{background-color:hsl(300deg 80% 20%)}.tag-c{background-color:hsl(350deg 80% 70%)}.dark .tag-c{background-color:hsl(350deg 80% 20%)}.tag-cxx{background-color:hsl(40deg 80% 70%)}.dark .tag-cxx{background-color:hsl(40deg 80% 20%)}.tag-cxx-stl{background-color:hsl(90deg 80% 70%)}.dark .tag-cxx-stl{background-color:hsl(90deg 80% 20%)}.tag-cgroup{background-color:hsl(140deg 80% 70%)}.dark .tag-cgroup{background-color:hsl(140deg 80% 20%)}.tag-cheetsheet{background-color:hsl(190deg 80% 70%)}.dark .tag-cheetsheet{background-color:hsl(190deg 80% 20%)}.tag-clang{background-color:hsl(240deg 80% 70%)}.dark .tag-clang{background-color:hsl(240deg 80% 20%)}.tag-coding-theory{background-color:hsl(290deg 80% 70%)}.dark .tag-coding-theory{background-color:hsl(290deg 80% 20%)}.tag-compression{background-color:hsl(340deg 80% 70%)}.dark .tag-compression{background-color:hsl(340deg 80% 20%)}.tag-concept{background-color:hsl(30deg 80% 70%)}.dark .tag-concept{background-color:hsl(30deg 80% 20%)}.tag-cpu{background-color:hsl(80deg 80% 70%)}.dark .tag-cpu{background-color:hsl(80deg 80% 20%)}.tag-crawler{background-color:hsl(130deg 80% 70%)}.dark .tag-crawler{background-color:hsl(130deg 80% 20%)}.tag-cryptography{background-color:hsl(180deg 80% 70%)}.dark .tag-cryptography{background-color:hsl(180deg 80% 20%)}.tag-css{background-color:hsl(230deg 80% 70%)}.dark .tag-css{background-color:hsl(230deg 80% 20%)}.tag-database{background-color:hsl(280deg 80% 70%)}.dark .tag-database{background-color:hsl(280deg 80% 20%)}.tag-deflate{background-color:hsl(330deg 80% 70%)}.dark .tag-deflate{background-color:hsl(330deg 80% 20%)}.tag-design{background-color:hsl(20deg 80% 70%)}.dark .tag-design{background-color:hsl(20deg 80% 20%)}.tag-dns{background-color:hsl(70deg 80% 70%)}.dark .tag-dns{background-color:hsl(70deg 80% 20%)}.tag-dom{background-color:hsl(120deg 80% 70%)}.dark .tag-dom{background-color:hsl(120deg 80% 20%)}.tag-driver{background-color:hsl(170deg 80% 70%)}.dark .tag-driver{background-color:hsl(170deg 80% 20%)}.tag-elastic{background-color:hsl(220deg 80% 70%)}.dark .tag-elastic{background-color:hsl(220deg 80% 20%)}.tag-elf{background-color:hsl(270deg 80% 70%)}.dark .tag-elf{background-color:hsl(270deg 80% 20%)}.tag-elk{background-color:hsl(320deg 80% 70%)}.dark .tag-elk{background-color:hsl(320deg 80% 20%)}.tag-flex{background-color:hsl(10deg 80% 70%)}.dark .tag-flex{background-color:hsl(10deg 80% 20%)}.tag-gc{background-color:hsl(60deg 80% 70%)}.dark .tag-gc{background-color:hsl(60deg 80% 20%)}.tag-gcc{background-color:hsl(110deg 80% 70%)}.dark .tag-gcc{background-color:hsl(110deg 80% 20%)}.tag-gnu{background-color:hsl(160deg 80% 70%)}.dark .tag-gnu{background-color:hsl(160deg 80% 20%)}.tag-go{background-color:hsl(210deg 80% 70%)}.dark .tag-go{background-color:hsl(210deg 80% 20%)}.tag-gzip{background-color:hsl(260deg 80% 70%)}.dark .tag-gzip{background-color:hsl(260deg 80% 20%)}.tag-hash{background-color:hsl(310deg 80% 70%)}.dark .tag-hash{background-color:hsl(310deg 80% 20%)}.tag-http{background-color:hsl(0deg 80% 70%)}.dark .tag-http{background-color:hsl(0deg 80% 20%)}.tag-huffman{background-color:hsl(50deg 80% 70%)}.dark .tag-huffman{background-color:hsl(50deg 80% 20%)}.tag-java{background-color:hsl(100deg 80% 70%)}.dark .tag-java{background-color:hsl(100deg 80% 20%)}.tag-java-module{background-color:hsl(150deg 80% 70%)}.dark .tag-java-module{background-color:hsl(150deg 80% 20%)}.tag-javascript{background-color:hsl(200deg 80% 70%)}.dark .tag-javascript{background-color:hsl(200deg 80% 20%)}.tag-jdk{background-color:hsl(250deg 80% 70%)}.dark .tag-jdk{background-color:hsl(250deg 80% 20%)}.tag-js{background-color:hsl(300deg 80% 70%)}.dark .tag-js{background-color:hsl(300deg 80% 20%)}.tag-jvm{background-color:hsl(350deg 80% 70%)}.dark .tag-jvm{background-color:hsl(350deg 80% 20%)}.tag-kernel{background-color:hsl(40deg 80% 70%)}.dark .tag-kernel{background-color:hsl(40deg 80% 20%)}.tag-lexer{background-color:hsl(90deg 80% 70%)}.dark .tag-lexer{background-color:hsl(90deg 80% 20%)}.tag-linux{background-color:hsl(140deg 80% 70%)}.dark .tag-linux{background-color:hsl(140deg 80% 20%)}.tag-log4j2{background-color:hsl(190deg 80% 70%)}.dark .tag-log4j2{background-color:hsl(190deg 80% 20%)}.tag-lz77{background-color:hsl(240deg 80% 70%)}.dark .tag-lz77{background-color:hsl(240deg 80% 20%)}.tag-make{background-color:hsl(290deg 80% 70%)}.dark .tag-make{background-color:hsl(290deg 80% 20%)}.tag-makefile{background-color:hsl(340deg 80% 70%)}.dark .tag-makefile{background-color:hsl(340deg 80% 20%)}.tag-maven{background-color:hsl(30deg 80% 70%)}.dark .tag-maven{background-color:hsl(30deg 80% 20%)}.tag-memory{background-color:hsl(80deg 80% 70%)}.dark .tag-memory{background-color:hsl(80deg 80% 20%)}.tag-multithreading{background-color:hsl(130deg 80% 70%)}.dark .tag-multithreading{background-color:hsl(130deg 80% 20%)}.tag-mybatis{background-color:hsl(180deg 80% 70%)}.dark .tag-mybatis{background-color:hsl(180deg 80% 20%)}.tag-mysql{background-color:hsl(230deg 80% 70%)}.dark .tag-mysql{background-color:hsl(230deg 80% 20%)}.tag-nasm{background-color:hsl(280deg 80% 70%)}.dark .tag-nasm{background-color:hsl(280deg 80% 20%)}.tag-node{background-color:hsl(330deg 80% 70%)}.dark .tag-node{background-color:hsl(330deg 80% 20%)}.tag-nodejs{background-color:hsl(20deg 80% 70%)}.dark .tag-nodejs{background-color:hsl(20deg 80% 20%)}.tag-openssl{background-color:hsl(70deg 80% 70%)}.dark .tag-openssl{background-color:hsl(70deg 80% 20%)}.tag-playwright{background-color:hsl(120deg 80% 70%)}.dark .tag-playwright{background-color:hsl(120deg 80% 20%)}.tag-posix{background-color:hsl(170deg 80% 70%)}.dark .tag-posix{background-color:hsl(170deg 80% 20%)}.tag-powershell{background-color:hsl(220deg 80% 70%)}.dark .tag-powershell{background-color:hsl(220deg 80% 20%)}.tag-programming-langauge{background-color:hsl(270deg 80% 70%)}.dark .tag-programming-langauge{background-color:hsl(270deg 80% 20%)}.tag-programming-language{background-color:hsl(320deg 80% 70%)}.dark .tag-programming-language{background-color:hsl(320deg 80% 20%)}.tag-qemu{background-color:hsl(10deg 80% 70%)}.dark .tag-qemu{background-color:hsl(10deg 80% 20%)}.tag-redis{background-color:hsl(60deg 80% 70%)}.dark .tag-redis{background-color:hsl(60deg 80% 20%)}.tag-retrocomputing{background-color:hsl(110deg 80% 70%)}.dark .tag-retrocomputing{background-color:hsl(110deg 80% 20%)}.tag-rfc{background-color:hsl(160deg 80% 70%)}.dark .tag-rfc{background-color:hsl(160deg 80% 20%)}.tag-sdram{background-color:hsl(210deg 80% 70%)}.dark .tag-sdram{background-color:hsl(210deg 80% 20%)}.tag-sed{background-color:hsl(260deg 80% 70%)}.dark .tag-sed{background-color:hsl(260deg 80% 20%)}.tag-slf4j{background-color:hsl(310deg 80% 70%)}.dark .tag-slf4j{background-color:hsl(310deg 80% 20%)}.tag-spring{background-color:hsl(0deg 80% 70%)}.dark .tag-spring{background-color:hsl(0deg 80% 20%)}.tag-spring-boot{background-color:hsl(50deg 80% 70%)}.dark .tag-spring-boot{background-color:hsl(50deg 80% 20%)}.tag-spring-data{background-color:hsl(100deg 80% 70%)}.dark .tag-spring-data{background-color:hsl(100deg 80% 20%)}.tag-spring-ioc{background-color:hsl(150deg 80% 70%)}.dark .tag-spring-ioc{background-color:hsl(150deg 80% 20%)}.tag-sql{background-color:hsl(200deg 80% 70%)}.dark .tag-sql{background-color:hsl(200deg 80% 20%)}.tag-streaming{background-color:hsl(250deg 80% 70%)}.dark .tag-streaming{background-color:hsl(250deg 80% 20%)}.tag-template{background-color:hsl(300deg 80% 70%)}.dark .tag-template{background-color:hsl(300deg 80% 20%)}.tag-testing{background-color:hsl(350deg 80% 70%)}.dark .tag-testing{background-color:hsl(350deg 80% 20%)}.tag-thymeleaf{background-color:hsl(40deg 80% 70%)}.dark .tag-thymeleaf{background-color:hsl(40deg 80% 20%)}.tag-tls{background-color:hsl(90deg 80% 70%)}.dark .tag-tls{background-color:hsl(90deg 80% 20%)}.tag-tomcat{background-color:hsl(140deg 80% 70%)}.dark .tag-tomcat{background-color:hsl(140deg 80% 20%)}.tag-transaction{background-color:hsl(190deg 80% 70%)}.dark .tag-transaction{background-color:hsl(190deg 80% 20%)}.tag-transistor{background-color:hsl(240deg 80% 70%)}.dark .tag-transistor{background-color:hsl(240deg 80% 20%)}.tag-ts{background-color:hsl(290deg 80% 70%)}.dark .tag-ts{background-color:hsl(290deg 80% 20%)}.tag-typescript{background-color:hsl(340deg 80% 70%)}.dark .tag-typescript{background-color:hsl(340deg 80% 20%)}.tag-unix{background-color:hsl(30deg 80% 70%)}.dark .tag-unix{background-color:hsl(30deg 80% 20%)}.tag-web{background-color:hsl(80deg 80% 70%)}.dark .tag-web{background-color:hsl(80deg 80% 20%)}.tag-x86{background-color:hsl(130deg 80% 70%)}.dark .tag-x86{background-color:hsl(130deg 80% 20%)}.tag-x86_64{background-color:hsl(180deg 80% 70%)}.dark .tag-x86_64{background-color:hsl(180deg 80% 20%)}.tag-x86-64{background-color:hsl(230deg 80% 70%)}.dark .tag-x86-64{background-color:hsl(230deg 80% 20%)}.tag-xpath{background-color:hsl(280deg 80% 70%)}.dark .tag-xpath{background-color:hsl(280deg 80% 20%)}.tag-zlib{background-color:hsl(330deg 80% 70%)}.dark .tag-zlib{background-color:hsl(330deg 80% 20%)}</style></head><body><script>localStorage.getItem("dark-theme")&&document.body.classList.add("dark")</script><header><h2 id=banner><a href=/>Infinity Architect</a></h2><div id=top-sections><a href=/android/ class=hoverable>Android </a><a href=/cxx/ class=hoverable>C/C++ </a><a href=/compression/ class=hoverable>Compression </a><a href=/cpu/ class=hoverable>CPU </a><a href=/crypto/ class=hoverable>Cryptography </a><a href=/db/ class=active>Database </a><a href=/ee/ class=hoverable>Electronic Engineering </a><a href=/linux/ class=hoverable>GNU/Linux </a><a href=/go/ class=hoverable>Golang </a><a href=/java/ class=hoverable>Java </a><a href=/microservice/ class=hoverable>Microservice </a><a href=/net/ class=hoverable>Network & Protocol </a><a href=/physics/ class=hoverable>Physics </a><a href=/retro/ class=hoverable>Retro-Computing </a><a href=/toy/ class=hoverable>Toys </a><a href=/windev/ class=hoverable>Window</a></div><div class=theme-switch style="align-self:center;margin:auto 20px"><input type=checkbox id=theme-checkbox>
<label for=theme-checkbox><div></div><span><svg viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M9.528 1.718a.75.75.0 01.162.819A8.97 8.97.0 009 6a9 9 0 009 9 8.97 8.97.0 003.463-.69.75.75.0 01.981.98 10.503 10.503.0 01-9.694 6.46c-5.799.0-10.5-4.701-10.5-10.5.0-4.368 2.667-8.112 6.46-9.694a.75.75.0 01.818.162z" clip-rule="evenodd"/></svg>
</span><span><svg viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M12 2.25a.75.75.0 01.75.75v2.25a.75.75.0 01-1.5.0V3a.75.75.0 01.75-.75zM7.5 12a4.5 4.5.0 119 0 4.5 4.5.0 01-9 0zM18.894 6.166a.75.75.0 00-1.06-1.06l-1.591 1.59a.75.75.0 101.06 1.061l1.591-1.59zM21.75 12a.75.75.0 01-.75.75h-2.25a.75.75.0 010-1.5H21a.75.75.0 01.75.75zm-3.916 6.894a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 10-1.061 1.06l1.59 1.591zM12 18a.75.75.0 01.75.75V21a.75.75.0 01-1.5.0v-2.25A.75.75.0 0112 18zM7.758 17.303a.75.75.0 00-1.061-1.06l-1.591 1.59a.75.75.0 001.06 1.061l1.591-1.59zM6 12a.75.75.0 01-.75.75H3a.75.75.0 010-1.5h2.25A.75.75.0 016 12zm.697-4.243a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 00-1.061 1.06l1.59 1.591z"/></svg></span></label></div></header><main><article class=basic-text><div style=font-family:monospace;font-size:1.5em><div class=basic-text>/<a href=/>HOME</a>/<a href=/db/>Database</a>/<a href=/db/redis/>Redis</a>/
$</div></div><div style=margin-bottom:60px><h1 style=margin-bottom:0>Redis Commands</h1><p class=aux-text style=margin-top:0>Published at: February 6, 2024
| Last modification: April 17, 2024</p><div style=line-height:2em><span class="page-tag tag-database">database</span>
<span class="page-tag tag-redis">redis</span></div></div><div><h2 id=top-level-command>Top Level Command</h2><h3 id=remove-key>Remove key</h3><ul><li><p><code>DEL key ...</code>: variadic delete keys; no wildcard support</p><p>Complexity of <code>DEL key</code> a single key is <code>O(M)</code>, <code>M</code> being the number of elements in the data structure associated with <code>key</code>. This means that deleting a string is O(1), but deleteing a data structure containing large number of objects (say a list of 50 million values) is slow. Given that redis is still (mainly) single-threaded epoll for now (version 6.2.1), this means <strong><code>DEL</code> could block all other requesets for a long time.</strong></p><p>See <code>UNLINK</code> for non-blocking delete, which runs in O(1) and employ a background garbage collecting thread to do the real delete.</p></li></ul><h3 id=expiration>Expiration</h3><ul><li><p><code>EXPIRE key sec</code>, <code>PEXPIRE key millisec</code>: Prescribe that <code>key</code> gets deleted in <code>sec</code> second/ <code>millisec</code> milliseconds.</p><ul><li>This computes and persists on the disk the timestamp of the instant of expiration, thus the behavior is always correct even if redis server is down.</li><li>The resolution is always millisecond.</li><li>Can be used to re-set a new expire time if previously has one.</li><li>Note that <code>key</code> can identify a data structure, not only string. For string we have a native one-liner syntax <code>SET key value [EX sec|PX millisec]</code> to set expiration.</li></ul></li><li><p><code>TTL key</code>, <code>PTTL key</code>: query living time in seconds/milliseconds</p><ul><li>return -1 for LIVE FOREVER</li><li>return -2 if key DOES NOT EXIST (may be already expired or never ever existsed)</li></ul></li><li><p><code>PERSIST key</code>: cancel the expiration schedule of <code>key</code>.</p></li></ul><h3 id=key-queries>Key Queries</h3><ul><li><p><code>KEYS pattern</code></p><p>list all keys that match the UNIX wildcard <code>pattern</code>.</p><p>In production the redis key set is usually large. Given the single-threaded nature of redis, a <code>KEY *</code> command can easily block the server.
See below <code>SCAN</code> for an alternative.</p></li><li><p><code>SCAN cursor [MATCH pattern]</code></p><p>Iteratively list all keys (with <code>MATCH pattern</code>, only keys that matches <code>pattern</code>) in the redis server.
<code>SCAN</code> is cursor based: to do a full iteration, first <code>SCAN 0</code>, and use the returned integer as the next <code>cursor</code>.
Server returns 0 to indicate that a full iteration is finished.
Properties of <code>SCAN</code> and its <code>[SHZ]SCAN</code> family:</p><ol><li>About changes during the iterative scanning:<ol><li>If lifetime of a key completely cover the scan (i.e. exist before <code>SCAN 0</code> and never die before server return 0),
it&rsquo;s guaranteed to returned to the client at some point.</li><li>If a key die before start of the SCAN, it&rsquo;s <strong>never</strong> returned to the client.</li><li>Otherwise, either an existing key is deleted or a new key is added during the scan. Integrity is undefined for those cases.</li></ol></li><li>As new keys are added, the same element might be returned multipled times. <strong>Application needs to unique the result if necessary</strong>.</li><li>The number of elements returned per step in the iterative scanning is <strong>non-determinisic</strong>: keep scanning until server returns 0.</li></ol></li><li><p><code>EXISTS key</code>: membership query of key in the top level space</p></li><li><p><code>TYPE key</code>: inspect the data type of <code>value</code> that is associated with <code>key</code></p></li></ul><h3 id=memory-monitoring>Memory Monitoring</h3><ul><li><p><code>MEMORY USAGE key</code></p><p>Report the number of byte used by <code>key</code> itself and the associated value.</p><div class=codeblock-hook><pre tabindex=0><code class=language-redis data-lang=redis>127.0.0.1:6379&gt; SET a 0
OK
127.0.0.1:6379&gt; SET b &#34;&#34;
OK
127.0.0.1:6379&gt; RPUSH c 1 3 5 7 9 2 4 6
(integer) 8
127.0.0.1:6379&gt; MEMORY USAGE a
(integer) 48
127.0.0.1:6379&gt; MEMORY USAGE b
(integer) 50            &lt;- kinda interesting that &#34;&#34; is bigger than &#34;0&#34;
127.0.0.1:6379&gt; MEMORY USAGE c
(integer) 147</code></pre><button>copy</button></div></li></ul><h2 id=string-command>String command</h2><p>Note that <code>GET/SET</code> is only valid for string type, e.g. illegal to <code>GET</code> a hash or zset.</p><ul><li><p><code>GET key</code></p></li><li><p><code>SET key value [EX sec | PX millisec | NX | XX KEEPTTL]</code>; return string &ldquo;OK&rdquo;</p><ul><li><code>NX</code>: set iff key NOT EXIST; (nil) if exist; Meant to replace <code>SETNX</code>.</li><li><code>XX</code>: set iff key EXIST; (nil) if not exist;</li></ul></li><li><p><code>SETNX</code> (deprecated, use <code>SET key value NX</code> instead)</p><p>was historically used to implement inter-client (i.e. distributed) lock.</p><ol><li>A client acquire the lock by <code>SETNX lockname &lt;cur_timestamp+lock timeout+1></code> (1);</li><li>Lock owner client release the lock by <code>DEL lockname</code>;</li><li>Other clients contending for the lock by also performing (1):<ul><li>This is natively a non-blocking tryLock()</li><li>For client that&rsquo;s willing to block for the lock, suspend the redis communication thread using application code.</li></ul></li></ol><p>This pattern is now <strong>deprecated</strong> in favor of the Redlock algorithm.</p></li><li><p><code>GETSET key new_value</code>: set key to <code>new_value</code> and return the original value</p></li><li><p><code>MSET k0 v0 k1 v1 k2 v2 ...</code>, <code>MGET k0 k1 k2 ...</code>: multiple get and set</p></li><li><p><code>INCR key</code>, <code>DECR key</code>, <code>INCRBY key delta</code>, <code>DECRBY key delta</code>: increase/decrease by 1/delta</p></li></ul><h2 id=list-commands>List Commands</h2><p>List is implemented as a double-linked list in redis. Conceptually &ldquo;left&rdquo; is &ldquo;begining&rdquo;, and &ldquo;right&rdquo; is &ldquo;end&rdquo;.</p><p>A key referring to a list is deleted when the list becomes empty.</p><ul><li><p><code>LPUSH|RPUSH key values...</code>: (variadic on value) left push / right push</p></li><li><p><code>LPOP|RPOP key</code>: left/right pop; <code>nil</code> is returned if list is empty;</p></li><li><p><code>BLPOP|BRPOP keys... timeout</code>: (variadic on key but at least 1) blocking left/right pop</p><ul><li><code>timeout</code> is mandatory; double, non-negative in seconds; 0 means wait forever</li><li>Return value are <code>(key, value)</code> pair indicating that among those <code>keys</code>, which one offer the value; or error when timeout</li><li>Return immediately if any keys (all of which are lists) are non-empty</li><li>If multiple lists specified in <code>keys</code> are non-empty, &mldr;</li><li>Fairness: If multiple client waiting on the same list, first come first serve.</li></ul></li><li><p><code>RPOPLPUSH src_list dest_list</code></p></li><li><p><code>BRPOPLPUSH src_list dest_list timeout</code></p></li></ul><p><em>prefix L below stands for list, not left.</em></p><ul><li><code>LRANGE key l r</code>: dump elements in range <code>[l,r]</code> <strong>0-indexed and both inclusive</strong>.<ul><li>negative index counts from the end of the list. e.g. -1 is last element, <code>LRANGE mylist 0 -1</code> dump all elements in the list.</li><li>e.g. <code>LRANGE mylist 0 10</code> will return 11 elements if <code>mylist</code> contains at least 11 elements.</li></ul></li><li><code>LLEN key</code>: return list length</li><li><code>LTRIM key l r</code>: crop list to <code>[l,r]</code> <strong>0-indexed and is both inclusive</strong>.</li></ul><h2 id=set-commands>SET Commands</h2><p>The underlying structure of a redis set is hash table.</p><p>The following assumes <code>key</code> is a set.</p><ul><li><p><code>SADD hash_set values...</code> (variadic on values)</p></li><li><p><code>SREM key value</code>
remove vlaue from key</p></li></ul><p>SCARD key
get cardinality.</p><p>SMEMBERS key
dump all members of key</p><p>SISMEMBER key value
test membership of value</p><p>Set Algebra (does NOT modify each)
SUNION x y z &mldr;
SUNIONSTORE dest x y z &mldr;
set union
SINTER x y z &mldr;
SINTERSTORE dest x y z &mldr;
set intersection
SDIFF x a b c &mldr;
SDIFFSTORE dest x a b c &mldr;
set difference ((x \ a) \ b) \ c &mldr;</p><p>SPOP key count
randomly pop count element(s) from key</p><p>SRANDMEMBER key count
randomly get count element(s) from key, WITHOUT modifying key</p><h2 id=sorted-set>sorted set</h2><p>Sorted set represented a set of strings each associated with a integer value called &ldquo;score&rdquo;. Elements
of sorted set are unique, and also sorted by &ldquo;score&rdquo;.</p><p>The underlying structure of a redis sorted set is a skip list (a peculiar type of balanced trees).</p><ul><li><p><code>ZADD key score element [score element...]</code> (varaidic on <code>score element</code> pair)</p><p>Add <code>value</code> with <code>score</code> to the sorted set identified by <code>key</code>.</p></li><li><p><code>ZREM key element...</code> (variadic on <code>element</code>)</p><p>Remove <code>element</code> from sorted set identified by <code>key</code>.
The complexity is <code>O(log(n))</code> for each element to be removed; n be the # of elements in the zset.
TODO: Recall that redis sorted set is sorted by score, how does search by element value also log(n)?</p></li></ul><p>Range op by rank:
- <code>ZRANK key element</code></p><pre><code>    determine rank (index) of value

- `ZRANGE sset start end [WITHSCORES]`

- `ZREVRANGE sset start end [WITHSCORES]`

- `ZREMRANGEBYRANK sset start end`
</code></pre><p>Range op by score
- <code>ZRANGEBYSCORE sset min max</code>
- <code>ZREVRANGEBYSCORE sset min max</code>
- <code>ZREMRANGEBYSCORE sset min max</code></p><ul><li><code>ZCARD sset</code>
cardinality.</li></ul><h2 id=hash-map>hash map</h2><p>The following assume <code>key</code> is a hash (map);</p><p><code>HSET key k v</code></p><p><code>HGET key k</code></p><p><code>HMSET key k0 v0 k1 v1 k2 v2 ...</code> variadic hset</p><p><code>HMGET key k0 k1 k2</code> variadic hget</p><p><code>HGET key k</code></p><p><code>HGETALL key</code> dump all kv pairs</p><p><code>HDEL key k</code></p><p><code>HINCR key k</code></p><p><code>HINCRBY key k delta</code>
there is no HDECR or HDECRBY; HINCRBY negative delta instead</p><h2 id=bitfield>bitfield</h2><h2 id=hyperloglogs>HyperLogLogs</h2><p>HLL is a probabilistic data structure to count unique elements using constant memory with a maximal 1% error. Only 3 commands so far for HLL;</p><ul><li><p><code>PFADD key elements...</code></p><p>Variadics on elements; tell the HLL structure named <code>key</code> to remember that it has seen elements.</p></li><li><p><code>PFCOUNT key...</code></p><p>Variadics on key</p></li></ul><p>A HLL structure is just a wrapper of a redis string. You can <code>GET</code> it to see the maintained probabilistic data structure:</p><ul><li><p><code>PFMERGE desthll srchll...</code></p><p>Merge all srchll into desthll; If desthll already exists, it&rsquo;s also treated as a srchll.</p></li></ul><div class=codeblock-hook><pre tabindex=0><code class=language-redis data-lang=redis>127.0.0.1:6379&gt; PFADD myhll a b c d e
(integer) 1
127.0.0.1:6379&gt; PFADD myhll2 1 3 7 42 b c a f
(integer) 1
127.0.0.1:6379&gt; PFCOUNT myhll
(integer) 5
127.0.0.1:6379&gt; PFCOUNT myhll2
(integer) 8
127.0.0.1:6379&gt; PFCOUNT myhll myhll2
(integer) 10                &lt;- count the tmp merge of myhll and myhll2; note the error
127.0.0.1:6379&gt; PFMERGE desthll myhll1 myhll2
OK
127.0.0.1:6379&gt; KEYS *
1) &#34;myhll&#34;
2) &#34;myhll2&#34;
3) &#34;desthll&#34;
127.0.0.1:6379&gt; PFCOUNT desthll
(integer) 8
127.0.0.1:6379&gt; GET desthll
&#34;HYLL\x01\x00\x00\x00\b\x00\x00\x00\x00\x00\x00\x00Fm\x80V\xf7\x80C\x8b\x80D\x9a\x80EK\x80F\xc8\x84HN\x80C\xab\x80BZ&#34;</code></pre><button>copy</button></div></div></article></main><footer>Unless otherwise noted, content of this site is licensed under
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ style=text-decoration:underline>the CC BY-NC-SA 4.0</a>.<br>cesun.info copyright 2024.</footer></body></html>