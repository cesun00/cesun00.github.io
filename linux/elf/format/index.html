<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Executable and Linkable Format (ELF) | Infinity Architect</title>
<link rel=stylesheet href=/main.css><script type=importmap>
  {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.167.1/+esm"
      }
  }
  </script><script type=module src=/theme.mjs></script><style>.tag-android{background-color:hsl(0deg 80% 70%)}.dark .tag-android{background-color:hsl(0deg 80% 20%)}.tag-annotation{background-color:hsl(50deg 80% 70%)}.dark .tag-annotation{background-color:hsl(50deg 80% 20%)}.tag-assembly{background-color:hsl(100deg 80% 70%)}.dark .tag-assembly{background-color:hsl(100deg 80% 20%)}.tag-asymmetrical-cryptography{background-color:hsl(150deg 80% 70%)}.dark .tag-asymmetrical-cryptography{background-color:hsl(150deg 80% 20%)}.tag-awk{background-color:hsl(200deg 80% 70%)}.dark .tag-awk{background-color:hsl(200deg 80% 20%)}.tag-bootloader{background-color:hsl(250deg 80% 70%)}.dark .tag-bootloader{background-color:hsl(250deg 80% 20%)}.tag-bytecode{background-color:hsl(300deg 80% 70%)}.dark .tag-bytecode{background-color:hsl(300deg 80% 20%)}.tag-c{background-color:hsl(350deg 80% 70%)}.dark .tag-c{background-color:hsl(350deg 80% 20%)}.tag-cxx{background-color:hsl(40deg 80% 70%)}.dark .tag-cxx{background-color:hsl(40deg 80% 20%)}.tag-cxx-stl{background-color:hsl(90deg 80% 70%)}.dark .tag-cxx-stl{background-color:hsl(90deg 80% 20%)}.tag-cgroup{background-color:hsl(140deg 80% 70%)}.dark .tag-cgroup{background-color:hsl(140deg 80% 20%)}.tag-cheetsheet{background-color:hsl(190deg 80% 70%)}.dark .tag-cheetsheet{background-color:hsl(190deg 80% 20%)}.tag-clang{background-color:hsl(240deg 80% 70%)}.dark .tag-clang{background-color:hsl(240deg 80% 20%)}.tag-coding-theory{background-color:hsl(290deg 80% 70%)}.dark .tag-coding-theory{background-color:hsl(290deg 80% 20%)}.tag-compression{background-color:hsl(340deg 80% 70%)}.dark .tag-compression{background-color:hsl(340deg 80% 20%)}.tag-concept{background-color:hsl(30deg 80% 70%)}.dark .tag-concept{background-color:hsl(30deg 80% 20%)}.tag-cpu{background-color:hsl(80deg 80% 70%)}.dark .tag-cpu{background-color:hsl(80deg 80% 20%)}.tag-crawler{background-color:hsl(130deg 80% 70%)}.dark .tag-crawler{background-color:hsl(130deg 80% 20%)}.tag-cryptography{background-color:hsl(180deg 80% 70%)}.dark .tag-cryptography{background-color:hsl(180deg 80% 20%)}.tag-css{background-color:hsl(230deg 80% 70%)}.dark .tag-css{background-color:hsl(230deg 80% 20%)}.tag-database{background-color:hsl(280deg 80% 70%)}.dark .tag-database{background-color:hsl(280deg 80% 20%)}.tag-deflate{background-color:hsl(330deg 80% 70%)}.dark .tag-deflate{background-color:hsl(330deg 80% 20%)}.tag-design{background-color:hsl(20deg 80% 70%)}.dark .tag-design{background-color:hsl(20deg 80% 20%)}.tag-dns{background-color:hsl(70deg 80% 70%)}.dark .tag-dns{background-color:hsl(70deg 80% 20%)}.tag-dom{background-color:hsl(120deg 80% 70%)}.dark .tag-dom{background-color:hsl(120deg 80% 20%)}.tag-driver{background-color:hsl(170deg 80% 70%)}.dark .tag-driver{background-color:hsl(170deg 80% 20%)}.tag-elastic{background-color:hsl(220deg 80% 70%)}.dark .tag-elastic{background-color:hsl(220deg 80% 20%)}.tag-elf{background-color:hsl(270deg 80% 70%)}.dark .tag-elf{background-color:hsl(270deg 80% 20%)}.tag-elk{background-color:hsl(320deg 80% 70%)}.dark .tag-elk{background-color:hsl(320deg 80% 20%)}.tag-flex{background-color:hsl(10deg 80% 70%)}.dark .tag-flex{background-color:hsl(10deg 80% 20%)}.tag-gc{background-color:hsl(60deg 80% 70%)}.dark .tag-gc{background-color:hsl(60deg 80% 20%)}.tag-gcc{background-color:hsl(110deg 80% 70%)}.dark .tag-gcc{background-color:hsl(110deg 80% 20%)}.tag-gnu{background-color:hsl(160deg 80% 70%)}.dark .tag-gnu{background-color:hsl(160deg 80% 20%)}.tag-go{background-color:hsl(210deg 80% 70%)}.dark .tag-go{background-color:hsl(210deg 80% 20%)}.tag-gzip{background-color:hsl(260deg 80% 70%)}.dark .tag-gzip{background-color:hsl(260deg 80% 20%)}.tag-hash{background-color:hsl(310deg 80% 70%)}.dark .tag-hash{background-color:hsl(310deg 80% 20%)}.tag-http{background-color:hsl(0deg 80% 70%)}.dark .tag-http{background-color:hsl(0deg 80% 20%)}.tag-huffman{background-color:hsl(50deg 80% 70%)}.dark .tag-huffman{background-color:hsl(50deg 80% 20%)}.tag-java{background-color:hsl(100deg 80% 70%)}.dark .tag-java{background-color:hsl(100deg 80% 20%)}.tag-java-module{background-color:hsl(150deg 80% 70%)}.dark .tag-java-module{background-color:hsl(150deg 80% 20%)}.tag-javascript{background-color:hsl(200deg 80% 70%)}.dark .tag-javascript{background-color:hsl(200deg 80% 20%)}.tag-jdk{background-color:hsl(250deg 80% 70%)}.dark .tag-jdk{background-color:hsl(250deg 80% 20%)}.tag-js{background-color:hsl(300deg 80% 70%)}.dark .tag-js{background-color:hsl(300deg 80% 20%)}.tag-jvm{background-color:hsl(350deg 80% 70%)}.dark .tag-jvm{background-color:hsl(350deg 80% 20%)}.tag-kernel{background-color:hsl(40deg 80% 70%)}.dark .tag-kernel{background-color:hsl(40deg 80% 20%)}.tag-lexer{background-color:hsl(90deg 80% 70%)}.dark .tag-lexer{background-color:hsl(90deg 80% 20%)}.tag-linux{background-color:hsl(140deg 80% 70%)}.dark .tag-linux{background-color:hsl(140deg 80% 20%)}.tag-log4j2{background-color:hsl(190deg 80% 70%)}.dark .tag-log4j2{background-color:hsl(190deg 80% 20%)}.tag-lz77{background-color:hsl(240deg 80% 70%)}.dark .tag-lz77{background-color:hsl(240deg 80% 20%)}.tag-make{background-color:hsl(290deg 80% 70%)}.dark .tag-make{background-color:hsl(290deg 80% 20%)}.tag-makefile{background-color:hsl(340deg 80% 70%)}.dark .tag-makefile{background-color:hsl(340deg 80% 20%)}.tag-maven{background-color:hsl(30deg 80% 70%)}.dark .tag-maven{background-color:hsl(30deg 80% 20%)}.tag-memory{background-color:hsl(80deg 80% 70%)}.dark .tag-memory{background-color:hsl(80deg 80% 20%)}.tag-multithreading{background-color:hsl(130deg 80% 70%)}.dark .tag-multithreading{background-color:hsl(130deg 80% 20%)}.tag-mybatis{background-color:hsl(180deg 80% 70%)}.dark .tag-mybatis{background-color:hsl(180deg 80% 20%)}.tag-mysql{background-color:hsl(230deg 80% 70%)}.dark .tag-mysql{background-color:hsl(230deg 80% 20%)}.tag-nasm{background-color:hsl(280deg 80% 70%)}.dark .tag-nasm{background-color:hsl(280deg 80% 20%)}.tag-node{background-color:hsl(330deg 80% 70%)}.dark .tag-node{background-color:hsl(330deg 80% 20%)}.tag-nodejs{background-color:hsl(20deg 80% 70%)}.dark .tag-nodejs{background-color:hsl(20deg 80% 20%)}.tag-openssl{background-color:hsl(70deg 80% 70%)}.dark .tag-openssl{background-color:hsl(70deg 80% 20%)}.tag-playwright{background-color:hsl(120deg 80% 70%)}.dark .tag-playwright{background-color:hsl(120deg 80% 20%)}.tag-posix{background-color:hsl(170deg 80% 70%)}.dark .tag-posix{background-color:hsl(170deg 80% 20%)}.tag-powershell{background-color:hsl(220deg 80% 70%)}.dark .tag-powershell{background-color:hsl(220deg 80% 20%)}.tag-programming-langauge{background-color:hsl(270deg 80% 70%)}.dark .tag-programming-langauge{background-color:hsl(270deg 80% 20%)}.tag-programming-language{background-color:hsl(320deg 80% 70%)}.dark .tag-programming-language{background-color:hsl(320deg 80% 20%)}.tag-qemu{background-color:hsl(10deg 80% 70%)}.dark .tag-qemu{background-color:hsl(10deg 80% 20%)}.tag-redis{background-color:hsl(60deg 80% 70%)}.dark .tag-redis{background-color:hsl(60deg 80% 20%)}.tag-retrocomputing{background-color:hsl(110deg 80% 70%)}.dark .tag-retrocomputing{background-color:hsl(110deg 80% 20%)}.tag-rfc{background-color:hsl(160deg 80% 70%)}.dark .tag-rfc{background-color:hsl(160deg 80% 20%)}.tag-sdram{background-color:hsl(210deg 80% 70%)}.dark .tag-sdram{background-color:hsl(210deg 80% 20%)}.tag-sed{background-color:hsl(260deg 80% 70%)}.dark .tag-sed{background-color:hsl(260deg 80% 20%)}.tag-slf4j{background-color:hsl(310deg 80% 70%)}.dark .tag-slf4j{background-color:hsl(310deg 80% 20%)}.tag-spring{background-color:hsl(0deg 80% 70%)}.dark .tag-spring{background-color:hsl(0deg 80% 20%)}.tag-spring-boot{background-color:hsl(50deg 80% 70%)}.dark .tag-spring-boot{background-color:hsl(50deg 80% 20%)}.tag-spring-data{background-color:hsl(100deg 80% 70%)}.dark .tag-spring-data{background-color:hsl(100deg 80% 20%)}.tag-spring-ioc{background-color:hsl(150deg 80% 70%)}.dark .tag-spring-ioc{background-color:hsl(150deg 80% 20%)}.tag-sql{background-color:hsl(200deg 80% 70%)}.dark .tag-sql{background-color:hsl(200deg 80% 20%)}.tag-streaming{background-color:hsl(250deg 80% 70%)}.dark .tag-streaming{background-color:hsl(250deg 80% 20%)}.tag-template{background-color:hsl(300deg 80% 70%)}.dark .tag-template{background-color:hsl(300deg 80% 20%)}.tag-testing{background-color:hsl(350deg 80% 70%)}.dark .tag-testing{background-color:hsl(350deg 80% 20%)}.tag-thymeleaf{background-color:hsl(40deg 80% 70%)}.dark .tag-thymeleaf{background-color:hsl(40deg 80% 20%)}.tag-tls{background-color:hsl(90deg 80% 70%)}.dark .tag-tls{background-color:hsl(90deg 80% 20%)}.tag-tomcat{background-color:hsl(140deg 80% 70%)}.dark .tag-tomcat{background-color:hsl(140deg 80% 20%)}.tag-transaction{background-color:hsl(190deg 80% 70%)}.dark .tag-transaction{background-color:hsl(190deg 80% 20%)}.tag-transistor{background-color:hsl(240deg 80% 70%)}.dark .tag-transistor{background-color:hsl(240deg 80% 20%)}.tag-ts{background-color:hsl(290deg 80% 70%)}.dark .tag-ts{background-color:hsl(290deg 80% 20%)}.tag-typescript{background-color:hsl(340deg 80% 70%)}.dark .tag-typescript{background-color:hsl(340deg 80% 20%)}.tag-unix{background-color:hsl(30deg 80% 70%)}.dark .tag-unix{background-color:hsl(30deg 80% 20%)}.tag-web{background-color:hsl(80deg 80% 70%)}.dark .tag-web{background-color:hsl(80deg 80% 20%)}.tag-x86{background-color:hsl(130deg 80% 70%)}.dark .tag-x86{background-color:hsl(130deg 80% 20%)}.tag-x86_64{background-color:hsl(180deg 80% 70%)}.dark .tag-x86_64{background-color:hsl(180deg 80% 20%)}.tag-x86-64{background-color:hsl(230deg 80% 70%)}.dark .tag-x86-64{background-color:hsl(230deg 80% 20%)}.tag-xpath{background-color:hsl(280deg 80% 70%)}.dark .tag-xpath{background-color:hsl(280deg 80% 20%)}.tag-zlib{background-color:hsl(330deg 80% 70%)}.dark .tag-zlib{background-color:hsl(330deg 80% 20%)}</style></head><body><script>localStorage.getItem("dark-theme")&&document.body.classList.add("dark")</script><header><h2 id=banner><a href=/>Infinity Architect</a></h2><div id=top-sections><a href=/android/ class=hoverable>Android </a><a href=/cxx/ class=hoverable>C/C++ </a><a href=/compression/ class=hoverable>Compression </a><a href=/cpu/ class=hoverable>CPU </a><a href=/crypto/ class=hoverable>Cryptography </a><a href=/db/ class=hoverable>Database </a><a href=/ee/ class=hoverable>Electronic Engineering </a><a href=/linux/ class=active>GNU/Linux </a><a href=/go/ class=hoverable>Golang </a><a href=/java/ class=hoverable>Java </a><a href=/microservice/ class=hoverable>Microservice </a><a href=/net/ class=hoverable>Network & Protocol </a><a href=/physics/ class=hoverable>Physics </a><a href=/retro/ class=hoverable>Retro-Computing </a><a href=/toy/ class=hoverable>Toys </a><a href=/windev/ class=hoverable>Window</a></div><div class=theme-switch style="align-self:center;margin:auto 20px"><input type=checkbox id=theme-checkbox>
<label for=theme-checkbox><div></div><span><svg viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M9.528 1.718a.75.75.0 01.162.819A8.97 8.97.0 009 6a9 9 0 009 9 8.97 8.97.0 003.463-.69.75.75.0 01.981.98 10.503 10.503.0 01-9.694 6.46c-5.799.0-10.5-4.701-10.5-10.5.0-4.368 2.667-8.112 6.46-9.694a.75.75.0 01.818.162z" clip-rule="evenodd"/></svg>
</span><span><svg viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M12 2.25a.75.75.0 01.75.75v2.25a.75.75.0 01-1.5.0V3a.75.75.0 01.75-.75zM7.5 12a4.5 4.5.0 119 0 4.5 4.5.0 01-9 0zM18.894 6.166a.75.75.0 00-1.06-1.06l-1.591 1.59a.75.75.0 101.06 1.061l1.591-1.59zM21.75 12a.75.75.0 01-.75.75h-2.25a.75.75.0 010-1.5H21a.75.75.0 01.75.75zm-3.916 6.894a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 10-1.061 1.06l1.59 1.591zM12 18a.75.75.0 01.75.75V21a.75.75.0 01-1.5.0v-2.25A.75.75.0 0112 18zM7.758 17.303a.75.75.0 00-1.061-1.06l-1.591 1.59a.75.75.0 001.06 1.061l1.591-1.59zM6 12a.75.75.0 01-.75.75H3a.75.75.0 010-1.5h2.25A.75.75.0 016 12zm.697-4.243a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 00-1.061 1.06l1.59 1.591z"/></svg></span></label></div></header><main><article class=basic-text><div style=font-family:monospace;font-size:1.5em><div class=basic-text>/<a href=/>HOME</a>/<a href=/linux/>GNU/Linux</a>/<a href=/linux/elf/>ELF: Executable & Linkable Format for Linux</a>/
$</div></div><div style=margin-bottom:60px><h1 style=margin-bottom:0>Executable and Linkable Format (ELF)</h1><p class=aux-text style=margin-top:0>Published at: January 29, 2024
| Last modification: July 25, 2024</p><div style=line-height:2em><span class="page-tag tag-elf">ELF</span>
<span class="page-tag tag-linux">Linux</span>
<span class="page-tag tag-unix">Unix</span></div></div><div><p>The <em>Executable and Linkable File</em> (ELF) format is widely used by various *NIX systems, including Linux, Solaris and *BSD, as the format of object files, shared objects (equivalence of Windows&rsquo; DLL) and executables. Modern Linux kernel itself is also packaged as an ELF executable before compressed as <code>vmlinuz</code>.</p><p>This article gives an overview of the ELF format.</p><h2 id=overview>Overview</h2><p>There are 4 types of ELF files (defined by <code>e_type</code> enum below), all sharing the same ELF layout in the following diagram,
with the exception that <em>ELF Relocatables</em> (<code>ET_REL</code>, i.e. <code>.o</code> files) don&rsquo;t have the program header table:</p><figure><img src=./elf.drawio.svg alt="ELF layout overview."><figcaption><p>ELF layout overview.</p></figcaption></figure><p>The ELF specification:</p><ul><li>mandates that the ELF header must appear at the beginning of the file.</li><li>allows arbitrary ordering and file offset of the PHT, SHT, and sections, although all known assemblers & linkers put the PHT (if present) immediately after the ELF header, and SHT before the end of the file.</li></ul><h2 id=data-types>Data Types</h2><p>The ELF specification defines 2 variants of ELF files, <em>ELF32</em> and <em>ELF64</em>, for delivering programs targeting 32-bit word-length CPU (e.g. protected mode x86/x86-64, ARM, etc) and 64-bit CPU (e.g. 64-bit mode x86-64, ARM64, etc).
ELF32 and ELF64 share most structure definitions and differ only by the size of pointers and file offset being 32 or 64 bits.</p><p>For most Linux distros, ELF-related structures are defined in the <code>/usr/include/elf.h</code> (from glibc).</p><p>Regardless of ELF32 or 64:</p><ul><li><code>ELF*_Half</code> are 16-bit unsigned integers</li><li><code>ELF*_Word/ ELF*_Sword</code> are 32-bit unsigned / signed integers</li><li><code>ELF*_Xword/ ELF*_Sxword</code> are 64-bit unsigned / signed integers</li></ul><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#75715e>/* Type for a 16-bit quantity.  */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>uint16_t</span> Elf32_Half;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>uint16_t</span> Elf64_Half;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#75715e>/* Types for signed and unsigned 32-bit quantities.  */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>uint32_t</span> Elf32_Word;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#66d9ef>typedef</span>	<span style=color:#66d9ef>int32_t</span>  Elf32_Sword;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>uint32_t</span> Elf64_Word;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#66d9ef>typedef</span>	<span style=color:#66d9ef>int32_t</span>  Elf64_Sword;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#75715e>/* Types for signed and unsigned 64-bit quantities.  */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>uint64_t</span> Elf32_Xword;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#66d9ef>typedef</span>	<span style=color:#66d9ef>int64_t</span>  Elf32_Sxword;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>uint64_t</span> Elf64_Xword;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#66d9ef>typedef</span>	<span style=color:#66d9ef>int64_t</span>  Elf64_Sxword;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#75715e>/* Type of addresses.  */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>uint32_t</span> Elf32_Addr;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>uint64_t</span> Elf64_Addr;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#75715e>/* Type of file offsets.  */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>uint32_t</span> Elf32_Off;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>uint64_t</span> Elf64_Off;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span><span style=color:#75715e>/* Type for section indices, which are 16-bit quantities.  */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>uint16_t</span> Elf32_Section;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>uint16_t</span> Elf64_Section;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span><span style=color:#75715e>/* Type for version symbol information.  */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span><span style=color:#66d9ef>typedef</span> Elf32_Half Elf32_Versym;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span><span style=color:#66d9ef>typedef</span> Elf64_Half Elf64_Versym;</span></span></code></pre></div><button>copy</button></div><h2 id=elf-header>ELF (File) Header</h2><p>The ELF header contains the offset of the section header table (SHT) and program header table (PHT) (if present) in the file,
which in turn contains program headers and section headers that locate each section and segment.</p><p>The ELF header is defined as:</p><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#75715e>#define EI_NIDENT (16)
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>struct</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>	e_ident[EI_NIDENT];	<span style=color:#75715e>/* Magic number and other info */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>  Elf32_Half	e_type;			<span style=color:#75715e>/* Object file type */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>  Elf32_Half	e_machine;		<span style=color:#75715e>/* Architecture */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>  Elf32_Word	e_version;		<span style=color:#75715e>/* Object file version */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>  Elf32_Addr	e_entry;		<span style=color:#75715e>/* Entry point virtual address */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>  Elf32_Off	e_phoff;		<span style=color:#75715e>/* Program header table file offset */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>  Elf32_Off	e_shoff;		<span style=color:#75715e>/* Section header table file offset */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  Elf32_Word	e_flags;		<span style=color:#75715e>/* Processor-specific flags */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>  Elf32_Half	e_ehsize;		<span style=color:#75715e>/* ELF header size in bytes */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>  Elf32_Half	e_phentsize;		<span style=color:#75715e>/* Program header table entry size */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>  Elf32_Half	e_phnum;		<span style=color:#75715e>/* Program header table entry count */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>  Elf32_Half	e_shentsize;		<span style=color:#75715e>/* Section header table entry size */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>  Elf32_Half	e_shnum;		<span style=color:#75715e>/* Section header table entry count */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>  Elf32_Half	e_shstrndx;		<span style=color:#75715e>/* Section header string table index */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>} Elf32_Ehdr;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>struct</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>	e_ident[EI_NIDENT];	<span style=color:#75715e>/* Magic number and other info */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>  Elf64_Half	e_type;			<span style=color:#75715e>/* Object file type */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>  Elf64_Half	e_machine;		<span style=color:#75715e>/* Architecture */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>  Elf64_Word	e_version;		<span style=color:#75715e>/* Object file version */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>  Elf64_Addr	e_entry;		<span style=color:#75715e>/* Entry point virtual address */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>  Elf64_Off	e_phoff;		<span style=color:#75715e>/* Program header table file offset */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>  Elf64_Off	e_shoff;		<span style=color:#75715e>/* Section header table file offset */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>  Elf64_Word	e_flags;		<span style=color:#75715e>/* Processor-specific flags */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>  Elf64_Half	e_ehsize;		<span style=color:#75715e>/* ELF header size in bytes */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>  Elf64_Half	e_phentsize;		<span style=color:#75715e>/* Program header table entry size */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>  Elf64_Half	e_phnum;		<span style=color:#75715e>/* Program header table entry count */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>  Elf64_Half	e_shentsize;		<span style=color:#75715e>/* Section header table entry size */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>  Elf64_Half	e_shnum;		<span style=color:#75715e>/* Section header table entry count */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>  Elf64_Half	e_shstrndx;		<span style=color:#75715e>/* Section header string table index */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>} Elf64_Ehdr;</span></span></code></pre></div><button>copy</button></div><p>The comment should have explained most fields.
Section header table (SHT) and Program header table (PHT) will be discussed in detail after the ELF header is explained.</p><h3 id=e_ident-the-elf-identification><code>e_ident[]</code>: The ELF Identification</h3><p>The first 16 bytes of the ELF header (i.e. also the first 16 bytes of an ELF file)
are critical metadata about this ELF file.</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 1040 73"><g transform="translate(8,16)"><path d="M0 16H64" fill="none" stroke="currentcolor"/><path d="M64 16h64" fill="none" stroke="currentcolor"/><path d="M128 16h64" fill="none" stroke="currentcolor"/><path d="M192 16h64" fill="none" stroke="currentcolor"/><path d="M256 16h64" fill="none" stroke="currentcolor"/><path d="M320 16h64" fill="none" stroke="currentcolor"/><path d="M384 16h64" fill="none" stroke="currentcolor"/><path d="M448 16h64" fill="none" stroke="currentcolor"/><path d="M512 16h64" fill="none" stroke="currentcolor"/><path d="M576 16h64" fill="none" stroke="currentcolor"/><path d="M640 16h64" fill="none" stroke="currentcolor"/><path d="M704 16h64" fill="none" stroke="currentcolor"/><path d="M768 16h64" fill="none" stroke="currentcolor"/><path d="M832 16h64" fill="none" stroke="currentcolor"/><path d="M896 16h64" fill="none" stroke="currentcolor"/><path d="M960 16h64" fill="none" stroke="currentcolor"/><path d="M0 48H64" fill="none" stroke="currentcolor"/><path d="M64 48h64" fill="none" stroke="currentcolor"/><path d="M128 48h64" fill="none" stroke="currentcolor"/><path d="M192 48h64" fill="none" stroke="currentcolor"/><path d="M256 48h64" fill="none" stroke="currentcolor"/><path d="M320 48h64" fill="none" stroke="currentcolor"/><path d="M384 48h64" fill="none" stroke="currentcolor"/><path d="M448 48h64" fill="none" stroke="currentcolor"/><path d="M512 48h64" fill="none" stroke="currentcolor"/><path d="M576 48h64" fill="none" stroke="currentcolor"/><path d="M640 48h64" fill="none" stroke="currentcolor"/><path d="M704 48h64" fill="none" stroke="currentcolor"/><path d="M768 48h64" fill="none" stroke="currentcolor"/><path d="M832 48h64" fill="none" stroke="currentcolor"/><path d="M896 48h64" fill="none" stroke="currentcolor"/><path d="M960 48h64" fill="none" stroke="currentcolor"/><path d="M0 16V48" fill="none" stroke="currentcolor"/><path d="M256 16V48" fill="none" stroke="currentcolor"/><path d="M320 16V48" fill="none" stroke="currentcolor"/><path d="M384 16V48" fill="none" stroke="currentcolor"/><path d="M448 16V48" fill="none" stroke="currentcolor"/><path d="M512 16V48" fill="none" stroke="currentcolor"/><path d="M576 16V48" fill="none" stroke="currentcolor"/><path d="M1024 16V48" fill="none" stroke="currentcolor"/><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="16" y="36" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="24" y="36" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="32" y="36" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="40" y="36" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="48" y="36" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="64" y="4" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="128" y="4" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="192" y="4" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="256" y="4" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="272" y="36" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="280" y="36" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="288" y="36" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="296" y="36" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="304" y="36" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="320" y="4" fill="currentcolor" style="font-size:1em">5</text><text text-anchor="middle" x="336" y="36" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="344" y="36" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="352" y="36" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="360" y="36" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="384" y="4" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="400" y="36" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="408" y="36" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="416" y="36" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="448" y="4" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="464" y="36" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="472" y="36" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="480" y="36" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="488" y="36" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="496" y="36" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="512" y="4" fill="currentcolor" style="font-size:1em">8</text><text text-anchor="middle" x="528" y="36" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="536" y="36" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="544" y="36" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="552" y="36" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="560" y="36" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="568" y="36" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="576" y="4" fill="currentcolor" style="font-size:1em">9</text><text text-anchor="middle" x="592" y="36" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="600" y="36" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="608" y="36" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="616" y="36" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="624" y="36" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="632" y="36" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="640" y="4" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="640" y="36" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="648" y="4" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="712" y="4" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="720" y="4" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="776" y="4" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="784" y="4" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="832" y="4" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="840" y="4" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="896" y="4" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="904" y="4" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="960" y="4" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="968" y="4" fill="currentcolor" style="font-size:1em">5</text></g></svg></div><table><thead><tr><th>byte offset & mnemonics macro</th><th>descriptions</th><th>permitted values</th></tr></thead><tbody><tr><td>0 ~ 3 (<code>EI_MAG0</code> ~ <code>EI_MAG3</code>)</td><td>Magic number.</td><td>Must be <code>0x7F</code> followed by <code>E L F</code> in ASCII.</td></tr><tr><td>4 (<code>EI_CLASS</code>)</td><td>Whether this file is ELF32 or ELF64.</td><td><ul><li><code>ELFCLASSNONE=0</code> Invalid class</li><li><code>ELFCLASS32=1</code> 32-bit objects</li><li><code>ELFCLASS64=2</code> 64-bit objects</li></ul></td></tr><tr><td>5 (<code>EI_DATA</code>)</td><td>The endianness of integers in this ELF file.</td><td><ul><li><code>ELFDATANONE=0</code> Invalid data encoding</li><li><code>ELFDATA2LSB=1</code> 2's complement, little endian</li><li><code>ELFDATA2MSB=2</code> 2's complement, big endian</li></ul></td></tr><tr><td>6 (<code>EI_VERSION</code>)</td><td>ELF specification version this file conform to.</td><td>Must be <code>EV_CURRENT=1</code>.</td></tr><tr><td>7 (<code>EI_OSABI</code>)</td><td>Targeting ABI.<p>Nowadays this field is pretty much insignificant, and all Unix descendants use compatible System V
ABI.
Linux (kernel) simply doesn't check this field when loading an ELF.</p></td><td>Search for <code>ELFOSABI_*</code> in <code>elf.h</code>.<p>GCC when compiling for Linux generates <code>ELFOSABI_SYSV=0</code> for this field, indicating <a href=https://refspecs.linuxbase.org/elf/x86_64-abi-0.99.pdf>UNIX System V ABI</a>.</p></td></tr><tr><td>8 (<code>EI_ABIVERSION</code>)</td><td>The version of targeting ABI.<ul><li>For shared object with <code>e_ident[EI_OSABI] == 3 (ELFOSABI_GNU)</code>,
the dynamic linker <code>ld.so</code> since glibc 2.12 treats this field as version requirement.</li><li>Otherwise this field is ignored by both Linux kernel and <code>ld.so</code></li></ul></td><td>Any fitting integer.</td></tr><tr><td>9 (<code>EI_PAD</code>) ~ 15</td><td>padding</td><td>Must be 0.</td></tr></tbody></table><h3 id=e_type---identifies-one-of-the-4-elf-types><code>e_type</code> - identifies one of the 4 ELF types</h3><p><code>e_type</code> identifies this ELF file being one of the 4 aforementioned types: relocatable (<code>.o</code>), executable, shared object, or kernel dump.</p><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#75715e>/* Legal values for e_type (object file type).  */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#75715e>#define ET_NONE		0		</span><span style=color:#75715e>/* unknown file type */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#75715e>#define ET_REL		1		</span><span style=color:#75715e>/* Relocatable file */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#75715e>#define ET_EXEC		2		</span><span style=color:#75715e>/* Executable file */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#75715e>#define ET_DYN		3		</span><span style=color:#75715e>/* Shared object file */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#75715e>#define ET_CORE		4		</span><span style=color:#75715e>/* Core file */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#75715e>#define	ET_NUM		5		</span><span style=color:#75715e>/* Number of defined types */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#75715e>#define ET_LOOS		0xfe00		</span><span style=color:#75715e>/* OS-specific range start */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#75715e>#define ET_HIOS		0xfeff		</span><span style=color:#75715e>/* OS-specific range end */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#75715e>#define ET_LOPROC	0xff00		</span><span style=color:#75715e>/* Processor-specific range start */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#75715e>#define ET_HIPROC	0xffff		</span><span style=color:#75715e>/* Processor-specific range end */</span></span></span></code></pre></div><button>copy</button></div><ul><li>Interpretation of value in <code>[ET_LOOS, ET_HIOS]</code> are subjected to different <code>EI_OSABI</code></li><li>Interpretation of value in <code>[ET_LOPROC, ET_HIPROC]</code> are subjected to different <code>e_machine</code></li></ul><p>Search for <code>ET_*</code> in <code>elf.h</code> for valid values of OS-specific / processor-specific <code>e_type</code>.</p><h3 id=e_machine---identifies-the-isa-of-instructions><code>e_machine</code> - identifies the ISA of instructions</h3><p><code>e_machine</code> identifies the target CPU ISA (instruction set architecture) of instructions held in code sections e.g. <code>.text</code>, <code>.init / .fini</code> etc.</p><p>Some examples are:</p><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#75715e>/* Legal values for e_machine (architecture).  */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#75715e>#define EM_NONE		 0	</span><span style=color:#75715e>/* No machine */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#75715e>#define EM_SPARC	 2	</span><span style=color:#75715e>/* SUN SPARC */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#75715e>#define EM_386		 3	</span><span style=color:#75715e>/* Intel 80386 */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#75715e>#define EM_ARM		40	</span><span style=color:#75715e>/* ARM */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#75715e>#define EM_X86_64	62	</span><span style=color:#75715e>/* AMD x86-64 architecture */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#75715e>#define EM_BPF		247	</span><span style=color:#75715e>/* Linux BPF -- in-kernel virtual machine */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#75715e>#define EM_CSKY		252     </span><span style=color:#75715e>/* C-SKY */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#75715e>#define EM_NUM		253</span></span></span></code></pre></div><button>copy</button></div><h3 id=e_version><code>e_version</code></h3><p>Must be the same as <code>e_ident[EI_VERSION]</code>, must be <code>EV_CURRENT=1</code>.</p><h3 id=e_entry><code>e_entry</code></h3><ul><li>For executables (i.e. <code>e_type = ET_EXEC</code>), <code>e_entry</code> holds the memory address of the first instruction where the process starts executing. OS kernel should set the <code>PC</code> register to <code>e_entry</code> after loading is finished. Depending on the CPU model on which / modes in which this executable is designed to run, this may or may not be a virtual address (think about supporting x86 real mode).</li><li>Otherwise, this field must hold 0.</li></ul><h3 id=e_flags---processor-specific-flags><code>e_flags</code> - Processor-specific flags</h3><p><code>e_flags</code> documents processor-specific flags associated with the file, whose interpretation is subject to <code>e_machine</code>.
Search <code>EF_*</code> in <code>elf.h</code> for valid values.</p><p>ELF for x86 and x86_64 doesn&rsquo;t use this field, and usually holds 0.
e.g. some valid values for ARM CPUs are:</p><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#75715e>#define EF_ARM_RELEXEC		0x01
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#75715e>#define EF_ARM_HASENTRY		0x02
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#75715e>#define EF_ARM_INTERWORK	0x04
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#75715e>#define EF_ARM_APCS_26		0x08
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#75715e>#define EF_ARM_APCS_FLOAT	0x10
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span><span style=color:#75715e>#define EF_ARM_PIC		0x20</span></span></span></code></pre></div><button>copy</button></div><h3 id=e_ehsize---the-size-of-this-elf-header><code>e_ehsize</code> - the size of this ELF header</h3><p><code>e_ehsize</code> holds the size of its containing <code>Elf32_Ehdr</code> or <code>Elf64_Ehdr</code> in bytes, i.e. being either 52 or 64 bytes.</p><h2 id=section-and-segment-view>Section and Segment View</h2><p>There are 2 views into an ELF file:</p><ul><li>the <em>section view</em> is for the static linker (<code>ld</code>), and divides an ELF file into sections. A static linker doesn&rsquo;t care about PHT or segments.</li><li>the <em>segment view</em> is for the dynamic linker (<code>/lib/ld.so</code>), and divides and ELF file into segments. A dynamic linker doesn&rsquo;t care about SHT or sections. That being said, a segment is always an aggregate of a few adjacent sections, such that sections with similar properties are always loaded as a whole chunk at runtime.</li></ul><p>SHT and sections, and PHT and segments are explained the next chapters.</p><h2 id=the-section-view>The Section View</h2><p>SHT and sections define the section view of an ELF file.
A static linker doesn&rsquo;t care about PHT or segments, which is discussed later.</p><p>This section explains how SHT works, and gives an introduction to some special sections.</p><h3 id=section-header-table-sht>Section Header Table (SHT)</h3><p>The SHT is a list of <code>struct Elf64_Shdr</code> each known as a section header.
A section header provides metadata about a section.</p><p>The location and size of the SHT within an ELF file can be determined by inspecting <a href=#elf-header>the ELF header</a>:</p><ul><li>the offset of the SHT into an ELF file is given in <code>e_shoff</code></li><li>the size of each section header (in bytes) is given in <code>e_shentsize</code></li><li>The number of section headers in the SHT is given in <code>e_shnum</code></li></ul><p>The first section header in SHT must be full zero. <em>(with one exception for AMD64 when the <code>number of program headers >= 0xffff</code> (an outrageous number). Search for <code>PN_XNUM</code> <a href=https://refspecs.linuxfoundation.org/elf/x86_64-abi-0.99.pdf>here</a> for details)</em></p><p>The structure of each section header is defined as:</p><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>struct</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>  Elf64_Word	sh_name;		<span style=color:#75715e>/* Section name (string tbl index into .shstrtab) */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>  Elf64_Word	sh_type;		<span style=color:#75715e>/* Section type */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  Elf64_Xword	sh_flags;		<span style=color:#75715e>/* Section flags */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>  Elf64_Addr	sh_addr;		<span style=color:#75715e>/* Section virtual addr at execution */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>                                        <span style=color:#75715e>// ELF compiled for AMD64 should not use this field.
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>  Elf64_Off	sh_offset;		<span style=color:#75715e>/* Section file offset */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>  Elf64_Xword	sh_size;		<span style=color:#75715e>/* Section size in bytes */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>  Elf64_Word	sh_link;		<span style=color:#75715e>/* Link to another section */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>  Elf64_Word	sh_info;		<span style=color:#75715e>/* Additional section information */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>  Elf64_Xword	sh_addralign;		<span style=color:#75715e>/* Section alignment */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>  Elf64_Xword	sh_entsize;		<span style=color:#75715e>/* Entry size if section holds table */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>} Elf64_Shdr;</span></span></code></pre></div><button>copy</button></div><p>Most fields should be axiomatic, others are explained below.</p><div class="card info"><div class=card-icon><span>ℹ️</span></div><div class=card-content><p>There is not a clear boundary between the semantics of <code>sh_type</code> and <code>sh_flags</code>, and not all mix-and-match of the values of these fields makes sense.</p><p>Roughly <code>sh_type</code> identify what the content of the section is, and <code>sh_flag</code> tells</p><p>There are 2 reasons for this.</p><ol><li>The specification dictates a few special sections, identified by their name, with fixed <code>sh_type</code> and <code>sh_flags</code>. These special sections satisfy almost all needs for modern use of ELF. There is very few reason for compilers and linkers to use a . We will be talking about these special sections later.</li><li>Even if you writes assembly and use custom section names, the assembler known whether its a code or data section
Usage of these special sections are very pervasive, to the extend that a compiler-
Mainstream assemblers and linkers always create and the same collection of sections with stereotyped patterns of types and flags.
can only have fixed <code>sh_type</code>
The design of <code>sh_type</code> and <code>sh_flags</code> has become rather meaningless because these special sections must have
Such patterns have become a , to the extent that
not all mix-and-match of <code>sh_type</code> and <code>sh_type</code> are meaningful, or some <code>sh_type</code> and <code>sh_flags</code> are only permitted for a section
that has a specific special name.
For example, ELF specification leaves it unspecified what if an <code>SHT_SYMTAB</code> section is not named <code>.symtab</code>.</li></ol></div></div><h4 id=sh_type-sh_link-and-sh_info><code>sh_type</code>, <code>sh_link</code>, and <code>sh_info</code></h4><ul><li><code>sh_type</code> indicates the type of content held in this section, and determines the interpretation of <code>sh_link</code> and <code>sh_info</code>.</li><li><code>sh_link</code>, if used, is always an index of another section into the SHT.</li><li><code>sh_info</code>, if used, holds an arbitrary 32-bit value, but is usually an index into a string table.</li></ul><div class=wide-container><button>expand</button><div class=wide-item><table><thead><tr><td><code>sh_type</code></td><td style=width:40%>content is ...</td><td><code>sh_link</code> refer a section of ...</td><td><code>sh_info</code> is</td><td>Example</td></tr></thead><tbody><tr><td><code>SHT_NULL (0)</code></td><td>Unused SHT entry.<p>An entry must be of this type iff. it is the first entry in the SHT.</p></td><td>must be 0</td><td>must be 0</td><td>The first entry of SHT in any conforming ELF file.</td></tr><tr><td><code>SHT_PROGBITS (1)</code></td><td><p>Program data.</p><p>The section holds information defined by the program written by a programmer, as opposed to compiler-generated sections for ELF metadata.</p></td><td>unused</td><td>unused</td><td><code>.text</code> and <code>.data</code></td></tr><tr><td><code>SHT_SYMTAB (2)</code></td><td><p>Symbol table.</p><p>This section holds a section table used by the static linker.
only 1 section of such type is allowed in any ELF file, and its name must be <code>.symtab</code>.</p><p>See also <code>SHT_DYNSYM</code>.</p></td><td>string table for symbol names</td><td><p>One greater than the symbol table index of the last local symbol (binding STB_LOCAL).</p></td><td>The one and only <code>.symtab</code></td>.</tr><tr><td><code>SHT_STRTAB (3)</code></td><td>String table</td><td>ignored</td><td>ignored</td><td><p><code>.shstrtab</code></p></td></tr><tr><td><code>SHT_RELA (4)</code></td><td>Relocation entries with addends</td><td>the symbol table used for relocation</td><td>SHT index of the section to which the relocation applies.</td><td><p><code>.rela.text</code></p></td></tr><tr><td><code>SHT_HASH (5)</code></td><td>Symbol hash table<p>Don&rsquo;t get confused with <code>GNU_HASH</code>, see below.</p></td><td>the symbol table to which the hash table applies</td><td>must be 0</td><td>EXAMPLE</td></tr><tr><td><code>SHT_DYNAMIC (6)</code></td><td><p>Dynamic linking information.</p><p>This section will stay in an dedicated <code>DYNAMIC</code> segment.</p></td><td>the string table used by entries in this section</td><td>must be 0</td><td>EXAMPLE</td></tr><tr><td><code>SHT_NOTE (7)</code></td><td><p>Note.</p><p>This section allows a compiler toolchain vendor to save arbitrary information for later use.
It content must conform to the structure described in <a href=https://refspecs.linuxfoundation.org/elf/gabi4+/ch5.pheader.html#note_section>SysVABI note_section</a>, instead of being arbitrary bytes.</p></td><td>ignored</td><td>ignored</td><td><p><code>.note.gnu.property</code></p></td></tr><tr><td><code>SHT_NOBITS (8)</code></td><td><p>Identical to <code>SHT_PROGBITS</code> (i.e. program data), except that this section doesn&rsquo;t occupy space in the ELF file.</p></td><td>ignored</td><td>ignored</td><td><p><code>.bss</code></p></td></tr><tr><td><code>SHT_REL (9)</code></td><td>Relocation entries, no addends</td><td><p>same as <code>SHT_RELA</code>.</p></td><td><p>same as <code>SHT_RELA</code>.</p></td><td>TODO</td></tr><tr><td><code>SHT_SHLIB (10)</code></td><td>Reserved</td><td>shlinkinfo</td><td>shinfoinfo</td><td>TODO</td></tr><tr><td><code>SHT_DYNSYM (11)</code></td><td>Dynamic linker symbol table</td><td><p>Same as <code>SHT_SYMTAB</code>.</p></td><td><p>Same as <code>SHT_SYMTAB</code>.</p></td><td><p>The one and only <code>.dynsym</code></p></td></tr><tr><td><code>SHT_INIT_ARRAY (14)</code></td><td>Array of constructors</td><td>shlinkinfo</td><td>shinfoinfo</td><td>TODO</td></tr><tr><td><code>SHT_FINI_ARRAY (15)</code></td><td>Array of destructors</td><td>shlinkinfo</td><td>shinfoinfo</td><td>TODO</td></tr><tr><td><code>SHT_PREINIT_ARRAY (16)</code></td><td>Array of pre-constructors</td><td>shlinkinfo</td><td>shinfoinfo</td><td>TODO</td></tr><tr><td><code>SHT_GROUP (17)</code></td><td>Section group<p>This type of sections may only appear in relocatable, and defines a section group.</p><p>See <a href=https://refspecs.linuxfoundation.org/elf/gabi4+/ch4.sheader.html#section_groups>this section</a> for how section group are handled by the linker.</p></td><td>the associated symbol table</td><td>The symbol table index of an entry in the associated symbol table. The name of the specified symbol table entry provides a signature for the section group.</td><td>TODO</td></tr><tr><td><code>SHT_SYMTAB_SHNDX (18)</code></td><td>Extended section indices</td><td>the associated symbol table</td><td>must be 0</td><td>TODO</td></tr><tr><td><code>SHT_RELR (19)</code></td><td><p>Relative relocation entries without explicit addends or info.</p><p>RELR sections are introuduced recently c. 2017.</p></td><td></td><td></td><td><p><code>.relr.dyn</code></p></td></tr></tbody></table></div></div><p>The table above list standard, platform-independent values of <code>sh_type</code>, which are numerically smaller; while</p><ul><li><p>values in the range <code>0x60000000 ~ 0x6fffffff</code> are OS-specific</p><p>A production example are the <code>GNU_HASH</code> section type found in many ELF files:</p><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#75715e>#define SHT_GNU_HASH	  0x6ffffff6	</span><span style=color:#75715e>/* GNU-style hash table.  */</span></span></span></code></pre></div><button>copy</button></div></li><li><p>values in the range <code>0x70000000 ~ 0x7fffffff</code> are processor-specific.</p></li><li><p>values in the range <code>0x80000000 ~ 0x8fffffff</code> are reserved for applications and won&rsquo;t be used by the specification.</p></li></ul><h4 id=sh_flags---section-attributes><code>sh_flags</code> - section attributes</h4><p><code>sh_flags</code> is a collection of bit flags OR-ed together, each known as an <em>attribute</em> of this section.
Its type is <code>Word</code> (i.e. 32 bits) for ELF32, but <code>Xword</code> (i.e. 64 bits) for ELF64.
The difference in bit length is not a problem, since currently only less than a dozen of flags are currently defined.</p><p>Lower bits have standard defined semantics, while the most significant 12 bits are OS-specific and processor-specific.</p><table><thead><tr><td>sh_flags</td><td>indicates the section ...</td><td>bit-setexample</td><td>bit-unset example</td></tr></thead><tbody><tr><td><p><code>SHF_WRITE (1 &lt;&lt; 0)</code></td></p><td><p>is writable.</p><p>Memory occupied by this section at runtime may be written to by the program, thus the linker should be move this section to a writable segment.</p></td><td><p><code>.data</code></p></td><td><p><code>.rodata</code>, <code>.text</code></p></td></tr><tr><td><p><code>SHF_ALLOC (1 &lt;&lt; 1)</code></td></p><td><p>occupies memory during execution, as opposed to temporary link-time symbol table or string table that will never loaded into runtime memory.</p></td><td></td><td><p><code>.rela.*</code>, <code>.shstrtab</code>, etc.</p></td></tr><tr><td><p><code>SHF_EXECINSTR (1 &lt;&lt; 2)</code></td></p><td><p>contains executable instructions.</p></td><td></td><td></td></tr><tr><td><p><code>SHF_MERGE (1 &lt;&lt; 4)</code></td></p><td><p>holds content that may be merged to eliminate duplication.</p><ul><li>if <code>SHF_STRINGS</code> flag is unset, this section must holds a list of elements of each <code>sh_entsize</code> bytes in size.</li><li>if <code>SHF_STRINGS</code> flag is also set, this section must holds a list of elements where each element is a null-terminated string.</li></ul><p>Regardlessly, a linker when linking multiple relocatables, should compare the elements of this section, with that of all sections in all relocatables with the same section name, the same <code>sh_type</code> and <code>sh_flag</code>. Identical elements should be merged and only one should make it into the final linking result.</p></td><td></td><td></td></tr><tr><td><p><code>SHF_STRINGS (1 &lt;&lt; 5)</code></td></p><td><p>contains null-terminated strings. - according to the specification.</p><p>That being said, in production this flag is only used together with <code>SHF_MERGE</code>;
specifically, a normal <code>.strtab</code> or <code>.shstrtab</code> will not use this flag.</p></td><td></td><td></td></tr><tr><td><p><code>SHF_INFO_LINK (1 &lt;&lt; 6)</code></td></p><td>`sh_info` contains SHT index</td><td></td><td></td></tr><tr><td><p><code>SHF_LINK_ORDER (1 &lt;&lt; 7)</code></td></p><td>Preserve order after combining</td><td></td><td></td></tr><tr><td><p><code>SHF_OS_NONCONFORMING (1 &lt;&lt; 8)</code></td></p><td>Non-standard OS specific handling required</td><td></td><td></td></tr><tr><td><p><code>SHF_GROUP (1 &lt;&lt; 9)</code></td></p><td>Section is member of a group.</td><td></td><td></td></tr><tr><td><p><code>SHF_TLS (1 &lt;&lt; 10)</code></td></p><td>Section hold thread-local data.</td><td></td><td></td></tr><tr><td><p><code>SHF_COMPRESSED (1 &lt;&lt; 11)</code></td></p><td>Section with compressed data.</td><td></td><td></td></tr></tbody></table><h3 id=special-sections>Special Sections</h3><table><thead><tr><td>section name</td><td>mandatory <code>sh_type</code></td><td>mandatory <code>sh_flags</code></td><td style=width:60%>semantics</td></tr></thead><tbody><tr><td><code>.shstrtab</code></td><td></td><td></td><td>String table of strings used in the SHT, i.e. section names.<p>This section is not supposed to be stripped in any type of ELF file (relocatables, executables, shared objects).
Removing this section is not possible without hacking - <code>objcopy</code> and <code>strip</code> won&rsquo;t do.</p><p>A corrupted <code>.shstrtab</code> in a <code>.o</code> file won&rsquo;t prevent it from being linked into an executable or SO, but
some sections / segments may be incorrectly merged,
since Section names of a relocatable is important to the linker
Section names are significant in that special section, identified by their name,
e.g. <code>.text</code>, are significant when the linker is merging <code>.text</code>.</p></td></tr><tr><td><code>.symtab & .strtab</code></td><td></td><td></td><td>The static symbol table. &  string table of strings used in `.symtab`, i.e. symbol names.
- it mainly contain many symbols unnecessary for dynamic linking (won't be read by `ld.so`)
-<p>These 2 sections</p><ol><li>always appears in an <code>.o</code> file (relocatables), and</li><li>will be <code>strip</code>-ed by default, regardless of the ELF file type.</li><li>are usually adjacent in an ELF file.</li></ol></td></tr><tr><td><code>.dynsym & .dynstr</code></td><td></td><td></td><td></td></tr><tr><td><code>.dynamic</code></td><td></td><td></td><td></td></tr><tr><td><p><code>.interp</code></p></td><td></td><td></td><td><p>in-place string bytes (not a string table index) of the dynamic interperter path:</p><div class=codeblock-hook><pre tabindex=0><code>Hex dump of section &#39;.interp&#39;:
  0x00000318 2f6c6962 36342f6c 642d6c69 6e75782d /lib64/ld-linux-
  0x00000328 7838362d 36342e73 6f2e3200          x86-64.so.2.</code></pre><button>copy</button></div></td></tr></tbody></table><p>GNU system has some interesting values defined as being OS-specific:</p><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#75715e>#define SHT_LOOS	  0x60000000	</span><span style=color:#75715e>/* Start OS-specific.  */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#75715e>#define SHT_GNU_ATTRIBUTES 0x6ffffff5	</span><span style=color:#75715e>/* Object attributes.  */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#75715e>#define SHT_GNU_HASH	  0x6ffffff6	</span><span style=color:#75715e>/* GNU-style hash table.  */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#75715e>#define SHT_GNU_LIBLIST	  0x6ffffff7	</span><span style=color:#75715e>/* Prelink library list */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#75715e>#define SHT_CHECKSUM	  0x6ffffff8	</span><span style=color:#75715e>/* Checksum for DSO content.  */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#75715e>#define SHT_LOSUNW	  0x6ffffffa	</span><span style=color:#75715e>/* Sun-specific low bound.  */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#75715e>#define SHT_SUNW_move	  0x6ffffffa
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#75715e>#define SHT_SUNW_COMDAT   0x6ffffffb
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#75715e>#define SHT_SUNW_syminfo  0x6ffffffc
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#75715e>#define SHT_GNU_verdef	  0x6ffffffd	</span><span style=color:#75715e>/* Version definition section.  */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#75715e>#define SHT_GNU_verneed	  0x6ffffffe	</span><span style=color:#75715e>/* Version needs section.  */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#75715e>#define SHT_GNU_versym	  0x6fffffff	</span><span style=color:#75715e>/* Version symbol table.  */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#75715e>#define SHT_HISUNW	  0x6fffffff	</span><span style=color:#75715e>/* Sun-specific high bound.  */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#75715e>#define SHT_HIOS	  0x6fffffff	</span><span style=color:#75715e>/* End OS-specific type */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#75715e>#define SHT_LOPROC	  0x70000000	</span><span style=color:#75715e>/* Start of processor-specific */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#75715e>#define SHT_HIPROC	  0x7fffffff	</span><span style=color:#75715e>/* End of processor-specific */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#75715e>#define SHT_LOUSER	  0x80000000	</span><span style=color:#75715e>/* Start of application-specific */</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#75715e>#define SHT_HIUSER	  0x8fffffff	</span><span style=color:#75715e>/* End of application-specific */</span></span></span></code></pre></div><button>copy</button></div><h2 id=program-header-table-pht--segments>Program Header Table (PHT) & Segments</h2><h2 id=symbols>Symbols</h2><table><thead><tr><td><code>st_type</code></td><td>common <code>st_bind</code></td><td>common <code>st_other</code> (visibility)</td><td><code>st_shndx</code> semantics</td><td><code>st_size</code> semantics</td><td>semantics</td></tr></thead><tbody><tr><td rowspan=2><code>STT_NOTYPE (0)</code><p>Symbol type is unspecified.</p></td><td><code>STB_GLOBAL</code></td><td><code>STV_DEFAULT</code></td><td>must be <code>SHN_UNDEF</code></td><td>unspecified; usually just 0.</td><td><p>Generic external symbol (variable or function) that this object depends on but doesn't have its definition.</p><p>Example: declaration-only <code>extern</code> variable and functions.</p></td></tr><tr><td><code>STB_LOCAL</code></td></tr><tr><td><code>STT_OBJECT (1)</code><p>Symbol is a data object.</p></td><td>defined `extern` variables</td></tr><tr><td><code>STT_FUNC (2)</code><p>Symbol is a code object.</p></td><td>defined `extern` function</td></tr><tr><td><code>STT_SECTION (3)</code><p>Symbol associated with a section</p></td><td>certain sections e.g. `.text` are exposed as symbols</td></tr><tr><td><code>STT_FILE (4)</code><p>Symbol's name is file name.</p></td><td>source file name from which this `.o` file is compiled</td></tr><tr><td><code>STT_COMMON (5)</code><p>Symbol is a common data object.</p></td><td></td></tr><tr><td><code>STT_TLS (6)</code><p>Symbol is thread-local data object.</p></td><td></td></tr><tr></tr></tbody></table><h3 id=symbols-1>symbols</h3><p>ELF has 2 symbol tables. The primary reason for needing 2 is because the dynamic one must be readable by the <code>ld.so</code> thus must go into a <code>LOAD</code> segment, and the static one does not.</p><p>ELF spec allows all 4 types to have 1 or both.
But usually:</p><ul><li>a reloctable (<code>.o</code>) contains only <code>.symtab</code></li><li>an executable contains none</li><li>an shared object <code>.so</code> contains only <code>.dynsym</code></li></ul><h2 id=dynamic>.dynamic</h2><p>If an ELF file participates in dynamic linking, its PHT will have an item of type <code>PT_DYNAMIC</code> which locates a segment containing only 1 section,
the <code>.dynamic</code> section.</p><p>The kernel and dynamic linker will not inspect the SHT (nor the ELF header other than the entry point and PHT location, you can break the ELF file header in any other way and still make an executable work)and is not aware of any information about sections at run time.
It obtain all its required information from <code>.dynamic</code>.
The <code>.dynamic</code> section (and its dedicated segment) is meant to be the dynamic-linker-oriented index page of this ELF file.</p><p>Consider this section the index page for dynamic linker.<br>This is the first place <code>ld.so</code> should go first for any information.</p><p>This section contains very much information, as this is the only approach to provide information to the dynamic linker.
everything necessary for the dynamic linker to work, including
Among others, this section gives to the <code>ld.so</code>:</p><ol><li>where is <code>.strtab</code>, for library names and SONAME indexes</li><li>what other shared objects are required by this file</li><li>where is <code>.dynsym</code> and (offset and size of <code>.dynstr</code>) , for symbols import / export</li><li><code>.rela.dyn</code> and <code>.relr.dyn</code>, relocation table, offset, total size, and entry size.</li><li>misc</li></ol><ul><li>where to find <code>.init</code> / <code>.fini</code> / <code>.init_arrray</code> / <code>fini_array</code> section</li><li>the SONAME of this ELF file</li></ul><p><code>.dynamic</code> section always resides in that dedicated segment, and contains a list of the following structures:</p><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#75715e>/* Dynamic section entry.  */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>struct</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  Elf32_Sword	d_tag;			<span style=color:#75715e>/* Dynamic entry type */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>  <span style=color:#66d9ef>union</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>    {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>      Elf32_Word d_val;			<span style=color:#75715e>/* Integer value */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>      Elf32_Addr d_ptr;			<span style=color:#75715e>/* Address value */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    } d_un;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>} Elf32_Dyn;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>struct</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>  Elf64_Sxword	d_tag;			<span style=color:#75715e>/* Dynamic entry type */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>  <span style=color:#66d9ef>union</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>    {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>      Elf64_Xword d_val;		<span style=color:#75715e>/* Integer value */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>      Elf64_Addr d_ptr;			<span style=color:#75715e>/* Address value */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>    } d_un;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>} Elf64_Dyn;</span></span></code></pre></div><button>copy</button></div><p>The interpretation of <code>d_un</code> depends on the value of <code>d_tag</code>.</p><p>The list is marked end by a <code>d_tag = DT_NULL (0)</code> entry.</p></div></article></main><footer>Unless otherwise noted, content of this site is licensed under
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ style=text-decoration:underline>the CC BY-NC-SA 4.0</a>.<br>cesun.info copyright 2024.</footer></body></html>