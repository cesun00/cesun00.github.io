<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Fast Lexical Analyzer (Flex) | Infinity Architect</title>
<link rel=stylesheet href=/main.css><script type=importmap>
  {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.167.1/+esm"
      }
  }
  </script><script type=module src=/theme.mjs></script><style>.tag-android{background-color:hsl(0deg 80% 70%)}.dark .tag-android{background-color:hsl(0deg 80% 20%)}.tag-annotation{background-color:hsl(50deg 80% 70%)}.dark .tag-annotation{background-color:hsl(50deg 80% 20%)}.tag-assembly{background-color:hsl(100deg 80% 70%)}.dark .tag-assembly{background-color:hsl(100deg 80% 20%)}.tag-asymmetrical-cryptography{background-color:hsl(150deg 80% 70%)}.dark .tag-asymmetrical-cryptography{background-color:hsl(150deg 80% 20%)}.tag-awk{background-color:hsl(200deg 80% 70%)}.dark .tag-awk{background-color:hsl(200deg 80% 20%)}.tag-bootloader{background-color:hsl(250deg 80% 70%)}.dark .tag-bootloader{background-color:hsl(250deg 80% 20%)}.tag-bytecode{background-color:hsl(300deg 80% 70%)}.dark .tag-bytecode{background-color:hsl(300deg 80% 20%)}.tag-c{background-color:hsl(350deg 80% 70%)}.dark .tag-c{background-color:hsl(350deg 80% 20%)}.tag-cxx{background-color:hsl(40deg 80% 70%)}.dark .tag-cxx{background-color:hsl(40deg 80% 20%)}.tag-cxx-stl{background-color:hsl(90deg 80% 70%)}.dark .tag-cxx-stl{background-color:hsl(90deg 80% 20%)}.tag-cgroup{background-color:hsl(140deg 80% 70%)}.dark .tag-cgroup{background-color:hsl(140deg 80% 20%)}.tag-cheetsheet{background-color:hsl(190deg 80% 70%)}.dark .tag-cheetsheet{background-color:hsl(190deg 80% 20%)}.tag-clang{background-color:hsl(240deg 80% 70%)}.dark .tag-clang{background-color:hsl(240deg 80% 20%)}.tag-coding-theory{background-color:hsl(290deg 80% 70%)}.dark .tag-coding-theory{background-color:hsl(290deg 80% 20%)}.tag-compression{background-color:hsl(340deg 80% 70%)}.dark .tag-compression{background-color:hsl(340deg 80% 20%)}.tag-concept{background-color:hsl(30deg 80% 70%)}.dark .tag-concept{background-color:hsl(30deg 80% 20%)}.tag-cpu{background-color:hsl(80deg 80% 70%)}.dark .tag-cpu{background-color:hsl(80deg 80% 20%)}.tag-crawler{background-color:hsl(130deg 80% 70%)}.dark .tag-crawler{background-color:hsl(130deg 80% 20%)}.tag-cryptography{background-color:hsl(180deg 80% 70%)}.dark .tag-cryptography{background-color:hsl(180deg 80% 20%)}.tag-css{background-color:hsl(230deg 80% 70%)}.dark .tag-css{background-color:hsl(230deg 80% 20%)}.tag-database{background-color:hsl(280deg 80% 70%)}.dark .tag-database{background-color:hsl(280deg 80% 20%)}.tag-deflate{background-color:hsl(330deg 80% 70%)}.dark .tag-deflate{background-color:hsl(330deg 80% 20%)}.tag-design{background-color:hsl(20deg 80% 70%)}.dark .tag-design{background-color:hsl(20deg 80% 20%)}.tag-dns{background-color:hsl(70deg 80% 70%)}.dark .tag-dns{background-color:hsl(70deg 80% 20%)}.tag-dom{background-color:hsl(120deg 80% 70%)}.dark .tag-dom{background-color:hsl(120deg 80% 20%)}.tag-driver{background-color:hsl(170deg 80% 70%)}.dark .tag-driver{background-color:hsl(170deg 80% 20%)}.tag-elastic{background-color:hsl(220deg 80% 70%)}.dark .tag-elastic{background-color:hsl(220deg 80% 20%)}.tag-elf{background-color:hsl(270deg 80% 70%)}.dark .tag-elf{background-color:hsl(270deg 80% 20%)}.tag-elk{background-color:hsl(320deg 80% 70%)}.dark .tag-elk{background-color:hsl(320deg 80% 20%)}.tag-flex{background-color:hsl(10deg 80% 70%)}.dark .tag-flex{background-color:hsl(10deg 80% 20%)}.tag-gc{background-color:hsl(60deg 80% 70%)}.dark .tag-gc{background-color:hsl(60deg 80% 20%)}.tag-gcc{background-color:hsl(110deg 80% 70%)}.dark .tag-gcc{background-color:hsl(110deg 80% 20%)}.tag-gnu{background-color:hsl(160deg 80% 70%)}.dark .tag-gnu{background-color:hsl(160deg 80% 20%)}.tag-go{background-color:hsl(210deg 80% 70%)}.dark .tag-go{background-color:hsl(210deg 80% 20%)}.tag-gzip{background-color:hsl(260deg 80% 70%)}.dark .tag-gzip{background-color:hsl(260deg 80% 20%)}.tag-hash{background-color:hsl(310deg 80% 70%)}.dark .tag-hash{background-color:hsl(310deg 80% 20%)}.tag-http{background-color:hsl(0deg 80% 70%)}.dark .tag-http{background-color:hsl(0deg 80% 20%)}.tag-huffman{background-color:hsl(50deg 80% 70%)}.dark .tag-huffman{background-color:hsl(50deg 80% 20%)}.tag-java{background-color:hsl(100deg 80% 70%)}.dark .tag-java{background-color:hsl(100deg 80% 20%)}.tag-java-module{background-color:hsl(150deg 80% 70%)}.dark .tag-java-module{background-color:hsl(150deg 80% 20%)}.tag-javascript{background-color:hsl(200deg 80% 70%)}.dark .tag-javascript{background-color:hsl(200deg 80% 20%)}.tag-jdk{background-color:hsl(250deg 80% 70%)}.dark .tag-jdk{background-color:hsl(250deg 80% 20%)}.tag-js{background-color:hsl(300deg 80% 70%)}.dark .tag-js{background-color:hsl(300deg 80% 20%)}.tag-jvm{background-color:hsl(350deg 80% 70%)}.dark .tag-jvm{background-color:hsl(350deg 80% 20%)}.tag-kernel{background-color:hsl(40deg 80% 70%)}.dark .tag-kernel{background-color:hsl(40deg 80% 20%)}.tag-lexer{background-color:hsl(90deg 80% 70%)}.dark .tag-lexer{background-color:hsl(90deg 80% 20%)}.tag-linux{background-color:hsl(140deg 80% 70%)}.dark .tag-linux{background-color:hsl(140deg 80% 20%)}.tag-log4j2{background-color:hsl(190deg 80% 70%)}.dark .tag-log4j2{background-color:hsl(190deg 80% 20%)}.tag-lz77{background-color:hsl(240deg 80% 70%)}.dark .tag-lz77{background-color:hsl(240deg 80% 20%)}.tag-make{background-color:hsl(290deg 80% 70%)}.dark .tag-make{background-color:hsl(290deg 80% 20%)}.tag-makefile{background-color:hsl(340deg 80% 70%)}.dark .tag-makefile{background-color:hsl(340deg 80% 20%)}.tag-maven{background-color:hsl(30deg 80% 70%)}.dark .tag-maven{background-color:hsl(30deg 80% 20%)}.tag-memory{background-color:hsl(80deg 80% 70%)}.dark .tag-memory{background-color:hsl(80deg 80% 20%)}.tag-multithreading{background-color:hsl(130deg 80% 70%)}.dark .tag-multithreading{background-color:hsl(130deg 80% 20%)}.tag-mybatis{background-color:hsl(180deg 80% 70%)}.dark .tag-mybatis{background-color:hsl(180deg 80% 20%)}.tag-mysql{background-color:hsl(230deg 80% 70%)}.dark .tag-mysql{background-color:hsl(230deg 80% 20%)}.tag-nasm{background-color:hsl(280deg 80% 70%)}.dark .tag-nasm{background-color:hsl(280deg 80% 20%)}.tag-node{background-color:hsl(330deg 80% 70%)}.dark .tag-node{background-color:hsl(330deg 80% 20%)}.tag-nodejs{background-color:hsl(20deg 80% 70%)}.dark .tag-nodejs{background-color:hsl(20deg 80% 20%)}.tag-openssl{background-color:hsl(70deg 80% 70%)}.dark .tag-openssl{background-color:hsl(70deg 80% 20%)}.tag-playwright{background-color:hsl(120deg 80% 70%)}.dark .tag-playwright{background-color:hsl(120deg 80% 20%)}.tag-posix{background-color:hsl(170deg 80% 70%)}.dark .tag-posix{background-color:hsl(170deg 80% 20%)}.tag-powershell{background-color:hsl(220deg 80% 70%)}.dark .tag-powershell{background-color:hsl(220deg 80% 20%)}.tag-programming-langauge{background-color:hsl(270deg 80% 70%)}.dark .tag-programming-langauge{background-color:hsl(270deg 80% 20%)}.tag-programming-language{background-color:hsl(320deg 80% 70%)}.dark .tag-programming-language{background-color:hsl(320deg 80% 20%)}.tag-qemu{background-color:hsl(10deg 80% 70%)}.dark .tag-qemu{background-color:hsl(10deg 80% 20%)}.tag-redis{background-color:hsl(60deg 80% 70%)}.dark .tag-redis{background-color:hsl(60deg 80% 20%)}.tag-retrocomputing{background-color:hsl(110deg 80% 70%)}.dark .tag-retrocomputing{background-color:hsl(110deg 80% 20%)}.tag-rfc{background-color:hsl(160deg 80% 70%)}.dark .tag-rfc{background-color:hsl(160deg 80% 20%)}.tag-sdram{background-color:hsl(210deg 80% 70%)}.dark .tag-sdram{background-color:hsl(210deg 80% 20%)}.tag-sed{background-color:hsl(260deg 80% 70%)}.dark .tag-sed{background-color:hsl(260deg 80% 20%)}.tag-slf4j{background-color:hsl(310deg 80% 70%)}.dark .tag-slf4j{background-color:hsl(310deg 80% 20%)}.tag-spring{background-color:hsl(0deg 80% 70%)}.dark .tag-spring{background-color:hsl(0deg 80% 20%)}.tag-spring-boot{background-color:hsl(50deg 80% 70%)}.dark .tag-spring-boot{background-color:hsl(50deg 80% 20%)}.tag-spring-data{background-color:hsl(100deg 80% 70%)}.dark .tag-spring-data{background-color:hsl(100deg 80% 20%)}.tag-spring-ioc{background-color:hsl(150deg 80% 70%)}.dark .tag-spring-ioc{background-color:hsl(150deg 80% 20%)}.tag-sql{background-color:hsl(200deg 80% 70%)}.dark .tag-sql{background-color:hsl(200deg 80% 20%)}.tag-streaming{background-color:hsl(250deg 80% 70%)}.dark .tag-streaming{background-color:hsl(250deg 80% 20%)}.tag-template{background-color:hsl(300deg 80% 70%)}.dark .tag-template{background-color:hsl(300deg 80% 20%)}.tag-testing{background-color:hsl(350deg 80% 70%)}.dark .tag-testing{background-color:hsl(350deg 80% 20%)}.tag-thymeleaf{background-color:hsl(40deg 80% 70%)}.dark .tag-thymeleaf{background-color:hsl(40deg 80% 20%)}.tag-tls{background-color:hsl(90deg 80% 70%)}.dark .tag-tls{background-color:hsl(90deg 80% 20%)}.tag-tomcat{background-color:hsl(140deg 80% 70%)}.dark .tag-tomcat{background-color:hsl(140deg 80% 20%)}.tag-transaction{background-color:hsl(190deg 80% 70%)}.dark .tag-transaction{background-color:hsl(190deg 80% 20%)}.tag-transistor{background-color:hsl(240deg 80% 70%)}.dark .tag-transistor{background-color:hsl(240deg 80% 20%)}.tag-ts{background-color:hsl(290deg 80% 70%)}.dark .tag-ts{background-color:hsl(290deg 80% 20%)}.tag-typescript{background-color:hsl(340deg 80% 70%)}.dark .tag-typescript{background-color:hsl(340deg 80% 20%)}.tag-unix{background-color:hsl(30deg 80% 70%)}.dark .tag-unix{background-color:hsl(30deg 80% 20%)}.tag-web{background-color:hsl(80deg 80% 70%)}.dark .tag-web{background-color:hsl(80deg 80% 20%)}.tag-x86{background-color:hsl(130deg 80% 70%)}.dark .tag-x86{background-color:hsl(130deg 80% 20%)}.tag-x86_64{background-color:hsl(180deg 80% 70%)}.dark .tag-x86_64{background-color:hsl(180deg 80% 20%)}.tag-x86-64{background-color:hsl(230deg 80% 70%)}.dark .tag-x86-64{background-color:hsl(230deg 80% 20%)}.tag-xpath{background-color:hsl(280deg 80% 70%)}.dark .tag-xpath{background-color:hsl(280deg 80% 20%)}.tag-zlib{background-color:hsl(330deg 80% 70%)}.dark .tag-zlib{background-color:hsl(330deg 80% 20%)}</style></head><body><script>localStorage.getItem("dark-theme")&&document.body.classList.add("dark")</script><header><h2 id=banner><a href=/>Infinity Architect</a></h2><div id=top-sections><a href=/android/ class=hoverable>Android </a><a href=/cxx/ class=hoverable>C/C++ </a><a href=/compression/ class=hoverable>Compression </a><a href=/cpu/ class=hoverable>CPU </a><a href=/crypto/ class=hoverable>Cryptography </a><a href=/db/ class=hoverable>Database </a><a href=/ee/ class=hoverable>Electronic Engineering </a><a href=/linux/ class=active>GNU/Linux </a><a href=/go/ class=hoverable>Golang </a><a href=/java/ class=hoverable>Java </a><a href=/microservice/ class=hoverable>Microservice </a><a href=/net/ class=hoverable>Network & Protocol </a><a href=/physics/ class=hoverable>Physics </a><a href=/retro/ class=hoverable>Retro-Computing </a><a href=/toy/ class=hoverable>Toys </a><a href=/windev/ class=hoverable>Window</a></div><div class=theme-switch style="align-self:center;margin:auto 20px"><input type=checkbox id=theme-checkbox>
<label for=theme-checkbox><div></div><span><svg viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M9.528 1.718a.75.75.0 01.162.819A8.97 8.97.0 009 6a9 9 0 009 9 8.97 8.97.0 003.463-.69.75.75.0 01.981.98 10.503 10.503.0 01-9.694 6.46c-5.799.0-10.5-4.701-10.5-10.5.0-4.368 2.667-8.112 6.46-9.694a.75.75.0 01.818.162z" clip-rule="evenodd"/></svg>
</span><span><svg viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M12 2.25a.75.75.0 01.75.75v2.25a.75.75.0 01-1.5.0V3a.75.75.0 01.75-.75zM7.5 12a4.5 4.5.0 119 0 4.5 4.5.0 01-9 0zM18.894 6.166a.75.75.0 00-1.06-1.06l-1.591 1.59a.75.75.0 101.06 1.061l1.591-1.59zM21.75 12a.75.75.0 01-.75.75h-2.25a.75.75.0 010-1.5H21a.75.75.0 01.75.75zm-3.916 6.894a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 10-1.061 1.06l1.59 1.591zM12 18a.75.75.0 01.75.75V21a.75.75.0 01-1.5.0v-2.25A.75.75.0 0112 18zM7.758 17.303a.75.75.0 00-1.061-1.06l-1.591 1.59a.75.75.0 001.06 1.061l1.591-1.59zM6 12a.75.75.0 01-.75.75H3a.75.75.0 010-1.5h2.25A.75.75.0 016 12zm.697-4.243a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 00-1.061 1.06l1.59 1.591z"/></svg></span></label></div></header><main><article class=basic-text><div style=font-family:monospace;font-size:1.5em><div class=basic-text>/<a href=/>HOME</a>/<a href=/linux/>GNU/Linux</a>/
$</div></div><div style=margin-bottom:60px><h1 style=margin-bottom:0>Fast Lexical Analyzer (Flex)</h1><p class=aux-text style=margin-top:0>Published at: July 3, 2023
| Last modification: July 20, 2024</p><div style=line-height:2em><span class="page-tag tag-c">C</span>
<span class="page-tag tag-cxx">C++</span>
<span class="page-tag tag-flex">flex</span>
<span class="page-tag tag-lexer">lexer</span></div></div><div><p>The original <code>lex</code> program was written for the UNOS operating system in 1975.
It was a proprietary software under the Bell Laboratories license.
Nowadays open-source versions of <code>lex</code> based on the original proprietary code are available.</p><p>Flex is the free and open-source alternative to <code>lex</code>.</p><blockquote><p>Vern Paxson took over the Software Tools lex project from Jef Poskanzer in 1982.
At that point it was written in Ratfor. Around 1987 or so, Paxson translated it into C, and a legend was born :-).</p></blockquote><p>Flex is not part of the GNU project. <a href=https://ftp.gnu.org/old-gnu/Manuals/flex-2.5.4/html_mono/flex.html>There was a period of time Flex and its manual (compiled from <code>doc/flex.texi</code>)
were distributed from GNU&rsquo;s ftp server</a> because
<a href=https://westes.github.io/flex/manual/Is-flex-GNU-or-not_003f.html#Is-flex-GNU-or-not_003f>&ldquo;no one&rsquo;s written a decent GPL&rsquo;d lex replacement&rdquo;</a>.</p><h2 id=cli-invocation>CLI Invocation</h2><div class=codeblock-hook><pre tabindex=0><code>flex [options] input.l</code></pre><button>copy</button></div><p>The <code>flex</code> program takes an input file and generates a C99 file named <code>lex.yy.c</code> by default.</p><ul><li>Generating non-C99 K&amp;R C code is possible via the <code>%option noansi-definitions</code> option, but is deprecated and may be removed in the future.</li><li>Generating a parser in C++ source (with encapsulation as a scanner class) is possible but experimental.</li></ul><p>The <code>lex.yy.c</code> file can then be compiled, but to link it into an executable or shared object
an <code>int yywrap (void)</code> function definition must be provided.
This function should return true (non-zero) or false (zero) depending on
how you want the scanner to behave when the end-of-file is reached.
See below for the detailed semantics.
To get started, you can do either:</p><ol><li><p>linking with the <code>libfl</code> (by a <code>-lfl</code> flag to gcc)</p><p><code>libfl</code> is a tiny library Flex ships which <a href=https://github.com/westes/flex/blob/52c3d81c245f605c0a1129535fb44864d524ac48/src/Makefile.am#L17>contains only 2 source files</a>:</p><ul><li><a href=https://github.com/westes/flex/blob/master/src/libyywrap.c>libyywrap.c</a> provides a dummy <code>yywrap</code> definition that always returns <code>1</code>.</li><li><a href=https://github.com/westes/flex/blob/master/src/libmain.c>libmain.c</a> provides a <code>main</code> function for convenience whose behavior is simply scanning the next token until EOF is reached.</li></ul><p>Linking with <code>libfl</code> is particularly convenient if you are testing or prototyping a scanner and feel lazy to write <code>yywrap</code> and <code>main</code>.</p></li><li><p>Writing one that always returns <code>1</code> in the <a href=#input-file-format>user code section</a>. Of course, the responsibility also falls on you to provide a <code>main</code> function if you want to create an executable.</p></li></ol><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#75715e># readelf -s /usr/lib/libfl.so</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>Symbol table <span style=color:#e6db74>&#39;.dynsym&#39;</span> contains <span style=color:#ae81ff>9</span> entries:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>   Num:    Value          Size Type    Bind   Vis      Ndx Name
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>     0: <span style=color:#ae81ff>0000000000000000</span>     <span style=color:#ae81ff>0</span> NOTYPE  LOCAL  DEFAULT  UND 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>     1: <span style=color:#ae81ff>0000000000000000</span>     <span style=color:#ae81ff>0</span> NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterT<span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>     2: <span style=color:#ae81ff>0000000000000000</span>     <span style=color:#ae81ff>0</span> NOTYPE  WEAK   DEFAULT  UND __gmon_start__
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>     3: <span style=color:#ae81ff>0000000000000000</span>     <span style=color:#ae81ff>0</span> NOTYPE  GLOBAL DEFAULT  UND yylex
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>     4: <span style=color:#ae81ff>0000000000000000</span>     <span style=color:#ae81ff>0</span> FUNC    GLOBAL DEFAULT  UND exit@GLIBC_2.2.5 <span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>     5: <span style=color:#ae81ff>0000000000000000</span>     <span style=color:#ae81ff>0</span> NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMC<span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>     6: <span style=color:#ae81ff>0000000000000000</span>     <span style=color:#ae81ff>0</span> FUNC    WEAK   DEFAULT  UND <span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>@GLIBC_2.2.5 <span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>     7: <span style=color:#ae81ff>0000000000001020</span>    <span style=color:#ae81ff>34</span> FUNC    GLOBAL DEFAULT   <span style=color:#ae81ff>10</span> main
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>     8: <span style=color:#ae81ff>0000000000001120</span>    <span style=color:#ae81ff>10</span> FUNC    GLOBAL DEFAULT   <span style=color:#ae81ff>10</span> yywrap</span></span></code></pre></div><button>copy</button></div><h2 id=input-file-format>Input File Format</h2><p>The input file by convention has a <code>.l</code> extension, and must have the following layout:</p><div class=codeblock-hook><pre tabindex=0><code>definitions
%%
rules
%%
user code</code></pre><button>copy</button></div><p>The <code>definitions</code>, <code>rules</code>, and <code>user code</code> section must be separated by a line that contains only 2 <code>%</code> characters.
The <code>user code</code> section is optional, and when it&rsquo;s omitted, the <code>%%</code> line above it may be omitted as well.</p><h3 id=definitions-section><code>definitions</code> section</h3><p>The <code>definitions</code> section contains 4 types of elements:</p><ul><li><em>name definitions</em> are named regexp patterns for reuse.</li><li><em>start conditions</em> declare all possible states the scanner could be in, and their being inclusive or exclusive.</li><li>scanner options are lines that start with <code>%option ...</code>.</li><li>text surrounded by <code>%{ ... %}</code> where both <code>%{</code> and <code>%}</code> appear at the start of a line will be copied to the output with <code>%{</code> and <code>%}</code> removed.</li></ul><p>Everything else in the <code>definitions</code> section is copied verbatim to the output without modification, including:</p><ol><li>Indented text</li><li>C comments, i.e. text surrounded by <code>/* ... */</code> where <code>/*</code> appears at the start of a line.</li></ol><h4 id=name-definitions>name definitions</h4><p>A name definition is a line of the following format:</p><div class=codeblock-hook><pre tabindex=0><code>name    definition</code></pre><button>copy</button></div><p>There must be no indentation before <code>name</code>.
<code>name</code> conforms to the same rules of a C variable name, except that <code>-</code> (dash) is allowed in the middle.</p><div class=codeblock-hook><pre tabindex=0><code>DIGIT   [0-9]
ID      [a-z][a-z0-9]*</code></pre><button>copy</button></div><p>Name definitions can be referred to later in the rules section by <code>{name}</code> (i.e. surrounded by a pair of curly brace),
which will expand to <code>(definition)</code> (i.e. surrounded by a pair of parentheses). e.g. <code>{DIGIT}+"."{DIGIT}*</code> is identical to <code>([0-9])+"."([0-9])*</code>.</p><h4 id=start-conditions>start conditions</h4><p>If you have experience with a manually written lexer, start conditions are equivalent to (actually, implemented as) the <code>enum State</code> whose instance will be switched on in the while-switch idiom.</p><p>A scanner is essentially a state machine, where the same character sequence can have different interpretations depending on the current state
of the scanner. Some character sequences aren&rsquo;t even allowed in some states. For example, a <code>*/</code> marks the end of a comment when a previous <code>/*</code> has put the scanner into the <code>COMMENT</code> state, but means a multiplication operator and a division operator in an arithmetic expression
(of course, such an operator sequence is a syntax error in most programming languages, but judging that is the job of the parser).</p><p>Each start condition is defined on un-indented lines beginning with either <code>%s</code> or <code>%x</code> followed by a list of names.</p><ul><li><code>%s</code> introduces an inclusive start condition</li><li><code>%x</code> introduces an exclusive start condition</li></ul><p>To write a rule that is active only when the scanner is in a given state <code>sc</code>, prefix that rule with <code>&lt;sc></code>.
Use a comma-separated list for a rule that is active for more than 1 state, e.g. <code>&lt;sc1, sc2, sc3></code>.</p><p>An example of start conditions would be like this:</p><div class=codeblock-hook><pre tabindex=0><code class=language-lex data-lang=lex>%{
#include &lt;stdio.h&gt;
%}


%s EXAMPLE

%%

bar {
    /* when word `bar` is encountered, enter EXAMPLE state */
    BEGIN(EXAMPLE);
    puts(&#34;Entered EXAMPLE state.&#34;);
}

&lt;EXAMPLE&gt;foo {
    /* this rule is only activated in EXAMPLE state */
    puts(&#34;see foo in the EXAMPLE state&#34;);
}

foo {
    puts(&#34;nah nah nah&#34;);
}</code></pre><button>copy</button></div><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#75715e># echo &#39;foo bar foo&#39; | ./main</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>nah nah nah
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span> Entered EXAMPLE state.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span> see foo in the EXAMPLE state</span></span></code></pre></div><button>copy</button></div><p>The scanner starts working in a special state called <code>INITIAL</code>.
Any rules without a start condition prefix are implicitly prefixed by <code>&lt;INITIAL></code>.
To transfer to a different state, use the <code>BEGIN(sc)</code> special directive in the action code.</p><ul><li><code>BEGIN</code> an inclusive start condition <code>foo</code> activates all rules prefixed with <code>&lt;foo></code> and <code>&lt;INITIAL></code>, and deactivates every rule else.</li><li><code>BEGIN</code> an exclusive start condition <code>bar</code> activates all rules prefixed with <code>&lt;bar></code> and deactivates every rule else.</li></ul><h4 id=scanner-options>Scanner options</h4><p>Comments may not appear on an ‘%option’ line.</p><h3 id=rules-section><code>rules</code> section</h3><p>This section contains lines of the following format, each known as a <em>rule</em>:</p><div class=codeblock-hook><pre tabindex=0><code>pattern     action</code></pre><button>copy</button></div><p><code>pattern</code> is a POSIX extended regular expression (see <code>regex(7)</code>).
See <a href=https://westes.github.io/flex/manual/Patterns.html#Patterns>Flex&rsquo;s manual</a> for precise supported syntax.
There must be no indentation before <code>pattern</code>.
<code>pattern</code> ends at the first non-escaped whitespace character.</p><p><code>action</code> describes some action to carry out if the <code>pattern</code> matches a prefix starting at the head of the input stream.
If there is more than 1 rule whose <code>pattern</code> matches, the one that matches the longest text is selected.
<code>action</code> is either a single <code>|</code> (bar) character that repeats the action of the next rule,
or a sequence of one of</p><ol><li><p>a C statement</p></li><li><p>an <code>ECHO;</code> directive, which prints the content of <code>yytext</code> to the <code>yyout</code> file</p></li><li><p>a <code>BEGIN sc;</code> or <code>BEGIN(sc);</code> directive, which transfers the state of the scanner to <code>sc</code> start condition.</p><p>The parenthesized syntax is recommended.</p></li><li><p>a <code>REJECT;</code> directive, which ends the execution of the current action, and in case more than 1 rule matches a current prefix,
executes the action of the next best matches.</p></li><li><p>a <code>yymore();</code> function call, which does nothing immediately, but tells the scanner to, in the next call to <code>yylex()</code>, append the next token to the current <code>yytext</code>, instead of overwriting it.</p></li><li><p>a <code>yyless(n);</code> macro, which puts back to the input stream all but the first <code>n</code> character of the current <code>yytext</code>.</p></li><li><p>a <code>unput(c);</code> function call, which puts back to the input stream an arbitrary character <code>c</code>.</p></li><li><p>a <code>input();</code> function call, which consumes and returns the next character from the input stream.</p></li><li><p>a <code>YY_FLUSH_BUFFER;</code> directive, which clears the internal buffer of the scanner, such that the next call to <code>yylex()</code> must fill the buffer first (with <code>YY_INPUT</code> macro).</p></li><li><p>a <code>yyterminate();</code> macro, which cause the <code>yylex()</code> to return 0 to its caller, indicating &ldquo;all done&rdquo;. This is equivalent of an <code>return 0</code>.</p></li></ol><p>All statements in <code>action</code> must be on the same line of <code>pattern</code>, unless surrounded by a pair of <code>{}</code>,
in which case all texts within are considered <code>action</code>.</p><p>Special caution must be taken when one wants to have comments about a rule in the rules section.
Comments may not appear in the <code>rules</code> section wherever flex is expecting a regular expression.
A <code>/*</code> appears at the beginning of a line is considered a regexp instead of marking the start of comments.</p><h3 id=user-code-section><code>user code</code> section</h3><p>All text in the <code>user code</code> section is copied to the output file verbatim.</p></div></article></main><footer>Unless otherwise noted, content of this site is licensed under
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ style=text-decoration:underline>the CC BY-NC-SA 4.0</a>.<br>cesun.info copyright 2024.</footer></body></html>