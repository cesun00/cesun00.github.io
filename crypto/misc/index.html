<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Cryptograph (unclassified) | Infinity Architect</title>
<link rel=stylesheet href=/main.css><script type=importmap>
  {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.167.1/+esm"
      }
  }
  </script><script type=module src=/theme.mjs></script><style>.tag-android{background-color:hsl(0deg 80% 70%)}.dark .tag-android{background-color:hsl(0deg 80% 20%)}.tag-annotation{background-color:hsl(50deg 80% 70%)}.dark .tag-annotation{background-color:hsl(50deg 80% 20%)}.tag-assembly{background-color:hsl(100deg 80% 70%)}.dark .tag-assembly{background-color:hsl(100deg 80% 20%)}.tag-asymmetrical-cryptography{background-color:hsl(150deg 80% 70%)}.dark .tag-asymmetrical-cryptography{background-color:hsl(150deg 80% 20%)}.tag-awk{background-color:hsl(200deg 80% 70%)}.dark .tag-awk{background-color:hsl(200deg 80% 20%)}.tag-bootloader{background-color:hsl(250deg 80% 70%)}.dark .tag-bootloader{background-color:hsl(250deg 80% 20%)}.tag-bytecode{background-color:hsl(300deg 80% 70%)}.dark .tag-bytecode{background-color:hsl(300deg 80% 20%)}.tag-c{background-color:hsl(350deg 80% 70%)}.dark .tag-c{background-color:hsl(350deg 80% 20%)}.tag-cxx{background-color:hsl(40deg 80% 70%)}.dark .tag-cxx{background-color:hsl(40deg 80% 20%)}.tag-cxx-stl{background-color:hsl(90deg 80% 70%)}.dark .tag-cxx-stl{background-color:hsl(90deg 80% 20%)}.tag-cgroup{background-color:hsl(140deg 80% 70%)}.dark .tag-cgroup{background-color:hsl(140deg 80% 20%)}.tag-cheetsheet{background-color:hsl(190deg 80% 70%)}.dark .tag-cheetsheet{background-color:hsl(190deg 80% 20%)}.tag-clang{background-color:hsl(240deg 80% 70%)}.dark .tag-clang{background-color:hsl(240deg 80% 20%)}.tag-coding-theory{background-color:hsl(290deg 80% 70%)}.dark .tag-coding-theory{background-color:hsl(290deg 80% 20%)}.tag-compression{background-color:hsl(340deg 80% 70%)}.dark .tag-compression{background-color:hsl(340deg 80% 20%)}.tag-concept{background-color:hsl(30deg 80% 70%)}.dark .tag-concept{background-color:hsl(30deg 80% 20%)}.tag-cpu{background-color:hsl(80deg 80% 70%)}.dark .tag-cpu{background-color:hsl(80deg 80% 20%)}.tag-crawler{background-color:hsl(130deg 80% 70%)}.dark .tag-crawler{background-color:hsl(130deg 80% 20%)}.tag-cryptography{background-color:hsl(180deg 80% 70%)}.dark .tag-cryptography{background-color:hsl(180deg 80% 20%)}.tag-css{background-color:hsl(230deg 80% 70%)}.dark .tag-css{background-color:hsl(230deg 80% 20%)}.tag-database{background-color:hsl(280deg 80% 70%)}.dark .tag-database{background-color:hsl(280deg 80% 20%)}.tag-deflate{background-color:hsl(330deg 80% 70%)}.dark .tag-deflate{background-color:hsl(330deg 80% 20%)}.tag-design{background-color:hsl(20deg 80% 70%)}.dark .tag-design{background-color:hsl(20deg 80% 20%)}.tag-dns{background-color:hsl(70deg 80% 70%)}.dark .tag-dns{background-color:hsl(70deg 80% 20%)}.tag-dom{background-color:hsl(120deg 80% 70%)}.dark .tag-dom{background-color:hsl(120deg 80% 20%)}.tag-driver{background-color:hsl(170deg 80% 70%)}.dark .tag-driver{background-color:hsl(170deg 80% 20%)}.tag-elastic{background-color:hsl(220deg 80% 70%)}.dark .tag-elastic{background-color:hsl(220deg 80% 20%)}.tag-elf{background-color:hsl(270deg 80% 70%)}.dark .tag-elf{background-color:hsl(270deg 80% 20%)}.tag-elk{background-color:hsl(320deg 80% 70%)}.dark .tag-elk{background-color:hsl(320deg 80% 20%)}.tag-flex{background-color:hsl(10deg 80% 70%)}.dark .tag-flex{background-color:hsl(10deg 80% 20%)}.tag-gc{background-color:hsl(60deg 80% 70%)}.dark .tag-gc{background-color:hsl(60deg 80% 20%)}.tag-gcc{background-color:hsl(110deg 80% 70%)}.dark .tag-gcc{background-color:hsl(110deg 80% 20%)}.tag-gnu{background-color:hsl(160deg 80% 70%)}.dark .tag-gnu{background-color:hsl(160deg 80% 20%)}.tag-go{background-color:hsl(210deg 80% 70%)}.dark .tag-go{background-color:hsl(210deg 80% 20%)}.tag-gzip{background-color:hsl(260deg 80% 70%)}.dark .tag-gzip{background-color:hsl(260deg 80% 20%)}.tag-hash{background-color:hsl(310deg 80% 70%)}.dark .tag-hash{background-color:hsl(310deg 80% 20%)}.tag-http{background-color:hsl(0deg 80% 70%)}.dark .tag-http{background-color:hsl(0deg 80% 20%)}.tag-huffman{background-color:hsl(50deg 80% 70%)}.dark .tag-huffman{background-color:hsl(50deg 80% 20%)}.tag-java{background-color:hsl(100deg 80% 70%)}.dark .tag-java{background-color:hsl(100deg 80% 20%)}.tag-java-module{background-color:hsl(150deg 80% 70%)}.dark .tag-java-module{background-color:hsl(150deg 80% 20%)}.tag-javascript{background-color:hsl(200deg 80% 70%)}.dark .tag-javascript{background-color:hsl(200deg 80% 20%)}.tag-jdk{background-color:hsl(250deg 80% 70%)}.dark .tag-jdk{background-color:hsl(250deg 80% 20%)}.tag-js{background-color:hsl(300deg 80% 70%)}.dark .tag-js{background-color:hsl(300deg 80% 20%)}.tag-jvm{background-color:hsl(350deg 80% 70%)}.dark .tag-jvm{background-color:hsl(350deg 80% 20%)}.tag-kernel{background-color:hsl(40deg 80% 70%)}.dark .tag-kernel{background-color:hsl(40deg 80% 20%)}.tag-lexer{background-color:hsl(90deg 80% 70%)}.dark .tag-lexer{background-color:hsl(90deg 80% 20%)}.tag-linux{background-color:hsl(140deg 80% 70%)}.dark .tag-linux{background-color:hsl(140deg 80% 20%)}.tag-log4j2{background-color:hsl(190deg 80% 70%)}.dark .tag-log4j2{background-color:hsl(190deg 80% 20%)}.tag-lz77{background-color:hsl(240deg 80% 70%)}.dark .tag-lz77{background-color:hsl(240deg 80% 20%)}.tag-make{background-color:hsl(290deg 80% 70%)}.dark .tag-make{background-color:hsl(290deg 80% 20%)}.tag-makefile{background-color:hsl(340deg 80% 70%)}.dark .tag-makefile{background-color:hsl(340deg 80% 20%)}.tag-maven{background-color:hsl(30deg 80% 70%)}.dark .tag-maven{background-color:hsl(30deg 80% 20%)}.tag-memory{background-color:hsl(80deg 80% 70%)}.dark .tag-memory{background-color:hsl(80deg 80% 20%)}.tag-multithreading{background-color:hsl(130deg 80% 70%)}.dark .tag-multithreading{background-color:hsl(130deg 80% 20%)}.tag-mybatis{background-color:hsl(180deg 80% 70%)}.dark .tag-mybatis{background-color:hsl(180deg 80% 20%)}.tag-mysql{background-color:hsl(230deg 80% 70%)}.dark .tag-mysql{background-color:hsl(230deg 80% 20%)}.tag-nasm{background-color:hsl(280deg 80% 70%)}.dark .tag-nasm{background-color:hsl(280deg 80% 20%)}.tag-node{background-color:hsl(330deg 80% 70%)}.dark .tag-node{background-color:hsl(330deg 80% 20%)}.tag-nodejs{background-color:hsl(20deg 80% 70%)}.dark .tag-nodejs{background-color:hsl(20deg 80% 20%)}.tag-openssl{background-color:hsl(70deg 80% 70%)}.dark .tag-openssl{background-color:hsl(70deg 80% 20%)}.tag-playwright{background-color:hsl(120deg 80% 70%)}.dark .tag-playwright{background-color:hsl(120deg 80% 20%)}.tag-posix{background-color:hsl(170deg 80% 70%)}.dark .tag-posix{background-color:hsl(170deg 80% 20%)}.tag-powershell{background-color:hsl(220deg 80% 70%)}.dark .tag-powershell{background-color:hsl(220deg 80% 20%)}.tag-programming-langauge{background-color:hsl(270deg 80% 70%)}.dark .tag-programming-langauge{background-color:hsl(270deg 80% 20%)}.tag-programming-language{background-color:hsl(320deg 80% 70%)}.dark .tag-programming-language{background-color:hsl(320deg 80% 20%)}.tag-qemu{background-color:hsl(10deg 80% 70%)}.dark .tag-qemu{background-color:hsl(10deg 80% 20%)}.tag-redis{background-color:hsl(60deg 80% 70%)}.dark .tag-redis{background-color:hsl(60deg 80% 20%)}.tag-retrocomputing{background-color:hsl(110deg 80% 70%)}.dark .tag-retrocomputing{background-color:hsl(110deg 80% 20%)}.tag-rfc{background-color:hsl(160deg 80% 70%)}.dark .tag-rfc{background-color:hsl(160deg 80% 20%)}.tag-sdram{background-color:hsl(210deg 80% 70%)}.dark .tag-sdram{background-color:hsl(210deg 80% 20%)}.tag-sed{background-color:hsl(260deg 80% 70%)}.dark .tag-sed{background-color:hsl(260deg 80% 20%)}.tag-slf4j{background-color:hsl(310deg 80% 70%)}.dark .tag-slf4j{background-color:hsl(310deg 80% 20%)}.tag-spring{background-color:hsl(0deg 80% 70%)}.dark .tag-spring{background-color:hsl(0deg 80% 20%)}.tag-spring-boot{background-color:hsl(50deg 80% 70%)}.dark .tag-spring-boot{background-color:hsl(50deg 80% 20%)}.tag-spring-data{background-color:hsl(100deg 80% 70%)}.dark .tag-spring-data{background-color:hsl(100deg 80% 20%)}.tag-spring-ioc{background-color:hsl(150deg 80% 70%)}.dark .tag-spring-ioc{background-color:hsl(150deg 80% 20%)}.tag-sql{background-color:hsl(200deg 80% 70%)}.dark .tag-sql{background-color:hsl(200deg 80% 20%)}.tag-streaming{background-color:hsl(250deg 80% 70%)}.dark .tag-streaming{background-color:hsl(250deg 80% 20%)}.tag-template{background-color:hsl(300deg 80% 70%)}.dark .tag-template{background-color:hsl(300deg 80% 20%)}.tag-testing{background-color:hsl(350deg 80% 70%)}.dark .tag-testing{background-color:hsl(350deg 80% 20%)}.tag-thymeleaf{background-color:hsl(40deg 80% 70%)}.dark .tag-thymeleaf{background-color:hsl(40deg 80% 20%)}.tag-tls{background-color:hsl(90deg 80% 70%)}.dark .tag-tls{background-color:hsl(90deg 80% 20%)}.tag-tomcat{background-color:hsl(140deg 80% 70%)}.dark .tag-tomcat{background-color:hsl(140deg 80% 20%)}.tag-transaction{background-color:hsl(190deg 80% 70%)}.dark .tag-transaction{background-color:hsl(190deg 80% 20%)}.tag-transistor{background-color:hsl(240deg 80% 70%)}.dark .tag-transistor{background-color:hsl(240deg 80% 20%)}.tag-ts{background-color:hsl(290deg 80% 70%)}.dark .tag-ts{background-color:hsl(290deg 80% 20%)}.tag-typescript{background-color:hsl(340deg 80% 70%)}.dark .tag-typescript{background-color:hsl(340deg 80% 20%)}.tag-unix{background-color:hsl(30deg 80% 70%)}.dark .tag-unix{background-color:hsl(30deg 80% 20%)}.tag-web{background-color:hsl(80deg 80% 70%)}.dark .tag-web{background-color:hsl(80deg 80% 20%)}.tag-x86{background-color:hsl(130deg 80% 70%)}.dark .tag-x86{background-color:hsl(130deg 80% 20%)}.tag-x86_64{background-color:hsl(180deg 80% 70%)}.dark .tag-x86_64{background-color:hsl(180deg 80% 20%)}.tag-x86-64{background-color:hsl(230deg 80% 70%)}.dark .tag-x86-64{background-color:hsl(230deg 80% 20%)}.tag-xpath{background-color:hsl(280deg 80% 70%)}.dark .tag-xpath{background-color:hsl(280deg 80% 20%)}.tag-zlib{background-color:hsl(330deg 80% 70%)}.dark .tag-zlib{background-color:hsl(330deg 80% 20%)}</style></head><body><script>localStorage.getItem("dark-theme")&&document.body.classList.add("dark")</script><header><h2 id=banner><a href=/>Infinity Architect</a></h2><div id=top-sections><a href=/android/ class=hoverable>Android </a><a href=/cxx/ class=hoverable>C/C++ </a><a href=/compression/ class=hoverable>Compression </a><a href=/cpu/ class=hoverable>CPU </a><a href=/crypto/ class=active>Cryptography </a><a href=/db/ class=hoverable>Database </a><a href=/ee/ class=hoverable>Electronic Engineering </a><a href=/linux/ class=hoverable>GNU/Linux </a><a href=/go/ class=hoverable>Golang </a><a href=/java/ class=hoverable>Java </a><a href=/microservice/ class=hoverable>Microservice </a><a href=/net/ class=hoverable>Network & Protocol </a><a href=/physics/ class=hoverable>Physics </a><a href=/retro/ class=hoverable>Retro-Computing </a><a href=/toy/ class=hoverable>Toys </a><a href=/windev/ class=hoverable>Window</a></div><div class=theme-switch style="align-self:center;margin:auto 20px"><input type=checkbox id=theme-checkbox>
<label for=theme-checkbox><div></div><span><svg viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M9.528 1.718a.75.75.0 01.162.819A8.97 8.97.0 009 6a9 9 0 009 9 8.97 8.97.0 003.463-.69.75.75.0 01.981.98 10.503 10.503.0 01-9.694 6.46c-5.799.0-10.5-4.701-10.5-10.5.0-4.368 2.667-8.112 6.46-9.694a.75.75.0 01.818.162z" clip-rule="evenodd"/></svg>
</span><span><svg viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M12 2.25a.75.75.0 01.75.75v2.25a.75.75.0 01-1.5.0V3a.75.75.0 01.75-.75zM7.5 12a4.5 4.5.0 119 0 4.5 4.5.0 01-9 0zM18.894 6.166a.75.75.0 00-1.06-1.06l-1.591 1.59a.75.75.0 101.06 1.061l1.591-1.59zM21.75 12a.75.75.0 01-.75.75h-2.25a.75.75.0 010-1.5H21a.75.75.0 01.75.75zm-3.916 6.894a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 10-1.061 1.06l1.59 1.591zM12 18a.75.75.0 01.75.75V21a.75.75.0 01-1.5.0v-2.25A.75.75.0 0112 18zM7.758 17.303a.75.75.0 00-1.061-1.06l-1.591 1.59a.75.75.0 001.06 1.061l1.591-1.59zM6 12a.75.75.0 01-.75.75H3a.75.75.0 010-1.5h2.25A.75.75.0 016 12zm.697-4.243a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 00-1.061 1.06l1.59 1.591z"/></svg></span></label></div></header><main><article class=basic-text><div style=font-family:monospace;font-size:1.5em><div class=basic-text>/<a href=/>HOME</a>/<a href=/crypto/>Cryptography</a>/
$</div></div><div style=margin-bottom:60px><h1 style=margin-bottom:0>Cryptograph (unclassified)</h1><p class=aux-text style=margin-top:0>Published at: February 12, 2024
| Last modification: June 20, 2024</p><div style=line-height:2em><span class="page-tag tag-cryptography">cryptography</span></div></div><div><h2 id=randomart>randomart</h2><p><code>ssh-keygen</code> now prints an ASCII image, after the key is generated. It is safe to spread the image.
The image serves as a visual fingerprint, an easier way for humans to validate keys.</p><p>There is no industrial standard on how . It&rsquo;s openSSH&rsquo;s own feature.</p><p>See <a href=http://www.dirk-loss.de/sshvis/drunken_bishop.pdf>http://www.dirk-loss.de/sshvis/drunken_bishop.pdf</a> for an analysis.</p><div class=codeblock-hook><pre tabindex=0><code>The key fingerprint is:
SHA256:ee296Fbg/INYE48cv5JxJELqUd4BIcQhXeJVwjoYPCk bitier@bite-into-reality
The key&#39;s randomart image is:
+--[ED25519 256]--+
|     ..==+*+.    |
|    E =oo++..    |
|     . +.* . .   |
|      . =.o.* .  |
|       .So.=.X   |
|        .. .O.=  |
|           o.O.. |
|          . =.+. |
|           oo... |
+----[SHA256]-----+</code></pre><button>copy</button></div><h1 id=in-implementing-bit-order-and-byte-order>In implementing bit-order and byte-order</h1><table><thead><tr><th></th><th>pro</th><th>con</th></tr></thead><tbody><tr><td>LSB0</td><td></td><td></td></tr><tr><td>MSB0</td><td></td><td></td></tr><tr><td>LSB last</td><td></td><td></td></tr><tr><td>MSB last</td><td></td><td></td></tr></tbody></table><h3 id=lsb0>LSB0</h3><p>Pro</p><ol><li>C&rsquo;s unsigned integer widening conversion naturally serves as appending unused 0 bit to the bit sequence.</li></ol><p>Con</p><ol><li>Treating consecutive bits as an integer, with first bits be more significant, requires reversing the bit order.</li></ol><h3 id=msb0>MSB0</h3><h1 id=block-cipher>Block Cipher</h1><p>A block cipher embodies a random permutation generator&mldr;.</p><h2 id=windows-root-ca-management>Windows Root CA Management</h2><p>Certificate Store is Windows&rsquo;s abstraction for security-sensitive information storage, e.g. SSL certificates.</p><p>Windows support 2 certificate stores, a user-specific one and a system-wide one, search for <code>manage user/computer certificates</code> in startup respectively. (The latter requires admin privilege.)</p><p>Both certificate store is actually backed by the registry.</p><p><a href=https://www.charlesproxy.com/documentation/using-charles/ssl-certificates/>Charles guide</a> mentions:</p><blockquote><p>The certificate must be imported into the &ldquo;Trusted Root Certification Authorities&rdquo; certificate store, so override the automatic certificate store selection.</p></blockquote><p>Note every application respect Windows&rsquo; native certificate store. Chrome maintain its own internal Root CA list, and don&rsquo;t give a shit to Windows cert store.</p><p><a href=https://www.venafi.com/blog/exploring-chromes-new-root-store-trust-vs-complexity>https://www.venafi.com/blog/exploring-chromes-new-root-store-trust-vs-complexity</a>
<a href=https://www.zdnet.com/article/chrome-will-soon-have-its-own-dedicated-certificate-root-store/>https://www.zdnet.com/article/chrome-will-soon-have-its-own-dedicated-certificate-root-store/</a></p><p>TODO: explain fields</p><p><img src=./win-cert.png alt></p><h1 id=one-time-pad---lacing-secret-into-plaintext>one-time pad - lacing secret into plaintext</h1><p>If alice and bob have a shared secret <code>k</code> of <code>n</code> bits, alice can send secretly (we&rsquo;l discuss the definition later) a plaintext <code>m</code> of also <code>n</code> bits to bob by sending:</p><div class=codeblock-hook><pre tabindex=0><code>c = m ⊕ k</code></pre><button>copy</button></div><p>and bob can obtain the original <code>m</code> by:</p><div class=codeblock-hook><pre tabindex=0><code>m&#39; = c ⊕ k</code></pre><button>copy</button></div><p>We turned a secret <code>k</code> and an message <code>m</code> into a secret <code>c</code> by XOR.</p><p>⊕(XOR) can be considered a binary-native way of propagating unpredictability (to adversary) of one bit sequence to another.</p><p>Unfortunately,</p><h1 id=being-computationally-infeasible--hardness--difficult-in-cryptography>being computationally infeasible / hardness / difficult in cryptography</h1><p>In many context, we simply say e.g.</p><ul><li>&ldquo;it should be hard to find a collision for a good CHF&rdquo;</li><li>&ldquo;it should be hard to find plaintext from ciphertext without the key for a good blockcipher&rdquo;, or</li><li>&ldquo;it&rsquo;s hard to find discrete logarithm&rdquo;.</li></ul><p>None of these says &ldquo;impossible&rdquo;: given enough amout of time, you can find collision in any CHF with probability 1 by brute force.</p><p>Hardness (or more formally, computation infeasibility) isn&rsquo;t a term that has strict mathematical definition.
It&rsquo;s not simply modeled by <code>the big-O complexity greater than ...</code> or <code>the probability of finding ... in m steps is less than ...</code>,
though sometimes such statements do appear as supportive material for the hardness discussion.</p><p>Hardness means the cost of computation (e.g. time / required memory / money to buy hardware) is greater than
the rewards of success in the computation. (e.g. adversary reveal password of a single account or all accounts in the DB).</p><p>Neither of the cost nor the rewards can be easily quantified, so the hardness can&rsquo;t be simply asserted by comparing 2 numbers.</p><p>The definition of hardness heavily depends on the detailed context of security game in question,
sometimes even on current productivity of current human&rsquo;s industry.
(e.g. no reliable quantum computation is possible <em>for now</em>, so breaking discrete log thus AES is hard, <em>for now</em>).</p><h1 id=avalanche-effect>avalanche effect</h1><p>Intuition: flipping a single bit in the input will totally change the whole output.</p><h1 id=terms>Terms</h1><p>integrity the data i&rsquo;m receiving is not tampered with. Middle Man flipping even a single bit will be detected.
but i&rsquo;m not necessarily sure who the guy sending bits to me is.</p><p>Authenticity I&rsquo;m doing tcp with remote peer 187.a.b.c:11223, bob told me this is his amazing server,</p><h2 id=man-in-the-middle-attack>Man in the middle attack</h2><p>A very nice intro to man in the middle : <a href="https://www.youtube.com/watch?v=-enHfpHMBo4">https://www.youtube.com/watch?v=-enHfpHMBo4</a></p><p>They say ADH is vulerable to man in the middle.</p><p>I used to think that man-in-the-middle doesn&rsquo;t work if you put a tag with the ciphertext.</p><p>Say Alice and Bob have a 128-bit shared secret already:
1. They start to talk in AES128-CBC; Eve sees noise, but she can flip a bit, and the recipient can&rsquo;t detect by just looking at the received ciphertext. After decryption the recipient always see garbage, but the crypto system itself doesn&rsquo;t provide a way to detect tampering. Plus, you always have to decrypt first, which is a cost.
2. They start to talk in AES128-CBC and each ciphertext is appended with the sha256 result of the ciphertext</p><p>The real world problem is</p><p>Active MITM don&rsquo;t work if you have a tag. Flipping a single bit will be detected.</p><p>Passive MITM</p><p>To even have ciphertext, you need to do all the PKE thing and get a shared secret. The PKE thing starts with the server sending its public key to the client IN PLAIN TEXT. A man in the middle can intercept that and replace it with its own public key.</p><p>TODO: does self-signed cert protect against MITM attack?
<a href=https://security.stackexchange.com/questions/184969/how-mitm-attack-got-performed-on-self-signed-certificate-while-private-keys-is-g>https://security.stackexchange.com/questions/184969/how-mitm-attack-got-performed-on-self-signed-certificate-while-private-keys-is-g</a></p><h1 id=digital-signature>Digital Signature</h1><p>People used to say that digital signature is just to use the private key to encrypt the hash of the plaintext.</p><p>This could be VERY misleading since it feels like EVERY public key algorithm that has public-private key-pair can be used to do &ldquo;signature&rdquo;. But actually this mindsetting only works for RSA, and ignorant people just think RSA is the whole public key encryption world.</p><p>For example in Diffie-Hellman key exchange, there are public key and private key, but they are NEVER meant to be used to &ldquo;encrypt&rdquo; or &ldquo;decrypt&rdquo; anything.</p><p><a href=https://crypto.stackexchange.com/questions/835/why-cant-diffie-hellman-be-used-for-signing>https://crypto.stackexchange.com/questions/835/why-cant-diffie-hellman-be-used-for-signing</a></p><h1 id=etm--mte--em>EtM / MtE / E&amp;M</h1><p><a href=https://crypto.stackexchange.com/questions/202/should-we-mac-then-encrypt-or-encrypt-then-mac>https://crypto.stackexchange.com/questions/202/should-we-mac-then-encrypt-or-encrypt-then-mac</a>
<a href=https://en.wikipedia.org/wiki/Authenticated_encryption#Approaches_to_authenticated_encryption>https://en.wikipedia.org/wiki/Authenticated_encryption#Approaches_to_authenticated_encryption</a></p><h1 id=prf-vs-hash-function>PRF vs hash function</h1><p><a href=https://crypto.stackexchange.com/questions/15935/is-there-a-difference-between-prf-and-a-hash-function>https://crypto.stackexchange.com/questions/15935/is-there-a-difference-between-prf-and-a-hash-function</a></p><p>I think apparently hash function takes arbitrary length input though&mldr;</p><h1 id=compute-the-rsa-public-key-from-the-private-key>Compute the RSA public key from the private key</h1><p>RSA is a asymmetric cryptography system, of course meaning that no one can compute the private key from the public key ( in a reasonable time). But it&rsquo;s trivial to get the public key if you have the private key, because you always know those 2 primes p q and n=pq in the private key, and public key is just the fucking same n with <code>e=65537 or 3</code>. is exactly what the <code>openssl genrsa</code> and <code>openssl rsa</code> do. See here for usage:
<a href=https://stackoverflow.com/questions/5244129/use-rsa-private-key-to-generate-public-key>https://stackoverflow.com/questions/5244129/use-rsa-private-key-to-generate-public-key</a>
For ECDH it&rsquo;s also trivial:
<a href=https://stackoverflow.com/questions/696472/given-a-private-key-is-it-possible-to-derive-its-public-key>https://stackoverflow.com/questions/696472/given-a-private-key-is-it-possible-to-derive-its-public-key</a></p><h1 id=kem-is-real>KEM is real</h1><p><a href=https://tools.ietf.org/html/rfc5990>https://tools.ietf.org/html/rfc5990</a></p><h1 id=play-with-openssl-rsa>Play with openssl rsa</h1><p>Everywhere a public key can be used, a private key can be used too (without -pubin),
since for RSA build public key from private key is trivial</p><h3 id=private-key-generation>private key generation</h3><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>openssl genrsa -out priv.pem</span></span></code></pre></div><button>copy</button></div><h3 id=extract-n-and-e-from-that-private-key-and-form-its-public-key>extract n and e from that private key and form its public key</h3><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>openssl rsa -in priv.pem -out pub.pem -pubout</span></span></code></pre></div><button>copy</button></div><h3 id=full-asymmetric-encryption>full asymmetric encryption</h3><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>echo -n <span style=color:#e6db74>&#39;fuck&#39;</span> | openssl rsautl -encrypt -inkey pub.pem -pubin -out fuck_encrypted</span></span></code></pre></div><button>copy</button></div><h3 id=full-asymmetric-decryption>full asymmetric decryption</h3><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#75715e># only private key can be used to decrypt</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>openssl rsautl -decrypt -inkey priv.pem -in fuck_encrypted</span></span></code></pre></div><button>copy</button></div><h3 id=signature>signature</h3><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>echo -n <span style=color:#e6db74>&#39;fuck&#39;</span> | openssl rsautl -sign -inkey priv.pem -out fuck_signed</span></span></code></pre></div><button>copy</button></div><h3 id=verify-signature>verify signature</h3><div class=codeblock-hook><pre tabindex=0><code># use private key works... but lose the meaning of signature
openssl rsautl -verify -in fuck_signed -inkey pub.pem -pubin</code></pre><button>copy</button></div><p>TODO: I guess by <code>-sign</code>, the output file store the encrypted content together with the signature, which is not the traditional definition of &ldquo;digital signature&rdquo; where you &ldquo;encrypt&rdquo; (i.e. not sure this is standard term - can you &ldquo;encrypt&rdquo; with private key? - it&rsquo;s just raise the hash value to the power of <code>d</code> (mod n)) the hash of the plaintext using the private key and append it to the plaintext.</p><h2 id=openssl-genpkey>openssl genpkey</h2><p>It seems that <code>genpkey</code> command is more recently designed and contains the functionality of <code>genrsa</code></p><h1 id=problem-with-plainrawtextbook-rsa--improvements>Problem with PLAIN/RAW/TEXTBOOK RSA & Improvements</h1><p><a href=https://crypto.stackexchange.com/questions/1448/definition-of-textbook-rsa>https://crypto.stackexchange.com/questions/1448/definition-of-textbook-rsa</a>
<a href=https://www.csa.iisc.ac.in/~arpita/Cryptography15/CT10.pdf>https://www.csa.iisc.ac.in/~arpita/Cryptography15/CT10.pdf</a></p><h1 id=pem-are-just-base64-ed-der-with-some-extra-headers>PEM are just base64-ed DER with some extra headers</h1><h1 id=x509-csr-for-existing-keys>X509 CSR for existing keys</h1><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#75715e># generate a rsa private key as usual</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>openssl genrsa -out priv.pem <span style=color:#ae81ff>4096</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#75715e># create a pkcs10 csr for it</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>openssl req -new -key priv.pem -out req.csr
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#75715e># verify that the request contains only the public key,</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>openssl req -in req.csr -noout -text
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#75715e># and the modulus are the same</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>openssl req -in req.csr -noout -modulus
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>openssl rsa -in priv.pem -noout -modulus
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#75715e># TODO ... sign it and return the cert...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#75715e># openssl ca ...?</span></span></span></code></pre></div><button>copy</button></div><p>The <code>-key</code> here has to be the private key, I think it&rsquo;s because the CSR need to be signed by the request maker, but the private key is NOT stored in the CSR. The CSR is a request to the CA to sign your (public key, identity info) you know. And the public key for RSA is trivially got from the private key.</p><h1 id=all-right-wikipedias-certificate-is-signed-by-a-ca-whose-common-name-is-lets-encrypt-but-how-do-i-find-this-issuers-public-key-so-that-i-can-verify-the-signature-on-wikipedias-cert>All right, wikipedia&rsquo;s certificate is signed by a CA whose common name is &ldquo;Let&rsquo;s Encrypt&rdquo;. But how do I find this issuer&rsquo;s public key so that I can verify the signature on wikipedia&rsquo;s cert?</h1><p>The &ldquo;distinguished name&rdquo; seems to be important
<a href=https://security.stackexchange.com/questions/20869/how-is-an-x509-certificate-signer-verified>https://security.stackexchange.com/questions/20869/how-is-an-x509-certificate-signer-verified</a>
<a href=https://stackoverflow.com/questions/28147848/how-do-i-check-if-certificate-a-got-certfiicate-b-as-issuer-in-java-x509cer>https://stackoverflow.com/questions/28147848/how-do-i-check-if-certificate-a-got-certfiicate-b-as-issuer-in-java-x509cer</a></p><p>not very sure &mldr; these are &ldquo;extensions&rdquo; &mldr;</p><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>openssl x509 -in cert.pem -noout -text
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>...
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>        X509v3 extensions:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>            X509v3 Key Usage: critical
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>                Digital Signature
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>            X509v3 Extended Key Usage: 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>                TLS Web Server Authentication, TLS Web Client Authentication
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>            X509v3 Basic Constraints: critical
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>                CA:FALSE
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>            X509v3 Subject Key Identifier: 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>                EA:38:F6:8E:A8:D2:66:AA:4C:64:73:89:B7:35:BB:F8:7E:DF:B1:FE
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>            X509v3 Authority Key Identifier: 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>                keyid:A8:4A:6A:63:04:7D:DD:BA:E6:D1:39:B7:A6:45:65:EF:F3:A8:EC:A1
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>            Authority Information Access: 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>                OCSP - URI:http://ocsp.int-x3.letsencrypt.org
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>                CA Issuers - URI:http://cert.int-x3.letsencrypt.org/</span></span></code></pre></div><button>copy</button></div><h1 id=the-fingerprint-thing>The &ldquo;Fingerprint&rdquo; thing</h1><p>Fingerprint is just the hash of some data.</p><p>In the certificate detail page of chrome and firefox, usually there will be a &ldquo;Fingerprints&rdquo; section showing the SHA256 and SHA1 checksum of something. Those are the checksum of the DER certificate, and is NOT a part of the certificate itself. Browsers provide those checksum to make it easier for user to check.</p><p>To verify</p><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#75715e># wikipedia.org cert</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>openssl x509 -in cert.pem -outform DER | sha256sum 
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>9eb21a74a3cf1ecaaf6b19253025b4ca38f182e9f1f3e7355ba3c3004d4b7a10  -</span></span></code></pre></div><button>copy</button></div><p><a href=https://security.stackexchange.com/questions/14330/what-is-the-actual-value-of-a-certificate-fingerprint>https://security.stackexchange.com/questions/14330/what-is-the-actual-value-of-a-certificate-fingerprint</a></p><h1 id=hmac>HMAC</h1><p>A MAC is a conceptual combination of 3 algorithms:</p><ol><li>a key generation that sample a key uniformally random from the key space</li><li>a signing algorithm that takes a)the key and b) the message to send, and produces a <code>tag</code></li><li>a verifying algorithm that takes the a)<code>tag</code>, the key and the message, and produce &ldquo;accept&rdquo; if the (message, tag) pair has not been tampered with since being produced, or &ldquo;reject&rdquo; otherwise.</li></ol><p>MAC is mainly a measure to ensure the integrity of data in transmission, since the key should never been send out or seen by the outside world.</p><p>One technique to implement a MAC is to use a CHF, and such technique is called HMAC. CHF is known to produce a small fixed size bit sequence that can be used as a tag. The only problem is that CHF does not takes key. HMAC gives a way to wrap a CHF in its core and takes a key.</p><h1 id=public-key-certificate>Public Key Certificate</h1><p>the one who wants to prove the identity of himself needs to send the cert
the one who is receiving the certificate needs to trust the issuer</p><h1 id=self-signing>Self-Signing</h1><h1 id=chainweb-of-trust>Chain/Web of Trust</h1><h1 id=trust-anchor>Trust Anchor</h1><h1 id=cipher-suites>cipher suites</h1><p>combinations of</p><ul><li>key exchanging algo</li><li>bulk encryption algo</li><li>message auth code (MAC) algo</li></ul><h1 id=todos>TODOs</h1><p>Non-deterministic crypto system?</p></div></article></main><footer>Unless otherwise noted, content of this site is licensed under
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ style=text-decoration:underline>the CC BY-NC-SA 4.0</a>.<br>cesun.info copyright 2024.</footer></body></html>