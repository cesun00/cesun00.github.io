<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Spring IOC: Type Hierarchy | Infinity Architect</title>
<link rel=stylesheet href=/main.css><script type=importmap>
  {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.167.1/+esm"
      }
  }
  </script><script type=module src=/theme.mjs></script><style>.tag-android{background-color:hsl(0deg 80% 70%)}.dark .tag-android{background-color:hsl(0deg 80% 20%)}.tag-annotation{background-color:hsl(50deg 80% 70%)}.dark .tag-annotation{background-color:hsl(50deg 80% 20%)}.tag-assembly{background-color:hsl(100deg 80% 70%)}.dark .tag-assembly{background-color:hsl(100deg 80% 20%)}.tag-asymmetrical-cryptography{background-color:hsl(150deg 80% 70%)}.dark .tag-asymmetrical-cryptography{background-color:hsl(150deg 80% 20%)}.tag-awk{background-color:hsl(200deg 80% 70%)}.dark .tag-awk{background-color:hsl(200deg 80% 20%)}.tag-bootloader{background-color:hsl(250deg 80% 70%)}.dark .tag-bootloader{background-color:hsl(250deg 80% 20%)}.tag-bytecode{background-color:hsl(300deg 80% 70%)}.dark .tag-bytecode{background-color:hsl(300deg 80% 20%)}.tag-c{background-color:hsl(350deg 80% 70%)}.dark .tag-c{background-color:hsl(350deg 80% 20%)}.tag-cxx{background-color:hsl(40deg 80% 70%)}.dark .tag-cxx{background-color:hsl(40deg 80% 20%)}.tag-cxx-stl{background-color:hsl(90deg 80% 70%)}.dark .tag-cxx-stl{background-color:hsl(90deg 80% 20%)}.tag-cgroup{background-color:hsl(140deg 80% 70%)}.dark .tag-cgroup{background-color:hsl(140deg 80% 20%)}.tag-cheetsheet{background-color:hsl(190deg 80% 70%)}.dark .tag-cheetsheet{background-color:hsl(190deg 80% 20%)}.tag-clang{background-color:hsl(240deg 80% 70%)}.dark .tag-clang{background-color:hsl(240deg 80% 20%)}.tag-coding-theory{background-color:hsl(290deg 80% 70%)}.dark .tag-coding-theory{background-color:hsl(290deg 80% 20%)}.tag-compression{background-color:hsl(340deg 80% 70%)}.dark .tag-compression{background-color:hsl(340deg 80% 20%)}.tag-concept{background-color:hsl(30deg 80% 70%)}.dark .tag-concept{background-color:hsl(30deg 80% 20%)}.tag-cpu{background-color:hsl(80deg 80% 70%)}.dark .tag-cpu{background-color:hsl(80deg 80% 20%)}.tag-crawler{background-color:hsl(130deg 80% 70%)}.dark .tag-crawler{background-color:hsl(130deg 80% 20%)}.tag-cryptography{background-color:hsl(180deg 80% 70%)}.dark .tag-cryptography{background-color:hsl(180deg 80% 20%)}.tag-css{background-color:hsl(230deg 80% 70%)}.dark .tag-css{background-color:hsl(230deg 80% 20%)}.tag-database{background-color:hsl(280deg 80% 70%)}.dark .tag-database{background-color:hsl(280deg 80% 20%)}.tag-deflate{background-color:hsl(330deg 80% 70%)}.dark .tag-deflate{background-color:hsl(330deg 80% 20%)}.tag-design{background-color:hsl(20deg 80% 70%)}.dark .tag-design{background-color:hsl(20deg 80% 20%)}.tag-dns{background-color:hsl(70deg 80% 70%)}.dark .tag-dns{background-color:hsl(70deg 80% 20%)}.tag-dom{background-color:hsl(120deg 80% 70%)}.dark .tag-dom{background-color:hsl(120deg 80% 20%)}.tag-driver{background-color:hsl(170deg 80% 70%)}.dark .tag-driver{background-color:hsl(170deg 80% 20%)}.tag-elastic{background-color:hsl(220deg 80% 70%)}.dark .tag-elastic{background-color:hsl(220deg 80% 20%)}.tag-elf{background-color:hsl(270deg 80% 70%)}.dark .tag-elf{background-color:hsl(270deg 80% 20%)}.tag-elk{background-color:hsl(320deg 80% 70%)}.dark .tag-elk{background-color:hsl(320deg 80% 20%)}.tag-flex{background-color:hsl(10deg 80% 70%)}.dark .tag-flex{background-color:hsl(10deg 80% 20%)}.tag-gc{background-color:hsl(60deg 80% 70%)}.dark .tag-gc{background-color:hsl(60deg 80% 20%)}.tag-gcc{background-color:hsl(110deg 80% 70%)}.dark .tag-gcc{background-color:hsl(110deg 80% 20%)}.tag-gnu{background-color:hsl(160deg 80% 70%)}.dark .tag-gnu{background-color:hsl(160deg 80% 20%)}.tag-go{background-color:hsl(210deg 80% 70%)}.dark .tag-go{background-color:hsl(210deg 80% 20%)}.tag-gzip{background-color:hsl(260deg 80% 70%)}.dark .tag-gzip{background-color:hsl(260deg 80% 20%)}.tag-hash{background-color:hsl(310deg 80% 70%)}.dark .tag-hash{background-color:hsl(310deg 80% 20%)}.tag-http{background-color:hsl(0deg 80% 70%)}.dark .tag-http{background-color:hsl(0deg 80% 20%)}.tag-huffman{background-color:hsl(50deg 80% 70%)}.dark .tag-huffman{background-color:hsl(50deg 80% 20%)}.tag-java{background-color:hsl(100deg 80% 70%)}.dark .tag-java{background-color:hsl(100deg 80% 20%)}.tag-java-module{background-color:hsl(150deg 80% 70%)}.dark .tag-java-module{background-color:hsl(150deg 80% 20%)}.tag-javascript{background-color:hsl(200deg 80% 70%)}.dark .tag-javascript{background-color:hsl(200deg 80% 20%)}.tag-jdk{background-color:hsl(250deg 80% 70%)}.dark .tag-jdk{background-color:hsl(250deg 80% 20%)}.tag-js{background-color:hsl(300deg 80% 70%)}.dark .tag-js{background-color:hsl(300deg 80% 20%)}.tag-jvm{background-color:hsl(350deg 80% 70%)}.dark .tag-jvm{background-color:hsl(350deg 80% 20%)}.tag-kernel{background-color:hsl(40deg 80% 70%)}.dark .tag-kernel{background-color:hsl(40deg 80% 20%)}.tag-lexer{background-color:hsl(90deg 80% 70%)}.dark .tag-lexer{background-color:hsl(90deg 80% 20%)}.tag-linux{background-color:hsl(140deg 80% 70%)}.dark .tag-linux{background-color:hsl(140deg 80% 20%)}.tag-log4j2{background-color:hsl(190deg 80% 70%)}.dark .tag-log4j2{background-color:hsl(190deg 80% 20%)}.tag-lz77{background-color:hsl(240deg 80% 70%)}.dark .tag-lz77{background-color:hsl(240deg 80% 20%)}.tag-make{background-color:hsl(290deg 80% 70%)}.dark .tag-make{background-color:hsl(290deg 80% 20%)}.tag-makefile{background-color:hsl(340deg 80% 70%)}.dark .tag-makefile{background-color:hsl(340deg 80% 20%)}.tag-maven{background-color:hsl(30deg 80% 70%)}.dark .tag-maven{background-color:hsl(30deg 80% 20%)}.tag-memory{background-color:hsl(80deg 80% 70%)}.dark .tag-memory{background-color:hsl(80deg 80% 20%)}.tag-multithreading{background-color:hsl(130deg 80% 70%)}.dark .tag-multithreading{background-color:hsl(130deg 80% 20%)}.tag-mybatis{background-color:hsl(180deg 80% 70%)}.dark .tag-mybatis{background-color:hsl(180deg 80% 20%)}.tag-mysql{background-color:hsl(230deg 80% 70%)}.dark .tag-mysql{background-color:hsl(230deg 80% 20%)}.tag-nasm{background-color:hsl(280deg 80% 70%)}.dark .tag-nasm{background-color:hsl(280deg 80% 20%)}.tag-node{background-color:hsl(330deg 80% 70%)}.dark .tag-node{background-color:hsl(330deg 80% 20%)}.tag-nodejs{background-color:hsl(20deg 80% 70%)}.dark .tag-nodejs{background-color:hsl(20deg 80% 20%)}.tag-openssl{background-color:hsl(70deg 80% 70%)}.dark .tag-openssl{background-color:hsl(70deg 80% 20%)}.tag-playwright{background-color:hsl(120deg 80% 70%)}.dark .tag-playwright{background-color:hsl(120deg 80% 20%)}.tag-posix{background-color:hsl(170deg 80% 70%)}.dark .tag-posix{background-color:hsl(170deg 80% 20%)}.tag-powershell{background-color:hsl(220deg 80% 70%)}.dark .tag-powershell{background-color:hsl(220deg 80% 20%)}.tag-programming-langauge{background-color:hsl(270deg 80% 70%)}.dark .tag-programming-langauge{background-color:hsl(270deg 80% 20%)}.tag-programming-language{background-color:hsl(320deg 80% 70%)}.dark .tag-programming-language{background-color:hsl(320deg 80% 20%)}.tag-qemu{background-color:hsl(10deg 80% 70%)}.dark .tag-qemu{background-color:hsl(10deg 80% 20%)}.tag-redis{background-color:hsl(60deg 80% 70%)}.dark .tag-redis{background-color:hsl(60deg 80% 20%)}.tag-retrocomputing{background-color:hsl(110deg 80% 70%)}.dark .tag-retrocomputing{background-color:hsl(110deg 80% 20%)}.tag-rfc{background-color:hsl(160deg 80% 70%)}.dark .tag-rfc{background-color:hsl(160deg 80% 20%)}.tag-sdram{background-color:hsl(210deg 80% 70%)}.dark .tag-sdram{background-color:hsl(210deg 80% 20%)}.tag-sed{background-color:hsl(260deg 80% 70%)}.dark .tag-sed{background-color:hsl(260deg 80% 20%)}.tag-slf4j{background-color:hsl(310deg 80% 70%)}.dark .tag-slf4j{background-color:hsl(310deg 80% 20%)}.tag-spring{background-color:hsl(0deg 80% 70%)}.dark .tag-spring{background-color:hsl(0deg 80% 20%)}.tag-spring-boot{background-color:hsl(50deg 80% 70%)}.dark .tag-spring-boot{background-color:hsl(50deg 80% 20%)}.tag-spring-data{background-color:hsl(100deg 80% 70%)}.dark .tag-spring-data{background-color:hsl(100deg 80% 20%)}.tag-spring-ioc{background-color:hsl(150deg 80% 70%)}.dark .tag-spring-ioc{background-color:hsl(150deg 80% 20%)}.tag-sql{background-color:hsl(200deg 80% 70%)}.dark .tag-sql{background-color:hsl(200deg 80% 20%)}.tag-streaming{background-color:hsl(250deg 80% 70%)}.dark .tag-streaming{background-color:hsl(250deg 80% 20%)}.tag-template{background-color:hsl(300deg 80% 70%)}.dark .tag-template{background-color:hsl(300deg 80% 20%)}.tag-testing{background-color:hsl(350deg 80% 70%)}.dark .tag-testing{background-color:hsl(350deg 80% 20%)}.tag-thymeleaf{background-color:hsl(40deg 80% 70%)}.dark .tag-thymeleaf{background-color:hsl(40deg 80% 20%)}.tag-tls{background-color:hsl(90deg 80% 70%)}.dark .tag-tls{background-color:hsl(90deg 80% 20%)}.tag-tomcat{background-color:hsl(140deg 80% 70%)}.dark .tag-tomcat{background-color:hsl(140deg 80% 20%)}.tag-transaction{background-color:hsl(190deg 80% 70%)}.dark .tag-transaction{background-color:hsl(190deg 80% 20%)}.tag-transistor{background-color:hsl(240deg 80% 70%)}.dark .tag-transistor{background-color:hsl(240deg 80% 20%)}.tag-ts{background-color:hsl(290deg 80% 70%)}.dark .tag-ts{background-color:hsl(290deg 80% 20%)}.tag-typescript{background-color:hsl(340deg 80% 70%)}.dark .tag-typescript{background-color:hsl(340deg 80% 20%)}.tag-unix{background-color:hsl(30deg 80% 70%)}.dark .tag-unix{background-color:hsl(30deg 80% 20%)}.tag-web{background-color:hsl(80deg 80% 70%)}.dark .tag-web{background-color:hsl(80deg 80% 20%)}.tag-x86{background-color:hsl(130deg 80% 70%)}.dark .tag-x86{background-color:hsl(130deg 80% 20%)}.tag-x86_64{background-color:hsl(180deg 80% 70%)}.dark .tag-x86_64{background-color:hsl(180deg 80% 20%)}.tag-x86-64{background-color:hsl(230deg 80% 70%)}.dark .tag-x86-64{background-color:hsl(230deg 80% 20%)}.tag-xpath{background-color:hsl(280deg 80% 70%)}.dark .tag-xpath{background-color:hsl(280deg 80% 20%)}.tag-zlib{background-color:hsl(330deg 80% 70%)}.dark .tag-zlib{background-color:hsl(330deg 80% 20%)}</style></head><body><script>localStorage.getItem("dark-theme")&&document.body.classList.add("dark")</script><header><h2 id=banner><a href=/>Infinity Architect</a></h2><div id=top-sections><a href=/android/ class=hoverable>Android </a><a href=/cxx/ class=hoverable>C/C++ </a><a href=/compression/ class=hoverable>Compression </a><a href=/cpu/ class=hoverable>CPU </a><a href=/crypto/ class=hoverable>Cryptography </a><a href=/db/ class=hoverable>Database </a><a href=/ee/ class=hoverable>Electronic Engineering </a><a href=/linux/ class=hoverable>GNU/Linux </a><a href=/go/ class=hoverable>Golang </a><a href=/java/ class=active>Java </a><a href=/microservice/ class=hoverable>Microservice </a><a href=/net/ class=hoverable>Network & Protocol </a><a href=/physics/ class=hoverable>Physics </a><a href=/retro/ class=hoverable>Retro-Computing </a><a href=/toy/ class=hoverable>Toys </a><a href=/windev/ class=hoverable>Window</a></div><div class=theme-switch style="align-self:center;margin:auto 20px"><input type=checkbox id=theme-checkbox>
<label for=theme-checkbox><div></div><span><svg viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M9.528 1.718a.75.75.0 01.162.819A8.97 8.97.0 009 6a9 9 0 009 9 8.97 8.97.0 003.463-.69.75.75.0 01.981.98 10.503 10.503.0 01-9.694 6.46c-5.799.0-10.5-4.701-10.5-10.5.0-4.368 2.667-8.112 6.46-9.694a.75.75.0 01.818.162z" clip-rule="evenodd"/></svg>
</span><span><svg viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M12 2.25a.75.75.0 01.75.75v2.25a.75.75.0 01-1.5.0V3a.75.75.0 01.75-.75zM7.5 12a4.5 4.5.0 119 0 4.5 4.5.0 01-9 0zM18.894 6.166a.75.75.0 00-1.06-1.06l-1.591 1.59a.75.75.0 101.06 1.061l1.591-1.59zM21.75 12a.75.75.0 01-.75.75h-2.25a.75.75.0 010-1.5H21a.75.75.0 01.75.75zm-3.916 6.894a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 10-1.061 1.06l1.59 1.591zM12 18a.75.75.0 01.75.75V21a.75.75.0 01-1.5.0v-2.25A.75.75.0 0112 18zM7.758 17.303a.75.75.0 00-1.061-1.06l-1.591 1.59a.75.75.0 001.06 1.061l1.591-1.59zM6 12a.75.75.0 01-.75.75H3a.75.75.0 010-1.5h2.25A.75.75.0 016 12zm.697-4.243a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 00-1.061 1.06l1.59 1.591z"/></svg></span></label></div></header><main><article class=basic-text><div style=font-family:monospace;font-size:1.5em><div class=basic-text>/<a href=/>HOME</a>/<a href=/java/>Java</a>/<a href=/java/spring/>Spring</a>/<a href=/java/spring/ioc/>Spring Infrastructure & IOC Container</a>/
$</div></div><div style=margin-bottom:60px><h1 style=margin-bottom:0>Spring IOC: Type Hierarchy</h1><p class=aux-text style=margin-top:0>Published at: September 2, 2023
| Last modification: August 1, 2024</p><div style=line-height:2em><span class="page-tag tag-java">java</span>
<span class="page-tag tag-spring">Spring</span>
<span class="page-tag tag-spring-ioc">Spring IOC</span></div></div><div><p>This article gives overviews of various type hierarchies in the <code>spring-context</code> source.</p><h2 id=the-interface-beandefinition-family>The <code>interface BeanDefinition</code> Family</h2><p>The IOC container manages beans.</p><ul><li>An <code>interface BeanDefinition</code> instance represents the metadata of a bean, and</li><li>an <code>interface BeanDefinitionRegistry</code> instance represents a collection of <code>BeanDefinition</code>s.</li></ul><p>There is only 1 <code>BeanDefinition</code> instance for each, well, bean definition, regardless of its scope being singleton / prototyped / custom-scoped.</p><h3 id=beandefinition-hierarchy><code>BeanDefinition</code> Hierarchy</h3><ul><li><code>BeanDefinition</code> and allows configuring the metadata of (thus the nature of) a bean by providing access to the a few properties; while</li><li><code>AnnotatedBeanDefinition</code> extends <code>BeanDefinition</code> by being awared of the annotations tagged on the bean class.</li></ul><p><code>BeanDefinition</code> exposes APIs for the following properties:</p><table><thead><tr><th>property</th><th>comment</th><th>access</th></tr></thead><tbody><tr><td><code>String parentName</code></td><td><code>BeanDefinition</code>s can be hierarchical by design.</td><td>get set</td></tr><tr><td><code>Object beanClass</code></td><td>either <code>String</code> or <code>Class</code>, weird</td><td>get set</td></tr><tr><td><code>String scope</code></td><td>scope name for scoped bean</td><td>get set</td></tr><tr><td><code>boolean lazyInit</code></td><td></td><td>get set</td></tr><tr><td><code>String[] dependsOn</code></td><td></td><td>get set</td></tr><tr><td><code>boolean autowireCandidate</code></td><td>whether this bean is a candidate for getting autowired into some other bean</td><td>get set</td></tr><tr><td><code>boolean primary</code></td><td>whether this bean is <code>@Primary</code> or <code>primary="true"</code></td><td>get set</td></tr><tr><td><code>String factoryBeanName</code></td><td><code>&lt;bean factory-bean="" ...></code></td><td>get set</td></tr><tr><td><code>String factoryMethodName</code></td><td><code>&lt;bean factory-method="" ...></code></td><td>get set</td></tr><tr><td><code>ConstructorArgumentValues</code></td><td>collection-like (*)</td><td>get isEmpty</td></tr><tr><td><code>MutablePropertyValues propertyValues</code></td><td>collection-like (*)</td><td>get isEmpty</td></tr><tr><td><code>String initMethodName</code></td><td><code>&lt;bean init-method="..."></code>. DISRESPECT <code>@PostConstruct</code></td><td>get set</td></tr><tr><td><code>String destroyMethodName</code></td><td><code>&lt;bean destroy-method="..."></code>. DISRESPECT <code>@PreDestroy</code></td><td>get set</td></tr><tr><td><code>int role</code></td><td>bean role enum int; one of: <code>ROLE_APPLICATION</code>, <code>ROLE_SUPPORT</code>, <code>ROLE_INFRASTRUCTURE</code></td><td>get set</td></tr><tr><td><code>String description</code></td><td>human-readable description for this bean</td><td>get set</td></tr><tr><td><code>ResolvableType resolvableType</code></td><td>READONLY.</td><td>get</td></tr><tr><td><code>boolean singleton</code></td><td>READONLY.</td><td>get</td></tr><tr><td><code>boolean prototype</code></td><td>READONLY.</td><td>get</td></tr><tr><td><code>boolean abstract</code></td><td>READONLY. <code>&lt;bean abstract="..."></code></td><td>get</td></tr><tr><td><code>String resourceDescription</code></td><td>READONLY.</td><td>get</td></tr><tr><td><code>BeanDefinition originatingBeanDefinition</code></td><td>READONLY.</td><td>get</td></tr></tbody></table><p>* collection-like type property doesn&rsquo;t provide setter, since the getter-returned object itself provides CRUD on its internal collection.
Besides getter, there is usually an <code>isEmpty()</code> just for convenience, delegated to that collection-type.</p><h4 id=implementations>Implementations</h4><p><code>public abstract class AbstractBeanDefinition</code> is a common base class for all non-trivial <code>BeanDefinition</code> implementation.
Most properties exposed by the <code>BeanDefinition</code> interface APIs are simply backed up by fields of this class.</p><p>It has 3 direct subclasses:</p><ul><li><code>class RootBeanDefinition</code> (beans.factory.support)</li><li><code>class ChildBeanDefinition</code> (beans.factory.support)</li><li><code>class GenericBeanDefinition</code> (beans.factory.support)</li></ul><h3 id=beandefinitionregistry-hierarchy><code>BeanDefinitionRegistry</code> Hierarchy</h3><p><code>interface BeanDefinitionRegistry</code> defines APIs modeling a registry of <code>BeanDefinition</code>. It allows:</p><ol><li>CRUD on a <code>Map&lt;String,String></code> that maps alias to bean unique ID.</li><li>CRUD on a <code>Map&lt;String,BeanDefinition></code> that maps a bean name (either alias or ID) to bean&rsquo;s <code>BeanDefinition</code>.</li></ol><p>It&rsquo;s the only interface in Spring that covers the registration of bean definitions.</p><p>In the current Spring 6 code,</p><ul><li>APIs on the first map is always backed up by a real <code>Map</code> at <code>SimpleAliasRegistry#aliasMap</code> (an ancestor class of <code>DefaultListableBeanFactory</code>).</li><li>APIs on the second map is always backed up by a real <code>Map</code> at <code>DefaultListableBeanFactory#beanDefinitionMap</code>.</li><li>The only <code>BeanDefinitionRegistry</code> is always your <code>ApplicationContext</code> instance.</li></ul><p>Implementations:</p><ul><li><code>SimpleAliasRegistry</code> (core)</li><li><code>DefaultSingletonBeanRegistry</code> (beans.factory.support)</li><li><code>FactoryBeanRegistrySupport</code> (beans.factory.support)</li><li><code>SimpleBeanDefinitionRegistry</code> (beans.factory.support)</li></ul><h3 id=beandefinition-generators><code>BeanDefinition</code> Generators</h3><p>We&rsquo;ve discussed <code>BeanDefinition</code> and the registry that holds its (implementation) instances, <code>BeanDefinitionRegistry</code>.</p><p>A third types of classes populating <code>BeanDefinition</code>s into a <code>BeanDefinitionRegistry</code> instance.
Such a class:</p><ol><li>hold an existing <code>BeanDefinitionRegistry registry</code> (always your <code>ApplicationContext</code> instance) as its internal state</li><li>deriving <code>BeanDefinition</code>s from some source configuration in some format</li><li>add them to <code>registry</code> by calling <code>BeanDefinitionRegistry#registerBeanDefinition()</code>.</li></ol><p>Such classes may or may not implement <code>interface BeanDefinitionReader</code>.</p><ul><li>those do: <code>abstract class AbstractBeanDefinitionReader</code> and subclasses<ul><li><code>XmlBeanDefinitionReader</code> (used by various <code>*XmlApplicationContext</code>s)</li><li><code>GroovyBeanDefinitionReader</code></li><li><code>PropertiesBeanDefinitionReader</code> (deprecated)</li></ul></li><li>those don&rsquo;t:<ul><li><code>org.springframework.context.annotation.AnnotatedBeanDefinitionReader</code></li><li><code>org.springframework.context.annotation.ClassPathBeanDefinitionScanner</code></li></ul></li></ul><h2 id=the-interface-beanfactory-family>The <code>interface BeanFactory</code> Family</h2><p>The <code>BeanDefinitionRegistry</code> interface, as discussed above, does registration of <code>BeanDefinition</code>s.
On the other hand, the <code>BeanFactory</code> (defines APIs that) produces & caches real bean objects.</p><p>That being said, in the current Spring code they are always implemented by the same class - the <code>DefaultListableBeanFactory</code>,
i.e. both <code>BeanDefiniton</code>s and constructed beans instances are maintained by the same object.</p><h3 id=beanfactory-hierarchy><code>BeanFactory</code> Hierarchy</h3><p>The root <code>BeanFactory</code> interface defines only APIs for single-point query of beans; i.e. range query or listing of beans are impossible.</p><p>Supported operations are:</p><ol><li>retrieve a unique bean (or their lazy provider) by its ID or by class;<ul><li>when querying by class, <code>NoUniqueBeanDefinitionException</code> is thrown if more than one satisfying beans are found</li></ul></li><li>query certain characteristic of a bean by bean name, including:<ol><li>existance</li><li>class</li><li>scope (singleton / prototype / other scoped)</li><li>alias names</li></ol></li></ol><table style=border-right:none><thead><tr><td><p>interface</p></td><td></td></tr></thead><tbody><tr><td><p><code>interface HierarchicalBeanFactory</code> (beans.factory)</p></td><td><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>BeanFactory <span style=color:#a6e22e>getParentBeanFactory</span>();         <span style=color:#75715e>// get the parent bean factory; `null` if there is none.</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>containsLocalBean</span>(String name);     <span style=color:#f92672>//</span> whether the local bean factory contains a bean</span></span></code></pre></div><button>copy</button></div><p>Extends <code>BeanFactory</code> by introducing the concept of hierarchical bean factories (and thus hierarchical <code>ApplicationContext</code>),
and allowing users to get a reference to its parent bean factory, and query if a bean is present locally.</p></td></tr><tr style=position:relative;left:2em><td><p><code>interface ConfigurableBeanFactory</code> (beans.factory.config)</p></td><td><p><strong>Spring&rsquo;s internal usage only.</strong></p><p>Extends <code>HierarchicalBeanFactory</code> by adding rich APIs for programmatically adjusting the configuration of an existing <code>BeanFactory</code>,
including accessors for:</p><ol><li>The <code>ConversionService</code></li><li>the Map of custom scopes</li><li>The collection of ``BeanPostProcessor`</li></ol><p>Such freedom of configuration are not meant to be available to application code, thus this interface is not included by the <code>ApplicationContext</code> hierarchy to prevent accidental upcast.</p></td></tr><tr style=position:relative;left:4em><td><p><code>interface ConfigurableListableBeanFactory</code> (beans.factory.config)</td><td></p><p>This interface aggregates all 3 direct sub-interfaces of <code>BeanFactory</code>, i.e.</p><ul><li><code>ConfigurableBeanFactory</code></li><li><code>ListableBeanFactory</code></li><li><code>AutowireCapableBeanFactory</code></li></ul><p><strong>This interface is still for Spring&rsquo;s internal usage only</strong>, since it&rsquo;s the sub-interface of <code>ConfigurableBeanFactory</code>.
<a href=https://stackoverflow.com/questions/16448579/how-can-i-programatically-add-a-beanpostprocessor-to-a-classpathxmlapplicationco>It&rsquo;s thus deprecated to programmatically add <code>BeanPostProcessor</code> via this interface.</a>. Configure your post processor as a detectable bean instead.</p></td></tr><tr><td><p><code>interface ListableBeanFactory</code> (beans.factory)</p></td><td><p>Extend <code>BeanFactory</code> by providing APIs for range querying all beans of specific type and listing of <code>BeanDefinition</code>, featured by returning collection or array.</p><p><em>Application code is encouraged to use this subinterface whenever programmatically obtaining beans.</em></p></td></tr><tr><td><p><code>interface AutowireCapableBeanFactory</code> (beans.factory.config)</p></td><td><p>Extends <code>BeanFactory</code> by allowing programmatically creation of new instances of a given bean class.</p><p><strong>This subinterface is not meant to be used by application code.</strong></p></td></tr></tbody></table><h4 id=implementations-1>Implementations</h4><table><thead><tr><td>implementation class</td><td></td></tr></thead><tbody><tr><td><p><code>class DefaultSingletonBeanRegistry</code></p></td><td></td></tr><tr><td><p><code>class AbstractBeanFactory</code> (beans.factory.support)</p></td><td></td></tr><tr><td><p><code>class AbstractAutowireCapableBeanFactory</code> (beans.factory.support)</p></td><td></td></tr><tr><td><p><code>class SimpleJndiBeanFactory</code> (jndi.support)</p></td><td></td></tr><tr><td><p><code>class StaticListableBeanFactory</code> (beans.factory.support)</p></td><td></td></tr><tr><td><p><code>class DefaultListableBeanFactory</code> (beans.factory.support)</p></td><td><p>The most frequently used <code>BeanFactory</code> implementation of all time.
An instance is composited by all subclasses of <code>AbstractApplicationContext</code>, thus all implementation of <code>ApplicationContext</code>.</p></td></tr></tbody></table><h2 id=the-applicationcontext-hierarchy>The <code>ApplicationContext</code> Hierarchy</h2><h3 id=interfaces-applicationcontext-and-configurableapplicationcontext>interfaces: <code>ApplicationContext</code> and <code>ConfigurableApplicationContext</code></h3><p><code>ApplicationContext</code> is an aggregation interface that simply combines the ability of</p><ul><li><p><code>interface ListableBeanFactory</code></p></li><li><p><code>interface HierarchicalBeanFactory</code></p><p>An <code>ApplicationContext</code> implementation instance supports <code>interface ListableBeanFactory</code> and <code>interface HierarchicalBeanFactory</code>
via proxy pattern: it should hold a <code>BeanFactory</code> instance to which APIs inherited from these 2 super-interfaces are delegated.
To be precise, the delegated <code>BeanFactory</code> <strong>must</strong> be subclass of <code>abstract class AbstractAutowireCapableBeanFactory</code> to
support the <code>getAutowireCapableBeanFactory()</code> API (see below), and almost always it&rsquo;s subclass <code>DefaultListableBeanFactory</code></p></li><li><p><code>interface ApplicationEventPublisher</code>: a root interface that allows <code>publishEvent()</code>.</p></li><li><p><code>interface EnvironmentCapable</code>: a root interface that provides a getter of a container-wide <code>Environment</code> singleton (no setter), from which app code queries profile and properties.</p></li><li><p><code>interface MessageSource</code>: a root interface that allows resolving message code to i18n message string.</p></li><li><p><code>interface ResourcePatternResolver</code>: an interface that locates Spring&rsquo;s <code>Resource</code> by parsing glob resource path.</p></li></ul><p><code>ApplicationContext</code> itself only adds minor APIs for container identification:</p><ol><li><code>getId() / getDisplayName()</code> return a unique string identifier / human-readable name of this context<ul><li>by default these 2 are both generated by <code>ObjectUtils.identityToString(this)</code>, e.g. <code>"org.springframework.context.annotation.AnnotationConfigApplicationContext@16c0663d"</code></li></ul></li><li><code>getApplicationName()</code> returns an identifier for the Java application that creates this context.</li><li><code>getStartupDate()</code>: returns unix epoch when this context was created.</li><li><code>getParent()</code>: <code>ApplicationContext</code>-specialization of <code>HierarchicalBeanFactory::getParentBeanFactory()</code></li><li><code>getAutowireCapableBeanFactory()</code> returns the composite <code>interface AutowireCapableBeanFactory</code>. This API returns the composited <code>AbstractAutowireCapableBeanFactory</code>-implementing instance upcasted to <code>AutowireCapableBeanFactory</code>.</li></ol><p>Doc of <code>AbstractApplicationContext</code> mentioned that:</p><blockquote><p>In contrast to a plain BeanFactory, an ApplicationContext is supposed to detect special beans defined in its internal bean factory.</p></blockquote><p>Note that an <code>ApplicationContext</code> is:</p><ul><li><strong>not</strong> a <code>ConfigurableBeanFactory</code></li><li><strong>not</strong> a <code>AutowireCapableBeanFactory</code></li></ul><p>These 2 interfaces are not meant to be used by application code, thus it doesn&rsquo;t make sense to allow an upcast from <code>ApplicationContext</code> to either.</p><h4 id=configurableapplicationcontext><code>ConfigurableApplicationContext</code></h4><p>In contrast to the <code>ConfigurableBeanFactory</code>, it&rsquo;s perfectly fine for application code to use this interface.
It extends <code>ApplicationContext</code> by</p><ol><li>including <code>Lifecycle</code> to be used by code that cares about container lifecycle</li><li>including <code>Closable</code> allowing a well-defined shutdown process of a container</li><li>override the return type for <code>ApplicationContext | EnvironmentCapable::getEnvironment()</code> from <code>Environment</code> to covariant <code>ConfigurableEnvironment</code></li><li>adding configuration APIs, especially setters, for various previously getter-only internal states (in <code>ApplicationContext</code>):<ul><li>corresponding setter for previously getter:<ul><li><code>setId()</code> &mldr; <code>ApplicationContext::getId()</code></li><li><code>setParent()</code> &mldr; <code>ApplicationContext::getParent()</code></li><li><code>setEnvironment()</code> &mldr; <code>ApplicationContext | EnvironmentCapable::getEnvironment()</code></li><li><code>setClassLoader()</code> &mldr; <code>ApplicationContext | ResourcePatternResolver | ResourceLoader::getClassLoader()</code></li></ul></li><li>collection adder for<ul><li><code>BeanFactoryPostProcessor</code></li><li><code>ApplicationListener</code></li><li><code>ProtocolResolver</code></li></ul></li><li>getter and setter for <code>ApplicationStartup</code> (identical to <code>ConfigurableBeanFactory</code>&rsquo;s ones)</li><li><code>getBeanFactory()</code> returns the composite <code>BeanFactory</code> in the name of <code>ConfigurableListableBeanFactory</code><ul><li>return the same instance as <code>ApplicationContext::getAutowireCapableBeanFactory()</code>, and only differ by return type</li></ul></li><li>container administrative facades:<ul><li><code>refresh()</code></li><li><code>registerShutdownHook()</code>: gracefully shutdown container upon JVM&rsquo;s exit.</li><li><code>isActive()</code> boolean test container activeness</li></ul></li></ul></li></ol><h3 id=implementations-2>Implementations</h3><h4 id=abstract-class-abstractapplicationcontext-contextsupport><code>abstract class AbstractApplicationContext</code> (context.support)</h4><p>The first implementation of <code>ApplicationContext</code> down the hierarchy (though partial), and the ancestor class of all <code>ApplicationContext</code> implementations.
It is also the most heavy-duty one containing most code.</p><p><code>AbstractApplicationContext</code> has a feature of automatically registering <code>BeanFactoryPostProcessor</code>s, <code>BeanPostProcessor</code>s, and <code>ApplicationListener</code> which are defined as beans in the context. That&rsquo;s the reason why <code>BeanPostProcessor</code> defined as <code>@Bean</code> works automatically.</p><p>It has 2 subclasses which differ by whether multiple calls to the <code>refresh()</code> API are supported:</p><ol><li><code>AbstractRefreshableApplicationContext</code> supports multiple calls to <code>ConfigurableApplicationContext::refresh()</code> by actually replacing the internal <code>BeanFactory</code> instance with a new one.</li><li><code>GenericApplicationContext</code> supports only 1 call to <code>refresh()</code>, and its <code>refreshBeanFactory()</code> method (template method pattern called by <code>refresh()</code>) throws an exception if called again:</li></ol><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>	<span style=color:#75715e>/**
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#75715e>	 * Do nothing: We hold a single internal BeanFactory and rely on callers
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#75715e>	 * to register beans through our public methods (or the BeanFactory&#39;s).
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#75715e>	 * @see #registerBeanDefinition
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#75715e>	 */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>	<span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>	<span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>refreshBeanFactory</span>() <span style=color:#66d9ef>throws</span> IllegalStateException {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>		<span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>refreshed</span>.<span style=color:#a6e22e>compareAndSet</span>(<span style=color:#66d9ef>false</span>, <span style=color:#66d9ef>true</span>)) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>			<span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> IllegalStateException(
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>					<span style=color:#e6db74>&#34;GenericApplicationContext does not support multiple refresh attempts: just call &#39;refresh&#39; once&#34;</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>		}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>		<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>beanFactory</span>.<span style=color:#a6e22e>setSerializationId</span>(getId());
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>	}</span></span></code></pre></div><button>copy</button></div><h4 id=class-genericapplicationcontext---abstractapplicationcontext><code>class GenericApplicationContext &lt;- AbstractApplicationContext</code></h4><h4 id=class-annotationconfigapplicationcontext---genericapplicationcontext---abstractapplicationcontext><code>class AnnotationConfigApplicationContext &lt;- GenericApplicationContext &lt;- AbstractApplicationContext</code></h4><p>With less than 50 LoC itself, this class is a trivial wrapper around the following 2 bean definition generators:</p><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> AnnotatedBeanDefinitionReader reader;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> ClassPathBeanDefinitionScanner scanner;</span></span></code></pre></div><button>copy</button></div><h2 id=misc-helper-interfaces--classes>Misc helper interfaces & classes</h2><ul><li><p><code>interface BeanMetadataElement</code> represents a bean configuration source (e.g. ). TODO</p><p>The most common subtypes are</p><ul><li><code>class BeanDefinitionHolder</code>: simple wrapper combining <code>BeanDefinition</code> and its name and aliases.</li></ul></li><li><p><code>AttributeAccessor</code> is implemented by objects that support CRUD on its &ldquo;attributes&rdquo;, i.e. <code>String</code> to arbitrary <code>Object</code> association.</p></li><li><p><code>interface BeanFactoryPostProcessor</code></p><p>Simple one-method interface describing something to do after a <code>BeanFactory</code> is</p><p><code>BeanFactory</code> itself is not awared of <code>BeanFactoryPostProcessor</code>.
<code>ApplicationContext</code> manages all <code>BeanFactoryPostProcessor</code> instances, specifically:</p><div class=codeblock-hook><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AbstractApplicationContext</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>final</span> List<span style=color:#f92672>&lt;</span>BeanFactoryPostProcessor<span style=color:#f92672>&gt;</span> beanFactoryPostProcessors <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>    <span style=color:#75715e>// ... </span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>}</span></span></code></pre></div><button>copy</button></div><p><code>ApplicationContext</code> use this interface to do something after a BeanFactory finishs loading BeanDefinitions, but before any bean instance is created; mainly:&mldr;</p><p>For <code>AbstractRefreshableApplicationContext</code> and subclasses, their <code>BeanFactory</code> is replaceable. Thus all <code>beanFactoryPostProcessors</code> may be run multiple times.</p></li></ul></div></article></main><footer>Unless otherwise noted, content of this site is licensed under
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ style=text-decoration:underline>the CC BY-NC-SA 4.0</a>.<br>cesun.info copyright 2024.</footer></body></html>