<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>CPU | Infinity Architect</title>
<link rel=stylesheet href=/main.css><script type=importmap>
  {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.167.1/+esm"
      }
  }
  </script><script type=module src=/theme.mjs></script><style>.tag-android{background-color:hsl(0deg 80% 70%)}.dark .tag-android{background-color:hsl(0deg 80% 20%)}.tag-annotation{background-color:hsl(50deg 80% 70%)}.dark .tag-annotation{background-color:hsl(50deg 80% 20%)}.tag-assembly{background-color:hsl(100deg 80% 70%)}.dark .tag-assembly{background-color:hsl(100deg 80% 20%)}.tag-asymmetrical-cryptography{background-color:hsl(150deg 80% 70%)}.dark .tag-asymmetrical-cryptography{background-color:hsl(150deg 80% 20%)}.tag-awk{background-color:hsl(200deg 80% 70%)}.dark .tag-awk{background-color:hsl(200deg 80% 20%)}.tag-bootloader{background-color:hsl(250deg 80% 70%)}.dark .tag-bootloader{background-color:hsl(250deg 80% 20%)}.tag-bytecode{background-color:hsl(300deg 80% 70%)}.dark .tag-bytecode{background-color:hsl(300deg 80% 20%)}.tag-c{background-color:hsl(350deg 80% 70%)}.dark .tag-c{background-color:hsl(350deg 80% 20%)}.tag-cxx{background-color:hsl(40deg 80% 70%)}.dark .tag-cxx{background-color:hsl(40deg 80% 20%)}.tag-cxx-stl{background-color:hsl(90deg 80% 70%)}.dark .tag-cxx-stl{background-color:hsl(90deg 80% 20%)}.tag-cgroup{background-color:hsl(140deg 80% 70%)}.dark .tag-cgroup{background-color:hsl(140deg 80% 20%)}.tag-cheetsheet{background-color:hsl(190deg 80% 70%)}.dark .tag-cheetsheet{background-color:hsl(190deg 80% 20%)}.tag-clang{background-color:hsl(240deg 80% 70%)}.dark .tag-clang{background-color:hsl(240deg 80% 20%)}.tag-coding-theory{background-color:hsl(290deg 80% 70%)}.dark .tag-coding-theory{background-color:hsl(290deg 80% 20%)}.tag-compression{background-color:hsl(340deg 80% 70%)}.dark .tag-compression{background-color:hsl(340deg 80% 20%)}.tag-concept{background-color:hsl(30deg 80% 70%)}.dark .tag-concept{background-color:hsl(30deg 80% 20%)}.tag-cpu{background-color:hsl(80deg 80% 70%)}.dark .tag-cpu{background-color:hsl(80deg 80% 20%)}.tag-crawler{background-color:hsl(130deg 80% 70%)}.dark .tag-crawler{background-color:hsl(130deg 80% 20%)}.tag-cryptography{background-color:hsl(180deg 80% 70%)}.dark .tag-cryptography{background-color:hsl(180deg 80% 20%)}.tag-css{background-color:hsl(230deg 80% 70%)}.dark .tag-css{background-color:hsl(230deg 80% 20%)}.tag-database{background-color:hsl(280deg 80% 70%)}.dark .tag-database{background-color:hsl(280deg 80% 20%)}.tag-deflate{background-color:hsl(330deg 80% 70%)}.dark .tag-deflate{background-color:hsl(330deg 80% 20%)}.tag-design{background-color:hsl(20deg 80% 70%)}.dark .tag-design{background-color:hsl(20deg 80% 20%)}.tag-dns{background-color:hsl(70deg 80% 70%)}.dark .tag-dns{background-color:hsl(70deg 80% 20%)}.tag-dom{background-color:hsl(120deg 80% 70%)}.dark .tag-dom{background-color:hsl(120deg 80% 20%)}.tag-driver{background-color:hsl(170deg 80% 70%)}.dark .tag-driver{background-color:hsl(170deg 80% 20%)}.tag-elastic{background-color:hsl(220deg 80% 70%)}.dark .tag-elastic{background-color:hsl(220deg 80% 20%)}.tag-elf{background-color:hsl(270deg 80% 70%)}.dark .tag-elf{background-color:hsl(270deg 80% 20%)}.tag-elk{background-color:hsl(320deg 80% 70%)}.dark .tag-elk{background-color:hsl(320deg 80% 20%)}.tag-flex{background-color:hsl(10deg 80% 70%)}.dark .tag-flex{background-color:hsl(10deg 80% 20%)}.tag-gc{background-color:hsl(60deg 80% 70%)}.dark .tag-gc{background-color:hsl(60deg 80% 20%)}.tag-gcc{background-color:hsl(110deg 80% 70%)}.dark .tag-gcc{background-color:hsl(110deg 80% 20%)}.tag-gnu{background-color:hsl(160deg 80% 70%)}.dark .tag-gnu{background-color:hsl(160deg 80% 20%)}.tag-go{background-color:hsl(210deg 80% 70%)}.dark .tag-go{background-color:hsl(210deg 80% 20%)}.tag-gzip{background-color:hsl(260deg 80% 70%)}.dark .tag-gzip{background-color:hsl(260deg 80% 20%)}.tag-hash{background-color:hsl(310deg 80% 70%)}.dark .tag-hash{background-color:hsl(310deg 80% 20%)}.tag-http{background-color:hsl(0deg 80% 70%)}.dark .tag-http{background-color:hsl(0deg 80% 20%)}.tag-huffman{background-color:hsl(50deg 80% 70%)}.dark .tag-huffman{background-color:hsl(50deg 80% 20%)}.tag-java{background-color:hsl(100deg 80% 70%)}.dark .tag-java{background-color:hsl(100deg 80% 20%)}.tag-java-module{background-color:hsl(150deg 80% 70%)}.dark .tag-java-module{background-color:hsl(150deg 80% 20%)}.tag-javascript{background-color:hsl(200deg 80% 70%)}.dark .tag-javascript{background-color:hsl(200deg 80% 20%)}.tag-jdk{background-color:hsl(250deg 80% 70%)}.dark .tag-jdk{background-color:hsl(250deg 80% 20%)}.tag-js{background-color:hsl(300deg 80% 70%)}.dark .tag-js{background-color:hsl(300deg 80% 20%)}.tag-jvm{background-color:hsl(350deg 80% 70%)}.dark .tag-jvm{background-color:hsl(350deg 80% 20%)}.tag-kernel{background-color:hsl(40deg 80% 70%)}.dark .tag-kernel{background-color:hsl(40deg 80% 20%)}.tag-lexer{background-color:hsl(90deg 80% 70%)}.dark .tag-lexer{background-color:hsl(90deg 80% 20%)}.tag-linux{background-color:hsl(140deg 80% 70%)}.dark .tag-linux{background-color:hsl(140deg 80% 20%)}.tag-log4j2{background-color:hsl(190deg 80% 70%)}.dark .tag-log4j2{background-color:hsl(190deg 80% 20%)}.tag-lz77{background-color:hsl(240deg 80% 70%)}.dark .tag-lz77{background-color:hsl(240deg 80% 20%)}.tag-make{background-color:hsl(290deg 80% 70%)}.dark .tag-make{background-color:hsl(290deg 80% 20%)}.tag-makefile{background-color:hsl(340deg 80% 70%)}.dark .tag-makefile{background-color:hsl(340deg 80% 20%)}.tag-maven{background-color:hsl(30deg 80% 70%)}.dark .tag-maven{background-color:hsl(30deg 80% 20%)}.tag-memory{background-color:hsl(80deg 80% 70%)}.dark .tag-memory{background-color:hsl(80deg 80% 20%)}.tag-multithreading{background-color:hsl(130deg 80% 70%)}.dark .tag-multithreading{background-color:hsl(130deg 80% 20%)}.tag-mybatis{background-color:hsl(180deg 80% 70%)}.dark .tag-mybatis{background-color:hsl(180deg 80% 20%)}.tag-mysql{background-color:hsl(230deg 80% 70%)}.dark .tag-mysql{background-color:hsl(230deg 80% 20%)}.tag-nasm{background-color:hsl(280deg 80% 70%)}.dark .tag-nasm{background-color:hsl(280deg 80% 20%)}.tag-node{background-color:hsl(330deg 80% 70%)}.dark .tag-node{background-color:hsl(330deg 80% 20%)}.tag-nodejs{background-color:hsl(20deg 80% 70%)}.dark .tag-nodejs{background-color:hsl(20deg 80% 20%)}.tag-openssl{background-color:hsl(70deg 80% 70%)}.dark .tag-openssl{background-color:hsl(70deg 80% 20%)}.tag-playwright{background-color:hsl(120deg 80% 70%)}.dark .tag-playwright{background-color:hsl(120deg 80% 20%)}.tag-posix{background-color:hsl(170deg 80% 70%)}.dark .tag-posix{background-color:hsl(170deg 80% 20%)}.tag-powershell{background-color:hsl(220deg 80% 70%)}.dark .tag-powershell{background-color:hsl(220deg 80% 20%)}.tag-programming-langauge{background-color:hsl(270deg 80% 70%)}.dark .tag-programming-langauge{background-color:hsl(270deg 80% 20%)}.tag-programming-language{background-color:hsl(320deg 80% 70%)}.dark .tag-programming-language{background-color:hsl(320deg 80% 20%)}.tag-qemu{background-color:hsl(10deg 80% 70%)}.dark .tag-qemu{background-color:hsl(10deg 80% 20%)}.tag-redis{background-color:hsl(60deg 80% 70%)}.dark .tag-redis{background-color:hsl(60deg 80% 20%)}.tag-retrocomputing{background-color:hsl(110deg 80% 70%)}.dark .tag-retrocomputing{background-color:hsl(110deg 80% 20%)}.tag-rfc{background-color:hsl(160deg 80% 70%)}.dark .tag-rfc{background-color:hsl(160deg 80% 20%)}.tag-sdram{background-color:hsl(210deg 80% 70%)}.dark .tag-sdram{background-color:hsl(210deg 80% 20%)}.tag-sed{background-color:hsl(260deg 80% 70%)}.dark .tag-sed{background-color:hsl(260deg 80% 20%)}.tag-slf4j{background-color:hsl(310deg 80% 70%)}.dark .tag-slf4j{background-color:hsl(310deg 80% 20%)}.tag-spring{background-color:hsl(0deg 80% 70%)}.dark .tag-spring{background-color:hsl(0deg 80% 20%)}.tag-spring-boot{background-color:hsl(50deg 80% 70%)}.dark .tag-spring-boot{background-color:hsl(50deg 80% 20%)}.tag-spring-data{background-color:hsl(100deg 80% 70%)}.dark .tag-spring-data{background-color:hsl(100deg 80% 20%)}.tag-spring-ioc{background-color:hsl(150deg 80% 70%)}.dark .tag-spring-ioc{background-color:hsl(150deg 80% 20%)}.tag-sql{background-color:hsl(200deg 80% 70%)}.dark .tag-sql{background-color:hsl(200deg 80% 20%)}.tag-streaming{background-color:hsl(250deg 80% 70%)}.dark .tag-streaming{background-color:hsl(250deg 80% 20%)}.tag-template{background-color:hsl(300deg 80% 70%)}.dark .tag-template{background-color:hsl(300deg 80% 20%)}.tag-testing{background-color:hsl(350deg 80% 70%)}.dark .tag-testing{background-color:hsl(350deg 80% 20%)}.tag-thymeleaf{background-color:hsl(40deg 80% 70%)}.dark .tag-thymeleaf{background-color:hsl(40deg 80% 20%)}.tag-tls{background-color:hsl(90deg 80% 70%)}.dark .tag-tls{background-color:hsl(90deg 80% 20%)}.tag-tomcat{background-color:hsl(140deg 80% 70%)}.dark .tag-tomcat{background-color:hsl(140deg 80% 20%)}.tag-transaction{background-color:hsl(190deg 80% 70%)}.dark .tag-transaction{background-color:hsl(190deg 80% 20%)}.tag-transistor{background-color:hsl(240deg 80% 70%)}.dark .tag-transistor{background-color:hsl(240deg 80% 20%)}.tag-ts{background-color:hsl(290deg 80% 70%)}.dark .tag-ts{background-color:hsl(290deg 80% 20%)}.tag-typescript{background-color:hsl(340deg 80% 70%)}.dark .tag-typescript{background-color:hsl(340deg 80% 20%)}.tag-unix{background-color:hsl(30deg 80% 70%)}.dark .tag-unix{background-color:hsl(30deg 80% 20%)}.tag-web{background-color:hsl(80deg 80% 70%)}.dark .tag-web{background-color:hsl(80deg 80% 20%)}.tag-x86{background-color:hsl(130deg 80% 70%)}.dark .tag-x86{background-color:hsl(130deg 80% 20%)}.tag-x86_64{background-color:hsl(180deg 80% 70%)}.dark .tag-x86_64{background-color:hsl(180deg 80% 20%)}.tag-x86-64{background-color:hsl(230deg 80% 70%)}.dark .tag-x86-64{background-color:hsl(230deg 80% 20%)}.tag-xpath{background-color:hsl(280deg 80% 70%)}.dark .tag-xpath{background-color:hsl(280deg 80% 20%)}.tag-zlib{background-color:hsl(330deg 80% 70%)}.dark .tag-zlib{background-color:hsl(330deg 80% 20%)}</style></head><body><script>localStorage.getItem("dark-theme")&&document.body.classList.add("dark")</script><header><h2 id=banner><a href=/>Infinity Architect</a></h2><div id=top-sections><a href=/android/ class=hoverable>Android </a><a href=/cxx/ class=hoverable>C/C++ </a><a href=/compression/ class=hoverable>Compression </a><a href=/cpu/ class=active>CPU </a><a href=/crypto/ class=hoverable>Cryptography </a><a href=/db/ class=hoverable>Database </a><a href=/ee/ class=hoverable>Electronic Engineering </a><a href=/linux/ class=hoverable>GNU/Linux </a><a href=/go/ class=hoverable>Golang </a><a href=/java/ class=hoverable>Java </a><a href=/microservice/ class=hoverable>Microservice </a><a href=/net/ class=hoverable>Network & Protocol </a><a href=/physics/ class=hoverable>Physics </a><a href=/retro/ class=hoverable>Retro-Computing </a><a href=/toy/ class=hoverable>Toys </a><a href=/windev/ class=hoverable>Window</a></div><div class=theme-switch style="align-self:center;margin:auto 20px"><input type=checkbox id=theme-checkbox>
<label for=theme-checkbox><div></div><span><svg viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path fill-rule="evenodd" d="M9.528 1.718a.75.75.0 01.162.819A8.97 8.97.0 009 6a9 9 0 009 9 8.97 8.97.0 003.463-.69.75.75.0 01.981.98 10.503 10.503.0 01-9.694 6.46c-5.799.0-10.5-4.701-10.5-10.5.0-4.368 2.667-8.112 6.46-9.694a.75.75.0 01.818.162z" clip-rule="evenodd"/></svg>
</span><span><svg viewBox="0 0 24 24" fill="currentcolor" class="w-6 h-6"><path d="M12 2.25a.75.75.0 01.75.75v2.25a.75.75.0 01-1.5.0V3a.75.75.0 01.75-.75zM7.5 12a4.5 4.5.0 119 0 4.5 4.5.0 01-9 0zM18.894 6.166a.75.75.0 00-1.06-1.06l-1.591 1.59a.75.75.0 101.06 1.061l1.591-1.59zM21.75 12a.75.75.0 01-.75.75h-2.25a.75.75.0 010-1.5H21a.75.75.0 01.75.75zm-3.916 6.894a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 10-1.061 1.06l1.59 1.591zM12 18a.75.75.0 01.75.75V21a.75.75.0 01-1.5.0v-2.25A.75.75.0 0112 18zM7.758 17.303a.75.75.0 00-1.061-1.06l-1.591 1.59a.75.75.0 001.06 1.061l1.591-1.59zM6 12a.75.75.0 01-.75.75H3a.75.75.0 010-1.5h2.25A.75.75.0 016 12zm.697-4.243a.75.75.0 001.06-1.06l-1.59-1.591a.75.75.0 00-1.061 1.06l1.59 1.591z"/></svg></span></label></div></header><main><div style=font-family:monospace;font-size:1.5em><div class=basic-text>/<a href=/>HOME</a>/
$</div></div><div id=section-flex class=basic-text><div style=flex:2;min-width:0><h1>Section: CPU</h1><p>All about CPUs. See Sub-sections architectures-/model-specific discussion.</p><h2 id=glossary>Glossary</h2><ul><li><p>control unit</p><ul><li>instruction unit (IU), a.k.a instruction fetch unit (IFU) / instruction issue unit (IIU) / instruction sequencing unit (ISU)</li><li>execution unit.</li></ul></li><li><p>microarchitecture: the wiring technique used to design a specific range of CPUs, determining how components are inter-connected with each other. e.g. Intel Core 2, Intel Skylake and AMD Zen4 are all different Microarchitectures.</p></li><li><p>Instruction Set Architecture (ISA): the collective name of well-defined</p><ol><li>instructions (semantics, encoding format, opcode and operands, addressing mode)</li><li>data types (sign/unsigned byte/<code>(D|Q|DQ)?word</code>, floating, pointer, etc.)</li><li>registers</li><li>main memory requirement & management</li></ol></li><li><p>Memory Controller</p><p>Sometimes also Memory Controller Unit (MCU); don&rsquo;t get confused with Microcontroller Unit (also, MCU).
Memory Controller is the part of circuits that directly controls the memory (data and address) bus
Early microprocessor models require an external memory controller as part of the motherboard, but nowadays one is usually embedded
into the CPU die.</p></li></ul><h2 id=assemblers>Assemblers</h2><p>x86 assembler syntax comes in 2 flavors:</p><ul><li>intel syntax; including variants: nasm, masm</li><li>ATT: the current most popular implementation is the GAS (gnu assembler)</li></ul><p>Among others, they mainly differs by the operand order: intel put destination operand first: <code>mnemonic destination, source</code>, but ATT put source operand first <code>mnemonic source, destination</code>.</p><p><code>objdump -d</code> prints ATT style by default. Add <code>-Mintel</code> to print in intel style.</p><h2 id=general-technologies>General Technologies</h2><h3 id=out-of-order-execution-oooe>Out-of-order Execution (OOOE)</h3><p>In-order pipeline can&rsquo;t proceed (i.e. fetch new instruction) when one of the following happens:</p><ol><li>data required by the currently decoded instruction aren&rsquo;t available in this clock cycle</li><li>next stage of currently decoded instruction has a conflict with previous unfinished instructions in the pipeline (e.g. <code>RAW</code> or <code>WAW</code>).</li><li>currently decoded instruction is a branching one - adjacent instructions are simply garbage and must not reach the execution stage.</li></ol><h3 id=pipelining>Pipelining</h3><p>Pipelining is good and is always wanted in CPU design. The problematic behavior above just indicates that more sophisticated control of the pipelining technique must be implemented.</p><p>Whenever the SEA is false in the naive pipeline model, its known as a <em>hazard</em>.</p><p>it means extra measures must be taken when implement real-world pipelining, either by end programmer or by CPU designer, to ensure - to a certain extend - the result of computation is still correct - e.g. <code>BX is 43 not 42</code>.</p><p>Deeper pipeline means</p><ol><li>less work per stage (i.e. less work per cycle), meaning that the stateless async circuits between each stages is simpler thus having shorter propagation delay ; eventually meaning that higher clock frequency can be achieved.</li><li>you can have more instruction in-the-fly within pipelines:<ul><li>good thing is that you have higher instruction throughput, of course;</li><li>bad thing is increased penalities when branch predication fails.</li></ul></li><li>you have more stages to fill, since you don&rsquo;t want more bubbles just because you have deeper pipelines. This usually means more sophisticated OOOE logics has to be deployed, consuming real estates on the chip.</li></ol><h3 id=superscalar-aka-multiple-issuance>&ldquo;Superscalar&rdquo; a.k.a multiple-issuance</h3><p>&ldquo;Superscalar&rdquo; is Intel&rsquo;s marketing name for the multiple-issuance technique used during instruction pipelining.
Pipelined CPU has &ldquo;pipeline registers&rdquo; after each stage. These store information from the instruction and calculations so that the logic gates of the next stage can do the next step. It is common for even-numbered stages to operate on one edge of the square-wave clock, while odd-numbered stages operate on the other edge.</p><p>Finding a branch instruction in the decode stage simply indicates that all later instructions currently in the pipeline before the decode stage is garbage.
The design varies when it comes to the question &ldquo;what to do when teh decode stage reports a branch instruction&rdquo;.</p><ol><li>Do nothing. The pipeline runs as usual,</li><li>Discard all garbage in the pipeline (known as <em>pipeline flushing</em>)</li></ol><p>The term width of multiple-issuance refers to the number of program instructions that a scheduler can dispatch in a single clock cycle.</p><ul><li>more width means</li><li>less width means</li></ul><h2 id=hazard>hazard</h2><p>hazards are situations where the next instruction cannot execute in the following clock cycle, and, if it does so anyway, can potentially lead to incorrect computation results.</p><p>Traditional programming model (i.e. before the advent of pipelined processor) assumes:</p><ol><li>instructions are executed one after one in their text order in the program; and</li><li>the consequence of a previous instruction is immediately available to the next adjacent one:</li></ol><div class=codeblock-hook><pre tabindex=0><code># assuming old AX is 42
ADD 1 to AX         
MOV AX to BX        # according to SEA, a read from AX should observe incremented AX, i.e. 43</code></pre><button>copy</button></div><p>Applying naive pipeline will break that assumption: think about a sliding window over instruction texts unconditionally slide 1 instruction forward upon each clock tick.
In the example above, <code>read from AX</code> in the 2nd instructions can happen before <code>write of incremented value to AX</code> in 1st instruction, since execution stage is after read stage.</p><p>Thus pipeline designer face the choice:</p><ol><li>design more sophisticated pipeline scheduling, in order to not break compatibility with the programming model; or</li><li>break the model anyway, fuck all old programs and ask programmer to be awared of the naive pipeline design in newly written code.</li></ol><h2 id=smt>SMT</h2><p>Now you have superscala anyway. Vendor may then choose to build SMT into each core to fill bubbles, or not.</p><h2 id=cache-associativity>cache associativity</h2><p>higher assoc</p><ul><li>harder for cache tag to collide, thus eviction happens less frequently, thus more cache hit rate.</li><li>hard to make it fast (i.e. use more comparator, cost more)</li><li>hard to increase cache size</li></ul><p>low assoc:</p><ul><li>higher probability for collision, eviction happen frequently, low cache hit rate</li><li>easy to make it fast</li><li>easy to increase cache size</li></ul><p>In real design L1 cache has low assoc e.g. 2, while L2 can be 16-way assoc.</p><h2 id=simd>SIMD</h2><table><thead><tr><th>Instruction Set</th><th>Since</th><th>Register Names</th><th>Bit width</th><th>Comment</th></tr></thead><tbody><tr><td>MMX</td><td>Pentium 2</td><td>MM0~MM7</td><td>64</td><td>registers are for integer only</td></tr><tr><td>SSE</td><td>Pentium 3</td><td>XMM0~XMM31</td><td>128</td><td></td></tr><tr><td>SSE2</td><td>Pentium 4 & Xeon</td><td>XMM0~XMM31</td><td>128</td><td></td></tr><tr><td>AVX2</td><td></td><td>YMM0~YMM31</td><td>256</td><td></td></tr><tr><td>AVX512</td><td></td><td>ZMM0~ZMM31</td><td>512</td><td></td></tr></tbody></table><h2 id=instruction-cycle>Instruction Cycle</h2><ul><li>Memory Data/Buffer Register (MDR / MBR): a two-way register that store<ol><li>data just fetched from main memory; or</li><li>data wait to be send (write) to main memory</li></ol></li><li>Memory Address Register (MAR): stores the memory address that MDR operation onto.<ul><li>Common pattern for the control unit (CU) is to first store the address of desired data into MAR, and send a READ command (TODO: micro-op?) to the control bus. Memory controller, as a response, will send data designated by MAR to MDR via the data bus.</li></ul></li></ul><h2 id=cpus-perspective-of-the-main-memory-2-types>CPU&rsquo;s perspective of the main memory: 2 types</h2><p>x86 supports 2 types of view of the main memory:</p><ul><li>Byte addressing: Program live in a sequence of addressed byte called the <em>address space</em>. Uniform and simple.</li><li>Segment addressing: Program live in multiple addressable spaces called <em>segment</em>. To access data in a given segment, you need a segment register and offset into that segment.</li></ul><h2 id=classic-5-stage-risc-pipeline>classic 5-stage RISC pipeline</h2><p>Denote the previous clock up edge as <code>A</code>, and the next as <code>B</code>.</p><table><thead><tr><td>stage</td><td style=width:80%>between 2 clock ticks, what the circuit being responsible for this stage does</td></tr></thead><tbody><tr><td>(instruction) fetch</td><td><ol><li>the memory content (maybe in cache) pointed by <code>PC</code> register at the A is retrieved into the <code>IR</code> register.</li><li><code>PC += 4</code>, unless a jump instruction is made available to the circuit of <code>WB</code> stages at A. Signals are wired back from <code>WB</code> circuit to IF circuit to set <code>PC</code> value to the jump target.</li></ol></td></tr><tr><td>(instruction) decode</td><td><ol><li><p>content of <code>IR</code> is parsed</p><ol><li>If registers are referred (RISC allows referring to most 2 registers), their name is resolved to real indexes into the register file.</li><li>If it&rsquo;s a jump instruction, the target address is computed. This step potentially requires simple arithemtic, and sometime ALU from <code>EX</code> circuit will be borrowed (which decreases the pipeline throughput if only 1 ALU is available). If the jump is conditional (e.g. <code>JNZ</code>), it will take the next cycle to evaluate the condition also in <code>ID</code> stage, which will cause the <code>IF</code> stage to stall.</li></ol></li><li><p>The status of <code>EX</code> circuit is inspected.</p><ul><li>If it was running a multi-cycle operation during <code>PreA -> A</code>, this implies (at least) the <code>A -> B</code> interval will also be busy, and can&rsquo;t accept new commands (i.e. input flip flops in <code>EX</code> circuit will not accept new bits). <code>IF</code> and <code>ID</code> stages stall.</li><li>otherwise, the content of nominated registers are made available to the input flip flops of <code>EX</code> circuit and get hold there.</li></ul></li></ol></td></tr><tr><td>execute</td><td><p>content of <code>IR</code> is inspected to determine instruction behavior</p><ul><li>arithmetics operands are fed to the ALU input register</li><li>the result must be made available on the ALU output register when the next tick comes</li></ul></td></tr><tr><td>memory access</td><td></td></tr><tr><td>write back</td><td></td></tr></tbody></table></div><div style=flex:1><div style=border-radius:30px><h4>You are looking at a section page.</h3><p>Section pages are navigation nodes of this site.
A section contains articles and sub-sections.</p><div><h4>Direct sub-sections of this section are:</h3><ul><li><a class=deco href=/cpu/risc-v/>RISC-V Architecture</a></li><li><a class=deco href=/cpu/x86/>x86 Architecture</a></li><li><a class=deco href=/cpu/arm/>ARM Architecture Family</a></li><li><a class=deco href=/cpu/nasm/>The Netwide Assembler</a></li></ul></div></div></div></div><div style=margin-top:200px><hr><h2>Articles in this section:</h2><div><div class=pagination-navi><a href=/cpu/>&lt;&lt;</a>
<a href=/cpu/>&lt;</a>
<a href=/cpu/>1</a>
<a class=active href=/cpu/page/2/>2</a>
<a>></a>
<a href=/cpu/page/2/>>></a></div><div class=page-list><div class=hoverable><a href=/cpu/nasm/preprocessor/><div>In section:
> CPU
> The Netwide Assembler</div><h2 style=margin:0>Preprocessor</h2><div style=margin-top:4px;margin-bottom:22px class=aux-text>March 19, 2024</div><div class=aux-text>%define for single-line macro %macro ... %endmacro for multi-instructions macro %define is not very useful when you need a macro that expands to multiple instructions. Use %macro for that:
%macro macro_name num_of_args [default args values] ; arguments are referred to by %1, %2, %3, etc. ; %0 expands to the number of arguments, a compile-time constant %endmacro copy where num_of_args takes the form x-y, meaning that at least x arguments must be provided</div><div style=margin-top:20px><div style=line-height:2em><span class="page-tag tag-assembly">assembly</span>
<span class="page-tag tag-nasm">nasm</span>
<span class="page-tag tag-x86">x86</span></div></div></a></div><div class=hoverable><a href=/cpu/x86/registers/><div>In section:
> CPU
> x86 Architecture</div><h2 style=margin:0>x86 Architectural and Model Registers</h2><div style=margin-top:4px;margin-bottom:22px class=aux-text>March 3, 2024</div><div class=aux-text>bit index mnemonics name description 9 IF Interrupt-Enabled Flag These 2 flags are 14 NF Nested Task 16 RF Resume Task 8 TF Trap Flag 17 VM Virtual 8086 Mode &lt;/tbody> General Purpose Registers In 32-bit protected mode: EAX, EBX, ECX, EDX, EBP, ESP, ESI, and EDI.
The Flags Register EFLAGS This is a 32-bit register even for the AMD64 machine.
The following bits in the flag register are updated by most arithemtic operations unless otherwise noted:</div><div style=margin-top:20px><div style=line-height:2em><span class="page-tag tag-cpu">CPU</span>
<span class="page-tag tag-x86">x86</span></div></div></a></div><div class=hoverable><a href=/cpu/x86/models/><div>In section:
> CPU
> x86 Architecture</div><h2 style=margin:0>Overview: x86 CPU Models</h2><div style=margin-top:4px;margin-bottom:22px class=aux-text>February 15, 2024</div><div class=aux-text>x86 CPU model-specific information, PIN assignment, clock, bus interface, etc.
Intel 8086 and 8088 Intel 8086 and 8088 differ only in the width of the memory data bus (thus pin assignment). 8086 has 20 address pins among which 16 are multiplexed as data pins; 8088 has also 20 address pins but only 8 are also data.
In almost every other respect the processors are identical; software written for one CPU will execute on the other without alteration.</div><div style=margin-top:20px><div style=line-height:2em><span class="page-tag tag-cpu">CPU</span>
<span class="page-tag tag-x86">x86</span></div></div></a></div><div class=hoverable><a href=/cpu/nasm/overview/><div>In section:
> CPU
> The Netwide Assembler</div><h2 style=margin:0>Overview to The Netwide Assembler</h2><div style=margin-top:4px;margin-bottom:22px class=aux-text>February 6, 2024</div><div class=aux-text>NASM is an assembler for x86 and AMD64 architecture.
CLI invocation 1nasm -f FORMAT -o OUTPUT_FILE source.asm copy nasm assembles each .asm file to an object file, which is later linked by a linker e.g. GNU ld. See nasm -h for a list of supported FORAMT. For modern *NIX you almost always want to use -f elf64. If -o is not specified,
Programming nasm is line oriented. The precense of LF in the source is significant for a successful assembling.</div><div style=margin-top:20px><div style=line-height:2em><span class="page-tag tag-assembly">assembly</span>
<span class="page-tag tag-nasm">nasm</span>
<span class="page-tag tag-x86">x86</span></div></div></a></div><div class=hoverable><a href=/cpu/x86/descriptors/><div>In section:
> CPU
> x86 Architecture</div><h2 style=margin:0>Descriptor Tables, Descriptors, and Selectors</h2><div style=margin-top:4px;margin-bottom:22px class=aux-text>January 20, 2024</div><div class=aux-text>Descriptor tables are memory-resident data structures understood and manipulated directly by the x86/x86-64 CPUs. Such structures are used in both x86 protected mode and AMD64 Long mode.
This article serves as a reference to descriptor tables and descriptors, without going into too much detail on how they are used to implement various features of the CPU. Please see links to feature-specific articles for such details.
Descriptor tables A descriptor table is a list of items, each known as a descriptor.</div><div style=margin-top:20px><div style=line-height:2em><span class="page-tag tag-cpu">CPU</span>
<span class="page-tag tag-x86">x86</span></div></div></a></div></div><div class=pagination-navi><a href=/cpu/>&lt;&lt;</a>
<a href=/cpu/>&lt;</a>
<a href=/cpu/>1</a>
<a class=active href=/cpu/page/2/>2</a>
<a>></a>
<a href=/cpu/page/2/>>></a></div></div></div></main><footer>Unless otherwise noted, content of this site is licensed under
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ style=text-decoration:underline>the CC BY-NC-SA 4.0</a>.<br>cesun.info copyright 2024.</footer></body></html>